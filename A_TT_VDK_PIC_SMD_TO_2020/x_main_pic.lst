CCS PCH C Compiler, Version 5.015, 5967               09-Sep-20 11:25

               Filename:   D:\CET\vi xu li(PIC16F887)\THUC_TAP\A_TT_VDK_PIC_SMD_TO_2020\x_main_pic.lst

               ROM used:   4942 bytes (15%)
                           Largest free fragment is 27822
               RAM used:   1434 (70%) at main() level
                           1453 (71%) worst case
               Stack used: 10 locations (9 in main + 1 for interrupts)
               Stack size: 31

*
0000:  GOTO   1160
*
0008:  MOVWF  04
000A:  MOVFF  FD8,05
000E:  MOVFF  FE0,06
0012:  MOVLB  0
0014:  MOVFF  FE9,0C
0018:  MOVFF  FEA,07
001C:  MOVFF  FE1,08
0020:  MOVFF  FE2,09
0024:  MOVFF  FD9,0A
0028:  MOVFF  FDA,0B
002C:  MOVFF  FF3,12
0030:  MOVFF  FF4,13
0034:  MOVFF  FFA,14
0038:  MOVFF  00,0E
003C:  MOVFF  01,0F
0040:  MOVFF  02,10
0044:  MOVFF  03,11
0048:  BTFSS  F9D.0
004A:  GOTO   0054
004E:  BTFSC  F9E.0
0050:  GOTO   018E
0054:  MOVFF  0E,00
0058:  MOVFF  0F,01
005C:  MOVFF  10,02
0060:  MOVFF  11,03
0064:  MOVFF  0C,FE9
0068:  MOVFF  07,FEA
006C:  BSF    07.7
006E:  MOVFF  08,FE1
0072:  MOVFF  09,FE2
0076:  MOVFF  0A,FD9
007A:  MOVFF  0B,FDA
007E:  MOVFF  12,FF3
0082:  MOVFF  13,FF4
0086:  MOVFF  14,FFA
008A:  MOVF   04,W
008C:  MOVFF  06,FE0
0090:  MOVFF  05,FD8
0094:  RETFIE 0
.................... #include <b_tv_lbr_chuong_all.c>                       
.................... #include <tv_01_mbi_hardware.c>                
.................... #include    <18f4550.h> 
.................... //////////// Standard Header file for the PIC18F4550 device //////////////// 
.................... /////////////////////////////////////////////////////////////////////////// 
.................... ////        (C) Copyright 1996, 2013 Custom Computer Services          //// 
.................... //// This source code may only be used by licensed users of the CCS C  //// 
.................... //// compiler.  This source code may only be distributed to other      //// 
.................... //// licensed users of the CCS C compiler.  No other use, reproduction //// 
.................... //// or distribution is permitted without written permission.          //// 
.................... //// Derivative programs created using this software in object code    //// 
.................... //// form are not restricted in any way.                               //// 
.................... /////////////////////////////////////////////////////////////////////////// 
.................... #device PIC18F4550 
0096:  MOVFF  FF2,0D
009A:  BCF    FF2.7
009C:  CLRF   FF7
009E:  ADDLW  B0
00A0:  MOVWF  FF6
00A2:  MOVLW  00
00A4:  ADDWFC FF7,F
00A6:  TBLRD*+
00A8:  MOVF   FF5,W
00AA:  BTFSC  0D.7
00AC:  BSF    FF2.7
00AE:  RETURN 0
00B0:  DATA C0,F9
00B2:  DATA A4,B0
00B4:  DATA 99,92
00B6:  DATA 82,F8
00B8:  DATA 80,90
00BA:  DATA 88,83
00BC:  DATA C6,A1
00BE:  DATA 86,8E
00C0:  MOVFF  FF2,0D
00C4:  BCF    FF2.7
00C6:  CLRF   FF7
00C8:  ADDLW  DA
00CA:  MOVWF  FF6
00CC:  MOVLW  00
00CE:  ADDWFC FF7,F
00D0:  TBLRD*+
00D2:  MOVF   FF5,W
00D4:  BTFSC  0D.7
00D6:  BSF    FF2.7
00D8:  RETURN 0
00DA:  DATA 00,01
00DC:  DATA 02,04
00DE:  DATA 03,05
00E0:  DATA 01,02
00E2:  DATA 20,03
00E4:  DATA 07,03
00E6:  DATA 06,06
00E8:  DATA 02,04
00EA:  DATA 03,03
00EC:  DATA 06,06
00EE:  DATA 02,03
00F0:  DATA 03,05
00F2:  DATA 07,03
00F4:  DATA 07,20
00F6:  DATA 20,07
00F8:  DATA 07,06
00FA:  DATA 06,03
00FC:  DATA 03,05
00FE:  DATA 00,06
0100:  DATA 06,04
0102:  DATA 03,05
0104:  DATA 01,01
0106:  DATA 07,20
0108:  DATA 20,07
010A:  DATA 00,06
010C:  DATA 02,04
010E:  DATA 03,05
0110:  DATA 00,06
0112:  DATA 02,03
0114:  DATA 03,05
0116:  MOVFF  FF2,0D
011A:  BCF    FF2.7
011C:  CLRF   FF7
011E:  ADDLW  30
0120:  MOVWF  FF6
0122:  MOVLW  01
0124:  ADDWFC FF7,F
0126:  TBLRD*+
0128:  MOVF   FF5,W
012A:  BTFSC  0D.7
012C:  BSF    FF2.7
012E:  RETURN 0
0130:  DATA 07,0F
0132:  DATA 1F,1F
0134:  DATA 1F,1F
0136:  DATA 1F,1F
0138:  DATA 1F,1F
013A:  DATA 1F,00
013C:  DATA 00,00
013E:  DATA 00,00
0140:  DATA 1C,1E
0142:  DATA 1F,1F
0144:  DATA 1F,1F
0146:  DATA 1F,1F
0148:  DATA 00,00
014A:  DATA 00,00
014C:  DATA 00,1F
014E:  DATA 1F,1F
0150:  DATA 1F,1F
0152:  DATA 1F,1F
0154:  DATA 1F,1F
0156:  DATA 0F,07
0158:  DATA 1F,1F
015A:  DATA 1F,1F
015C:  DATA 1F,1F
015E:  DATA 1E,1C
0160:  DATA 1F,1F
0162:  DATA 1F,00
0164:  DATA 00,00
0166:  DATA 1F,1F
0168:  DATA 1F,1F
016A:  DATA 1F,1F
016C:  DATA 1F,1F
016E:  DATA 1F,1F
0170:  MOVFF  FF2,0D
0174:  BCF    FF2.7
0176:  CLRF   FF7
0178:  ADDLW  8A
017A:  MOVWF  FF6
017C:  MOVLW  01
017E:  ADDWFC FF7,F
0180:  TBLRD*+
0182:  MOVF   FF5,W
0184:  BTFSC  0D.7
0186:  BSF    FF2.7
0188:  RETURN 0
018A:  DATA 80,C0
018C:  DATA 94,D4
*
01A2:  DATA 31,20
01A4:  DATA 68,69
01A6:  DATA 65,6E
01A8:  DATA 20,74
01AA:  DATA 68,69
01AC:  DATA 20,6C
01AE:  DATA 63,64
01B0:  DATA 20,32
01B2:  DATA 30,78
01B4:  DATA 34,2A
01B6:  DATA 2A,20
01B8:  DATA 00,00
01BA:  DATA 32,20
01BC:  DATA 64,61
01BE:  DATA 69,20
01C0:  DATA 68,6F
01C2:  DATA 63,20
01C4:  DATA 73,75
01C6:  DATA 20,70
01C8:  DATA 68,61
01CA:  DATA 6D,20
01CC:  DATA 6B,74
01CE:  DATA 00,00
01D0:  DATA 33,20
01D2:  DATA 62,6F
01D4:  DATA 20,74
01D6:  DATA 68,69
01D8:  DATA 20,6E
01DA:  DATA 67,68
01DC:  DATA 69,65
01DE:  DATA 6D,20
01E0:  DATA 76,64
01E2:  DATA 6B,20
01E4:  DATA 00,00
01E6:  DATA 30,31
01E8:  DATA 32,33
01EA:  DATA 34,35
01EC:  DATA 36,37
01EE:  DATA 38,39
01F0:  DATA 61,62
01F2:  DATA 63,64
01F4:  DATA 65,66
01F6:  DATA 67,68
01F8:  DATA 69,6A
01FA:  DATA 00,00
01FC:  DATA 41,00
01FE:  DATA 20,20
0200:  DATA 20,20
0202:  DATA 20,20
0204:  DATA 20,20
0206:  DATA 20,20
0208:  DATA 20,20
020A:  DATA 20,20
020C:  DATA 20,20
020E:  DATA 20,20
0210:  DATA 20,42
0212:  DATA 00,00
0214:  DATA 20,20
0216:  DATA 43,00
0218:  DATA 20,20
021A:  DATA 20,20
021C:  DATA 20,20
021E:  DATA 20,20
0220:  DATA 20,20
0222:  DATA 20,20
0224:  DATA 20,20
0226:  DATA 20,20
0228:  DATA 20,44
022A:  DATA 00,00
022C:  DATA 6B,68
022E:  DATA 6F,61
0230:  DATA 20,64
0232:  DATA 69,65
0234:  DATA 6E,20
0236:  DATA 2D,20
0238:  DATA 64,69
023A:  DATA 65,6E
023C:  DATA 20,74
023E:  DATA 75,20
0240:  DATA 00,00
0242:  DATA 62,6D
0244:  DATA 20,64
0246:  DATA 69,65
0248:  DATA 6E,74
024A:  DATA 75,63
024C:  DATA 6F,6E
024E:  DATA 67,20
0250:  DATA 6E,67
0252:  DATA 68,69
0254:  DATA 65,70
0256:  DATA 00,00
0258:  DATA 6B,68
025A:  DATA 6F,61
025C:  DATA 20,64
025E:  DATA 69,65
0260:  DATA 6E,20
0262:  DATA 2D,20
0264:  DATA 64,69
0266:  DATA 65,6E
0268:  DATA 20,74
026A:  DATA 75,20
026C:  DATA 00,00
026E:  DATA 62,6D
0270:  DATA 20,64
0272:  DATA 69,65
0274:  DATA 6E,74
0276:  DATA 75,63
0278:  DATA 6F,6E
027A:  DATA 67,20
027C:  DATA 6E,67
027E:  DATA 68,69
0280:  DATA 65,70
0282:  DATA 00,00
0284:  DATA 6B,68
0286:  DATA 6F,61
0288:  DATA 20,64
028A:  DATA 69,65
028C:  DATA 6E,20
028E:  DATA 2D,20
0290:  DATA 64,69
0292:  DATA 65,6E
0294:  DATA 20,74
0296:  DATA 75,20
0298:  DATA 00,00
029A:  DATA 62,6D
029C:  DATA 20,64
029E:  DATA 69,65
02A0:  DATA 6E,74
02A2:  DATA 75,63
02A4:  DATA 6F,6E
02A6:  DATA 67,20
02A8:  DATA 6E,67
02AA:  DATA 68,69
02AC:  DATA 65,70
02AE:  DATA 00,00
02B0:  DATA 44,4F
02B2:  DATA 4E,47
02B4:  DATA 20,48
02B6:  DATA 4F,3A
02B8:  DATA 00,00
02BA:  DATA 2D,00
02BC:  DATA 44,4F
02BE:  DATA 4E,47
02C0:  DATA 20,48
02C2:  DATA 4F,3A
02C4:  DATA 00,00
02C6:  DATA 2D,00
02C8:  DATA 2D,00
02CA:  DATA 44,4F
02CC:  DATA 4E,47
02CE:  DATA 20,48
02D0:  DATA 4F,3A
02D2:  DATA 00,00
02D4:  DATA 2D,00
02D6:  DATA 2D,00
02D8:  DATA 44,4F
02DA:  DATA 4E,47
02DC:  DATA 20,48
02DE:  DATA 4F,3A
02E0:  DATA 00,00
02E2:  DATA 2D,00
02E4:  DATA 2D,00
02E6:  DATA 44,4F
02E8:  DATA 4E,47
02EA:  DATA 20,48
02EC:  DATA 4F,3A
02EE:  DATA 00,00
02F0:  DATA 47,49
02F2:  DATA 41,20
02F4:  DATA 54,52
02F6:  DATA 49,20
02F8:  DATA 43,41
02FA:  DATA 49,3A
02FC:  DATA 20,00
02FE:  DATA 47,49
0300:  DATA 41,20
0302:  DATA 54,52
0304:  DATA 49,20
0306:  DATA 44,45
0308:  DATA 4D,3A
030A:  DATA 20,00
030C:  DATA 48,41
030E:  DATA 59,20
0310:  DATA 4E,48
0312:  DATA 41,4E
0314:  DATA 20,50
0316:  DATA 48,49
0318:  DATA 4D,00
031A:  DATA 48,41
031C:  DATA 59,20
031E:  DATA 4E,48
0320:  DATA 41,4E
0322:  DATA 20,50
0324:  DATA 48,49
0326:  DATA 4D,00
0328:  DATA 4F,4E
032A:  DATA 20,00
032C:  DATA 44,49
032E:  DATA 45,55
0330:  DATA 20,4B
0332:  DATA 48,49
0334:  DATA 45,4E
0336:  DATA 20,42
0338:  DATA 55,5A
033A:  DATA 5A,45
033C:  DATA 52,00
033E:  DATA 42,55
0340:  DATA 5A,5A
0342:  DATA 45,52
0344:  DATA 3A,20
0346:  DATA 4F,46
0348:  DATA 46,2C
034A:  DATA 20,54
034C:  DATA 47,3A
034E:  DATA 20,00
0350:  DATA 47,49
0352:  DATA 41,20
0354:  DATA 54,52
0356:  DATA 49,20
0358:  DATA 43,41
035A:  DATA 49,3A
035C:  DATA 20,00
035E:  DATA 47,49
0360:  DATA 41,20
0362:  DATA 54,52
0364:  DATA 49,20
0366:  DATA 44,45
0368:  DATA 4D,3A
036A:  DATA 20,00
036C:  DATA 48,69
036E:  DATA 65,6E
0370:  DATA 20,74
0372:  DATA 68,69
0374:  DATA 20,74
0376:  DATA 72,61
0378:  DATA 69,20
037A:  DATA 74,69
037C:  DATA 6D,00
037E:  DATA 48,69
0380:  DATA 65,6E
0382:  DATA 20,74
0384:  DATA 68,69
0386:  DATA 20,74
0388:  DATA 72,61
038A:  DATA 69,20
038C:  DATA 74,69
038E:  DATA 6D,00
0390:  DATA 48,69
0392:  DATA 65,6E
0394:  DATA 20,74
0396:  DATA 68,69
0398:  DATA 20,33
039A:  DATA 20,6B
039C:  DATA 79,20
039E:  DATA 74,75
03A0:  DATA 00,00
03A2:  DATA 48,69
03A4:  DATA 65,6E
03A6:  DATA 20,74
03A8:  DATA 68,69
03AA:  DATA 20,38
03AC:  DATA 20,6B
03AE:  DATA 79,20
03B0:  DATA 74,75
03B2:  DATA 00,00
03B4:  DATA 42,49
03B6:  DATA 45,55
03B8:  DATA 20,54
03BA:  DATA 55,4F
03BC:  DATA 4E,47
03BE:  DATA 20,41
03C0:  DATA 50,50
03C2:  DATA 4C,45
03C4:  DATA 00,00
03C6:  DATA 42,49
03C8:  DATA 45,55
03CA:  DATA 20,54
03CC:  DATA 55,4F
03CE:  DATA 4E,47
03D0:  DATA 20,41
03D2:  DATA 50,50
03D4:  DATA 4C,45
03D6:  DATA 00,00
03D8:  DATA 20,00
03DA:  DATA 20,00
03DC:  DATA 20,00
03DE:  DATA 20,00
03E0:  DATA 68,69
03E2:  DATA 65,6E
03E4:  DATA 20,74
03E6:  DATA 68,69
03E8:  DATA 20,73
03EA:  DATA 6F,20
03EC:  DATA 30,20
03EE:  DATA 68,61
03F0:  DATA 6E,67
03F2:  DATA 20,33
03F4:  DATA 00,00
03F6:  DATA 68,69
03F8:  DATA 65,6E
03FA:  DATA 20,74
03FC:  DATA 68,69
03FE:  DATA 20,73
0400:  DATA 6F,20
0402:  DATA 30,31
0404:  DATA 32,33
0406:  DATA 00,00
0408:  DATA 2A,2A
040A:  DATA 64,65
040C:  DATA 6D,20
040E:  DATA 74,75
0410:  DATA 20,73
0412:  DATA 6F,20
0414:  DATA 30,30
0416:  DATA 20,64
0418:  DATA 65,6E
041A:  DATA 20,39
041C:  DATA 39,2A
041E:  DATA 2A,00
0420:  DATA 2A,2A
0422:  DATA 44,45
0424:  DATA 4D,20
0426:  DATA 53,41
0428:  DATA 4E,20
042A:  DATA 50,48
042C:  DATA 41,4D
042E:  DATA 2A,2A
0430:  DATA 00,00
0432:  DATA 64,68
0434:  DATA 2D,73
0436:  DATA 75,70
0438:  DATA 68,61
043A:  DATA 6D,20
043C:  DATA 6B,74
043E:  DATA 20,68
0440:  DATA 63,6D
0442:  DATA 00,00
0444:  DATA 62,6F
0446:  DATA 20,6D
0448:  DATA 6F,6E
044A:  DATA 20,64
044C:  DATA 69,65
044E:  DATA 6E,20
0450:  DATA 74,75
0452:  DATA 00,00
0454:  DATA 63,6F
0456:  DATA 6E,67
0458:  DATA 20,6E
045A:  DATA 67,68
045C:  DATA 69,65
045E:  DATA 70,00
0460:  DATA 74,68
0462:  DATA 75,63
0464:  DATA 20,68
0466:  DATA 61,6E
0468:  DATA 68,20
046A:  DATA 76,64
046C:  DATA 6B,00
046E:  DATA 64,65
0470:  DATA 6D,20
0472:  DATA 73,61
0474:  DATA 6E,20
0476:  DATA 70,68
0478:  DATA 61,6D
047A:  DATA 00,00
047C:  DATA 64,65
047E:  DATA 6D,20
0480:  DATA 73,61
0482:  DATA 6E,20
0484:  DATA 70,68
0486:  DATA 61,6D
0488:  DATA 00,00
048A:  DATA 64,65
048C:  DATA 6D,20
048E:  DATA 73,61
0490:  DATA 6E,20
0492:  DATA 70,68
0494:  DATA 61,6D
0496:  DATA 00,00
0498:  DATA 44,6F
049A:  DATA 6E,67
049C:  DATA 20,48
049E:  DATA 6F,00
04A0:  DATA 47,69
04A2:  DATA 61,79
04A4:  DATA 3A,00
04A6:  DATA 53,00
04A8:  DATA 50,68
04AA:  DATA 75,74
04AC:  DATA 3A,00
04AE:  DATA 50,00
04B0:  DATA 47,69
04B2:  DATA 6F,3A
04B4:  DATA 00,00
04B6:  DATA 48,00
04B8:  DATA 44,4F
04BA:  DATA 4E,47
04BC:  DATA 20,48
04BE:  DATA 4F,3A
04C0:  DATA 20,00
04C2:  DATA 3A,00
04C4:  DATA 3A,00
04C6:  DATA 64,65
04C8:  DATA 6D,20
04CA:  DATA 73,61
04CC:  DATA 6E,20
04CE:  DATA 70,68
04D0:  DATA 61,6D
04D2:  DATA 3A,00
04D4:  DATA 6C,63
04D6:  DATA 64,3A
04D8:  DATA 20,64
04DA:  DATA 65,6D
04DC:  DATA 20,73
04DE:  DATA 61,6E
04E0:  DATA 20,70
04E2:  DATA 68,61
04E4:  DATA 6D,3A
04E6:  DATA 00,00
04E8:  DATA 64,65
04EA:  DATA 6D,3A
04EC:  DATA 00,00
04EE:  DATA 6C,63
04F0:  DATA 64,3A
04F2:  DATA 20,64
04F4:  DATA 65,6D
04F6:  DATA 20,73
04F8:  DATA 61,6E
04FA:  DATA 20,70
04FC:  DATA 68,61
04FE:  DATA 6D,3A
0500:  DATA 00,00
0502:  DATA 68,69
0504:  DATA 65,6E
0506:  DATA 20,74
0508:  DATA 68,69
050A:  DATA 20,6E
050C:  DATA 68,69
050E:  DATA 65,74
0510:  DATA 20,64
0512:  DATA 6F,00
0514:  DATA 4C,4D
0516:  DATA 33,35
0518:  DATA 41,3A
051A:  DATA 20,00
051C:  DATA 4C,4D
051E:  DATA 33,35
0520:  DATA 42,3A
0522:  DATA 20,00
0524:  DATA 4E,48
0526:  DATA 49,45
0528:  DATA 54,20
052A:  DATA 44,4F
052C:  DATA 20,4C
052E:  DATA 4D,33
0530:  DATA 35,41
0532:  DATA 3A,20
0534:  DATA 00,00
0536:  DATA 4E,48
0538:  DATA 49,45
053A:  DATA 54,20
053C:  DATA 44,4F
053E:  DATA 20,4C
0540:  DATA 4D,33
0542:  DATA 35,42
0544:  DATA 3A,20
0546:  DATA 00,00
0548:  DATA 44,45
054A:  DATA 4D,20
054C:  DATA 53,41
054E:  DATA 4E,20
0550:  DATA 50,48
0552:  DATA 41,4D
0554:  DATA 3A,20
0556:  DATA 00,00
0558:  DATA 4C,4D
055A:  DATA 33,35
055C:  DATA 41,3A
055E:  DATA 20,00
0560:  DATA 4C,4D
0562:  DATA 33,35
0564:  DATA 42,3A
0566:  DATA 20,00
0568:  DATA 44,45
056A:  DATA 4D,20
056C:  DATA 53,41
056E:  DATA 4E,20
0570:  DATA 50,48
0572:  DATA 41,4D
0574:  DATA 3A,20
0576:  DATA 00,00
0578:  DATA 4B,43
057A:  DATA 3A,20
057C:  DATA 00,00
057E:  DATA 4E,68
0580:  DATA 69,65
0582:  DATA 74,20
0584:  DATA 64,6F
0586:  DATA 20,3A
0588:  DATA 20,20
058A:  DATA 00,00
058C:  DATA 63,6C
058E:  DATA 6F,63
0590:  DATA 6B,3A
0592:  DATA 00,00
0594:  DATA 20,20
0596:  DATA 00,00
0598:  DATA 20,20
059A:  DATA 00,00
059C:  DATA 20,20
059E:  DATA 00,00
05A0:  DATA 20,20
05A2:  DATA 00,00
05A4:  DATA 20,20
05A6:  DATA 00,00
05A8:  DATA 20,20
05AA:  DATA 00,00
05AC:  DATA 20,20
05AE:  DATA 00,00
05B0:  DATA 20,20
05B2:  DATA 00,00
05B4:  DATA 20,20
05B6:  DATA 00,00
05B8:  DATA 20,20
05BA:  DATA 00,00
05BC:  DATA 20,20
05BE:  DATA 00,00
05C0:  DATA 20,20
05C2:  DATA 00,00
05C4:  DATA 20,20
05C6:  DATA 20,20
05C8:  DATA 20,20
05CA:  DATA 20,20
05CC:  DATA 20,20
05CE:  DATA 20,20
05D0:  DATA 20,20
05D2:  DATA 20,20
05D4:  DATA 20,20
05D6:  DATA 20,20
05D8:  DATA 00,00
05DA:  DATA 20,20
05DC:  DATA 20,20
05DE:  DATA 20,20
05E0:  DATA 20,20
05E2:  DATA 20,20
05E4:  DATA 20,20
05E6:  DATA 20,20
05E8:  DATA 20,20
05EA:  DATA 20,20
05EC:  DATA 20,20
05EE:  DATA 00,00
*
0A62:  MOVLB  5
0A64:  MOVF   x9A,W
0A66:  XORWF  x9B,W
0A68:  ANDLW  80
0A6A:  MOVWF  x9D
0A6C:  BTFSS  x9A.7
0A6E:  BRA    0A74
0A70:  COMF   x9A,F
0A72:  INCF   x9A,F
0A74:  BTFSS  x9B.7
0A76:  BRA    0A7C
0A78:  COMF   x9B,F
0A7A:  INCF   x9B,F
0A7C:  MOVF   x9B,W
0A7E:  CLRF   01
0A80:  SUBWF  x9A,W
0A82:  BC    0A8A
0A84:  MOVFF  59A,00
0A88:  BRA    0AA2
0A8A:  CLRF   00
0A8C:  MOVLW  08
0A8E:  MOVWF  x9C
0A90:  RLCF   x9A,F
0A92:  RLCF   00,F
0A94:  MOVF   x9B,W
0A96:  SUBWF  00,W
0A98:  BTFSC  FD8.0
0A9A:  MOVWF  00
0A9C:  RLCF   01,F
0A9E:  DECFSZ x9C,F
0AA0:  BRA    0A90
0AA2:  BTFSS  x9D.7
0AA4:  BRA    0AAA
0AA6:  COMF   01,F
0AA8:  INCF   01,F
0AAA:  MOVLB  0
0AAC:  RETURN 0
*
0B32:  MOVLB  5
0B34:  MOVF   x9A,W
0B36:  CLRF   01
0B38:  SUBWF  x99,W
0B3A:  BC    0B42
0B3C:  MOVFF  599,00
0B40:  BRA    0B5A
0B42:  CLRF   00
0B44:  MOVLW  08
0B46:  MOVWF  x9B
0B48:  RLCF   x99,F
0B4A:  RLCF   00,F
0B4C:  MOVF   x9A,W
0B4E:  SUBWF  00,W
0B50:  BTFSC  FD8.0
0B52:  MOVWF  00
0B54:  RLCF   01,F
0B56:  DECFSZ x9B,F
0B58:  BRA    0B48
0B5A:  MOVLB  0
0B5C:  RETURN 0
*
0B82:  CLRF   00
0B84:  CLRF   01
0B86:  MOVLB  5
0B88:  MOVF   x9F,W
0B8A:  BCF    FD8.0
0B8C:  BTFSC  xA0.0
0B8E:  ADDWF  00,F
0B90:  RRCF   00,F
0B92:  RRCF   01,F
0B94:  BTFSC  xA0.1
0B96:  ADDWF  00,F
0B98:  RRCF   00,F
0B9A:  RRCF   01,F
0B9C:  BTFSC  xA0.2
0B9E:  ADDWF  00,F
0BA0:  RRCF   00,F
0BA2:  RRCF   01,F
0BA4:  BTFSC  xA0.3
0BA6:  ADDWF  00,F
0BA8:  RRCF   00,F
0BAA:  RRCF   01,F
0BAC:  BTFSC  xA0.4
0BAE:  ADDWF  00,F
0BB0:  RRCF   00,F
0BB2:  RRCF   01,F
0BB4:  BTFSC  xA0.5
0BB6:  ADDWF  00,F
0BB8:  RRCF   00,F
0BBA:  RRCF   01,F
0BBC:  BTFSC  xA0.6
0BBE:  ADDWF  00,F
0BC0:  RRCF   00,F
0BC2:  RRCF   01,F
0BC4:  BTFSC  xA0.7
0BC6:  ADDWF  00,F
0BC8:  RRCF   00,F
0BCA:  RRCF   01,F
0BCC:  MOVLB  0
0BCE:  GOTO   0C0E (RETURN)
*
0C48:  TBLRD*+
0C4A:  MOVF   FF5,F
0C4C:  BZ    0C66
0C4E:  MOVFF  FF6,599
0C52:  MOVFF  FF7,59A
0C56:  MOVFF  FF5,5A0
0C5A:  RCALL  09F8
0C5C:  MOVFF  599,FF6
0C60:  MOVFF  59A,FF7
0C64:  BRA    0C48
0C66:  RETURN 0
0C68:  CLRF   01
0C6A:  CLRF   02
0C6C:  CLRF   00
0C6E:  CLRF   03
0C70:  MOVLB  5
0C72:  MOVF   x9C,W
0C74:  BNZ   0C7A
0C76:  MOVF   x9B,W
0C78:  BZ    0CAA
0C7A:  MOVLW  10
0C7C:  MOVWF  x9D
0C7E:  BCF    FD8.0
0C80:  RLCF   x99,F
0C82:  RLCF   x9A,F
0C84:  RLCF   00,F
0C86:  RLCF   03,F
0C88:  MOVF   x9C,W
0C8A:  SUBWF  03,W
0C8C:  BNZ   0C92
0C8E:  MOVF   x9B,W
0C90:  SUBWF  00,W
0C92:  BNC   0CA2
0C94:  MOVF   x9B,W
0C96:  SUBWF  00,F
0C98:  BTFSS  FD8.0
0C9A:  DECF   03,F
0C9C:  MOVF   x9C,W
0C9E:  SUBWF  03,F
0CA0:  BSF    FD8.0
0CA2:  RLCF   01,F
0CA4:  RLCF   02,F
0CA6:  DECFSZ x9D,F
0CA8:  BRA    0C7E
0CAA:  MOVLB  0
0CAC:  RETURN 0
*
0DEE:  MOVLW  8E
0DF0:  MOVWF  00
0DF2:  MOVFF  59A,01
0DF6:  MOVFF  599,02
0DFA:  CLRF   03
0DFC:  MOVF   01,F
0DFE:  BNZ   0E12
0E00:  MOVFF  02,01
0E04:  CLRF   02
0E06:  MOVLW  08
0E08:  SUBWF  00,F
0E0A:  MOVF   01,F
0E0C:  BNZ   0E12
0E0E:  CLRF   00
0E10:  BRA    0E22
0E12:  BCF    FD8.0
0E14:  BTFSC  01.7
0E16:  BRA    0E20
0E18:  RLCF   02,F
0E1A:  RLCF   01,F
0E1C:  DECF   00,F
0E1E:  BRA    0E12
0E20:  BCF    01.7
0E22:  GOTO   1006 (RETURN)
0E26:  MOVLB  5
0E28:  MOVF   x99,W
0E2A:  BTFSC  FD8.2
0E2C:  BRA    0F78
0E2E:  MOVWF  xA5
0E30:  MOVF   x9D,W
0E32:  BTFSC  FD8.2
0E34:  BRA    0F78
0E36:  SUBWF  xA5,F
0E38:  BNC   0E44
0E3A:  MOVLW  7F
0E3C:  ADDWF  xA5,F
0E3E:  BTFSC  FD8.0
0E40:  BRA    0F78
0E42:  BRA    0E50
0E44:  MOVLW  81
0E46:  SUBWF  xA5,F
0E48:  BTFSS  FD8.0
0E4A:  BRA    0F78
0E4C:  BTFSC  FD8.2
0E4E:  BRA    0F78
0E50:  MOVFF  5A5,00
0E54:  CLRF   01
0E56:  CLRF   02
0E58:  CLRF   03
0E5A:  CLRF   xA4
0E5C:  MOVFF  59A,5A3
0E60:  BSF    xA3.7
0E62:  MOVFF  59B,5A2
0E66:  MOVFF  59C,5A1
0E6A:  MOVLW  19
0E6C:  MOVWF  xA5
0E6E:  MOVF   xA0,W
0E70:  SUBWF  xA1,F
0E72:  BC    0E8E
0E74:  MOVLW  01
0E76:  SUBWF  xA2,F
0E78:  BC    0E8E
0E7A:  SUBWF  xA3,F
0E7C:  BC    0E8E
0E7E:  SUBWF  xA4,F
0E80:  BC    0E8E
0E82:  INCF   xA4,F
0E84:  INCF   xA3,F
0E86:  INCF   xA2,F
0E88:  MOVF   xA0,W
0E8A:  ADDWF  xA1,F
0E8C:  BRA    0EDE
0E8E:  MOVF   x9F,W
0E90:  SUBWF  xA2,F
0E92:  BC    0EB8
0E94:  MOVLW  01
0E96:  SUBWF  xA3,F
0E98:  BC    0EB8
0E9A:  SUBWF  xA4,F
0E9C:  BC    0EB8
0E9E:  INCF   xA4,F
0EA0:  INCF   xA3,F
0EA2:  MOVF   x9F,W
0EA4:  ADDWF  xA2,F
0EA6:  MOVF   xA0,W
0EA8:  ADDWF  xA1,F
0EAA:  BNC   0EDE
0EAC:  INCF   xA2,F
0EAE:  BNZ   0EDE
0EB0:  INCF   xA3,F
0EB2:  BNZ   0EDE
0EB4:  INCF   xA4,F
0EB6:  BRA    0EDE
0EB8:  MOVF   x9E,W
0EBA:  IORLW  80
0EBC:  SUBWF  xA3,F
0EBE:  BC    0EDC
0EC0:  MOVLW  01
0EC2:  SUBWF  xA4,F
0EC4:  BC    0EDC
0EC6:  INCF   xA4,F
0EC8:  MOVF   x9E,W
0ECA:  IORLW  80
0ECC:  ADDWF  xA3,F
0ECE:  MOVF   x9F,W
0ED0:  ADDWF  xA2,F
0ED2:  BNC   0EA6
0ED4:  INCF   xA3,F
0ED6:  BNZ   0EA6
0ED8:  INCF   xA4,F
0EDA:  BRA    0EA6
0EDC:  BSF    03.0
0EDE:  DECFSZ xA5,F
0EE0:  BRA    0EE4
0EE2:  BRA    0EFA
0EE4:  BCF    FD8.0
0EE6:  RLCF   xA1,F
0EE8:  RLCF   xA2,F
0EEA:  RLCF   xA3,F
0EEC:  RLCF   xA4,F
0EEE:  BCF    FD8.0
0EF0:  RLCF   03,F
0EF2:  RLCF   02,F
0EF4:  RLCF   01,F
0EF6:  RLCF   xA6,F
0EF8:  BRA    0E6E
0EFA:  BTFSS  xA6.0
0EFC:  BRA    0F0A
0EFE:  BCF    FD8.0
0F00:  RRCF   01,F
0F02:  RRCF   02,F
0F04:  RRCF   03,F
0F06:  RRCF   xA6,F
0F08:  BRA    0F0E
0F0A:  DECF   00,F
0F0C:  BZ    0F78
0F0E:  BTFSC  xA6.7
0F10:  BRA    0F4E
0F12:  BCF    FD8.0
0F14:  RLCF   xA1,F
0F16:  RLCF   xA2,F
0F18:  RLCF   xA3,F
0F1A:  RLCF   xA4,F
0F1C:  MOVF   xA0,W
0F1E:  SUBWF  xA1,F
0F20:  BC    0F30
0F22:  MOVLW  01
0F24:  SUBWF  xA2,F
0F26:  BC    0F30
0F28:  SUBWF  xA3,F
0F2A:  BC    0F30
0F2C:  SUBWF  xA4,F
0F2E:  BNC   0F64
0F30:  MOVF   x9F,W
0F32:  SUBWF  xA2,F
0F34:  BC    0F40
0F36:  MOVLW  01
0F38:  SUBWF  xA3,F
0F3A:  BC    0F40
0F3C:  SUBWF  xA4,F
0F3E:  BNC   0F64
0F40:  MOVF   x9E,W
0F42:  IORLW  80
0F44:  SUBWF  xA3,F
0F46:  BC    0F4E
0F48:  MOVLW  01
0F4A:  SUBWF  xA4,F
0F4C:  BNC   0F64
0F4E:  INCF   03,F
0F50:  BNZ   0F64
0F52:  INCF   02,F
0F54:  BNZ   0F64
0F56:  INCF   01,F
0F58:  BNZ   0F64
0F5A:  INCF   00,F
0F5C:  BZ    0F78
0F5E:  RRCF   01,F
0F60:  RRCF   02,F
0F62:  RRCF   03,F
0F64:  MOVFF  59A,5A5
0F68:  MOVF   x9E,W
0F6A:  XORWF  xA5,F
0F6C:  BTFSS  xA5.7
0F6E:  BRA    0F74
0F70:  BSF    01.7
0F72:  BRA    0F80
0F74:  BCF    01.7
0F76:  BRA    0F80
0F78:  CLRF   00
0F7A:  CLRF   01
0F7C:  CLRF   02
0F7E:  CLRF   03
0F80:  MOVLB  0
0F82:  GOTO   102C (RETURN)
0F86:  MOVLW  8E
0F88:  MOVWF  00
0F8A:  MOVLB  5
0F8C:  MOVF   x99,W
0F8E:  SUBWF  00,F
0F90:  MOVFF  59A,02
0F94:  MOVFF  59B,01
0F98:  BSF    02.7
0F9A:  MOVF   00,F
0F9C:  BZ    0FB0
0F9E:  BCF    FD8.0
0FA0:  MOVF   02,F
0FA2:  BNZ   0FA8
0FA4:  MOVF   01,F
0FA6:  BZ    0FB0
0FA8:  RRCF   02,F
0FAA:  RRCF   01,F
0FAC:  DECFSZ 00,F
0FAE:  BRA    0F9E
0FB0:  BTFSS  x9A.7
0FB2:  BRA    0FBE
0FB4:  COMF   01,F
0FB6:  COMF   02,F
0FB8:  INCF   01,F
0FBA:  BTFSC  FD8.2
0FBC:  INCF   02,F
0FBE:  MOVLB  0
0FC0:  GOTO   103E (RETURN)
....................  
.................... #list 
....................  
.................... #device     adc=10 
.................... #fuses      nowdt,put,hs,noprotect,nolvp,cpudiv1 
.................... #use        i2c(master,slow,sda=pin_b0,scl=pin_b1) 
*
0944:  MOVLW  08
0946:  MOVWF  01
0948:  NOP   
094A:  BCF    F8A.1
094C:  BCF    F93.1
094E:  NOP   
0950:  MOVLB  5
0952:  RLCF   x9A,F
0954:  BCF    F8A.0
0956:  BTFSC  FD8.0
0958:  BSF    F93.0
095A:  BTFSS  FD8.0
095C:  BCF    F93.0
095E:  BSF    F93.1
0960:  BTFSS  F81.1
0962:  BRA    0960
0964:  DECFSZ 01,F
0966:  BRA    096A
0968:  BRA    096E
096A:  MOVLB  0
096C:  BRA    0948
096E:  NOP   
0970:  BCF    F8A.1
0972:  BCF    F93.1
0974:  NOP   
0976:  BSF    F93.0
0978:  NOP   
097A:  NOP   
097C:  BSF    F93.1
097E:  BTFSS  F81.1
0980:  BRA    097E
0982:  CLRF   01
0984:  NOP   
0986:  BTFSC  F81.0
0988:  BSF    01.0
098A:  BCF    F8A.1
098C:  BCF    F93.1
098E:  BCF    F8A.0
0990:  BCF    F93.0
0992:  MOVLB  0
0994:  RETURN 0
.................... #use        delay(clock=20000000)       
*
0738:  MOVLW  05
073A:  MOVWF  FEA
073C:  MOVLW  99
073E:  MOVWF  FE9
0740:  MOVF   FEF,W
0742:  BZ    075E
0744:  MOVLW  06
0746:  MOVWF  01
0748:  CLRF   00
074A:  DECFSZ 00,F
074C:  BRA    074A
074E:  DECFSZ 01,F
0750:  BRA    0748
0752:  MOVLW  7B
0754:  MOVWF  00
0756:  DECFSZ 00,F
0758:  BRA    0756
075A:  DECFSZ FEF,F
075C:  BRA    0744
075E:  GOTO   07A6 (RETURN)
*
07BE:  MOVLW  03
07C0:  MOVLB  5
07C2:  SUBWF  x9B,F
07C4:  BNC   07DA
07C6:  MOVLW  05
07C8:  MOVWF  FEA
07CA:  MOVLW  9B
07CC:  MOVWF  FE9
07CE:  MOVF   FEF,W
07D0:  BZ    07DA
07D2:  BRA    07D6
07D4:  BRA    07D6
07D6:  DECFSZ FEF,F
07D8:  BRA    07D4
07DA:  MOVLB  0
07DC:  RETURN 0
.................... //#use        rs232(baud=9600, xmit=pin_c6,rcv=pin_c7)  
....................  
.................... #define  usi8  unsigned int8      
.................... #define  usi16 unsigned int16            
.................... #define  usi32 unsigned int32                                                                     
.................... #define  si8   signed int8     
....................  
.................... #define co_reset  true 
.................... #define no_reset  false  
....................  
.................... #define tt_on     1           
.................... #define tt_off    0        
.................... #define enable    1                         
.................... #define disable   0 
.................... #define sang      1           
.................... #define tat       0   
.................... #define tat_l7d  0xff      
.................... #define cx_vn     true   //co xoa so 0 vo nghia         
.................... #define kx_vn     false  //khong xoa so 0 vo nghia           
.................... #define co_fill  true 
.................... #define no_fill  false   
....................  
.................... unsigned int8 i; 
.................... unsigned int8 y8,sl; 
.................... unsigned int16 lt,lp; 
.................... unsigned int32 y; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //dinh nghia cac trang thai co nhan va khong nhan phim 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... #define co_nhan      1             
.................... #define khong_nhan   0            
.................... #define c_ktnp       1  //co kiem tra nha phim           
.................... #define k_ktnp       0  //khong kiem tra nha phim  
.................... #define sole_1       false             
.................... #define sole_2       true   
....................  
.................... int1 tt_on_off=0,tt_inv=0;   
.................... unsigned int16  dl_btn=0; 
.................... //int1 tt_led=0,tt_ena_dis=0;   
.................... //int1 t0_on_off=0,tt_1btn=0;    
.................... //int1 t3_on_off=0;  
.................... //int1 refresh=0;  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //ham reset cac bien 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... void reset_cac_bien() 
.................... {      
....................    tt_on_off=0;tt_inv=0; 
*
05F0:  BCF    21.0
05F2:  BCF    21.1
....................    dl_btn=0; 
05F4:  CLRF   23
05F6:  CLRF   22
....................    y8=0; lt=0;lp=0;y=0;sl=0; 
05F8:  CLRF   17
05FA:  CLRF   1A
05FC:  CLRF   19
05FE:  CLRF   1C
0600:  CLRF   1B
0602:  CLRF   20
0604:  CLRF   1F
0606:  CLRF   1E
0608:  CLRF   1D
060A:  CLRF   18
060C:  GOTO   0656 (RETURN)
.................... }              
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  enable_573a      pin_d1  //cs0 cua a  
.................... #define  enable_573b      pin_d0  //cs1 cua b 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx       
.................... #define  ssdo             pin_e2  //chung tat ca 
.................... #define  ssck             pin_e0  //chung tat ca 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  rck_4led7doan    pin_d7  //a - 4 byte 
.................... #define  g_4led7doan      pin_d6  //a - 4 byte 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  rck_matranled    pin_d7  //b - 3 byte dao 
.................... #define  g_matranled      pin_d6  //b - 3 byte dao 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  rck_32led        pin_d5  //a - 4 byte 
.................... #define  g_32led          pin_d4  //a - 4 byte 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  rck_8ledquet     pin_d5  //b - 2 byte dao 
.................... #define  g_8ledquet       pin_d4  //b - 2 byte dao 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  rck_lcd20x4      pin_d3  //a - 2 byte dao 
.................... #define  g_lcd20x4        pin_d2  //a - 2 byte dao 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  rck_buzerelay    pin_d3  //b - 1 byte 
.................... #define  g_buzerelay      pin_d2  //b - 1 byte  
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define     chot_2_ic_74573_a_b  output_d(0xfc) 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... unsigned int8 tin_hieu_dk_74573_a; 
.................... #bit     g_4a    = tin_hieu_dk_74573_a.6 
.................... #bit     g_32a   = tin_hieu_dk_74573_a.4 
.................... #bit     g_lcda  = tin_hieu_dk_74573_a.2 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  mo_32_led_don    g_32a=0; 
.................... #define  tat_32_led_don   g_32a=1;  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  mo_4_led_7doan   g_4a=0; 
.................... #define  tat_4_led_7doan  g_4a=1;   
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  mo_glcd_lcd      g_lcda=0; 
.................... #define  tat_glcd_lcd     g_lcda=1;   
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx     
.................... unsigned int8 tin_hieu_dk_74573_b;   
.................... #bit     g_mtb   = tin_hieu_dk_74573_b.6 
.................... #bit     g_8b    = tin_hieu_dk_74573_b.4 
.................... #bit     g_rbdcb = tin_hieu_dk_74573_b.2 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  mo_led_matran        g_mtb=0; 
.................... #define  tat_led_matran       g_mtb=1;  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  mo_8_led_quet        g_8b=0; 
.................... #define  tat_8_led_quet       g_8b=1;                         
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  mo_relay_buzzer_dc   g_rbdcb=0; 
.................... #define  tat_relay_buzzer_dc  g_rbdcb=1;  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //chuong trinh con khoi tao ic chot 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... #define  cho_ic_74573_a_goi_du_lieu     output_high(enable_573a) 
.................... #define  chot_ic_74573_a_goi_du_lieu    output_low(enable_573a) 
....................  
.................... #define  cho_ic_74573_b_goi_du_lieu     output_high(enable_573b) 
.................... #define  chot_ic_74573_b_goi_du_lieu    output_low(enable_573b) 
.................... void mo_ic_74573_a_thong_dl(); 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //khai bao du lieu 16 bit cho module relay, triac, buzzer, dong co 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... unsigned int16 rbdc; 
.................... #bit step_motor_enable  = rbdc.0    //1=ena,0=dis 
.................... #bit step_motor_in1     = rbdc.1     
.................... #bit step_motor_in2     = rbdc.2 
.................... #bit step_motor_in3     = rbdc.3 
.................... #bit step_motor_in4     = rbdc.4 
.................... #bit dc_enable          = rbdc.5    //1=ena,0=dis 
.................... #bit pwrkey             = rbdc.6    //khoi tao sim900 
....................  
.................... #bit buzzer             = rbdc.8    //1=on,0=off 
.................... #bit triac_1            = rbdc.9    //1=on,0=off 
.................... #bit triac_2            = rbdc.10   //1=on,0=off 
.................... #bit relay_1            = rbdc.11   //0=on,1=off 
.................... #bit relay_2            = rbdc.12   //0=on,1=off   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //xuat các thieu dieu khien 
.................... //giu nguyen cac trang thai cua 2 module khac 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... void mo_ic_74573_a_thong_dl() 
.................... {      
....................    output_d(0x00); 
*
06A6:  CLRF   F95
06A8:  CLRF   F8C
....................    output_bit(g_32led,g_32a); 
06AA:  BTFSC  24.4
06AC:  BRA    06B2
06AE:  BCF    F8C.4
06B0:  BRA    06B4
06B2:  BSF    F8C.4
06B4:  BCF    F95.4
....................    output_bit(g_4led7doan,g_4a); 
06B6:  BTFSC  24.6
06B8:  BRA    06BE
06BA:  BCF    F8C.6
06BC:  BRA    06C0
06BE:  BSF    F8C.6
06C0:  BCF    F95.6
....................    output_bit(g_lcd20x4,g_lcda);   
06C2:  BTFSC  24.2
06C4:  BRA    06CA
06C6:  BCF    F8C.2
06C8:  BRA    06CC
06CA:  BSF    F8C.2
06CC:  BCF    F95.2
....................    cho_ic_74573_a_goi_du_lieu; 
06CE:  BCF    F95.1
06D0:  BSF    F8C.1
06D2:  RETURN 0
.................... }   
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... void mo_ic_74573_b_thong_dl() 
.................... {      
....................    output_d(0x00); 
*
0A02:  CLRF   F95
0A04:  CLRF   F8C
....................    output_bit(g_matranled,g_mtb); 
0A06:  BTFSC  25.6
0A08:  BRA    0A0E
0A0A:  BCF    F8C.6
0A0C:  BRA    0A10
0A0E:  BSF    F8C.6
0A10:  BCF    F95.6
....................    output_bit(g_8ledquet,g_8b); 
0A12:  BTFSC  25.4
0A14:  BRA    0A1A
0A16:  BCF    F8C.4
0A18:  BRA    0A1C
0A1A:  BSF    F8C.4
0A1C:  BCF    F95.4
....................    output_bit(g_buzerelay,g_rbdcb);  
0A1E:  BTFSC  25.2
0A20:  BRA    0A26
0A22:  BCF    F8C.2
0A24:  BRA    0A28
0A26:  BSF    F8C.2
0A28:  BCF    F95.2
....................    cho_ic_74573_b_goi_du_lieu; 
0A2A:  BCF    F95.0
0A2C:  BSF    F8C.0
0A2E:  GOTO   0A4A (RETURN)
.................... }                                   
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //ham khoi tao cac port va ic chot 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... void set_up_port_ic_chot() 
.................... {      
....................    set_tris_d(0x00);                     
*
0610:  MOVLW  00
0612:  MOVWF  F95
....................    output_d(0xff); 
0614:  CLRF   F95
0616:  SETF   F8C
....................    tin_hieu_dk_74573_a=0xff;             
0618:  SETF   24
....................    tin_hieu_dk_74573_b=0xff;       
061A:  SETF   25
....................    chot_ic_74573_a_goi_du_lieu; 
061C:  BCF    F95.1
061E:  BCF    F8C.1
....................    chot_ic_74573_b_goi_du_lieu;   
0620:  BCF    F95.0
0622:  BCF    F8C.0
....................    set_tris_a(0x1f); 
0624:  MOVLW  1F
0626:  MOVWF  F92
....................    set_tris_e(0x00); 
0628:  MOVLW  00
062A:  MOVWF  F96
....................    set_tris_B(0x3c);      
062C:  MOVLW  3C
062E:  MOVWF  F93
....................    rbdc=0; 
0630:  CLRF   27
0632:  CLRF   26
....................  
....................    setup_adc(adc_clock_div_32); 
0634:  MOVF   FC0,W
0636:  ANDLW  C0
0638:  IORLW  02
063A:  MOVWF  FC0
063C:  BSF    FC0.7
063E:  BSF    FC2.0
....................    setup_adc_ports(an0_to_an2|vss_vdd );          
0640:  MOVF   FC1,W
0642:  ANDLW  C0
0644:  IORLW  0C
0646:  MOVWF  FC1
....................    set_adc_channel(2); 
0648:  MOVLW  08
064A:  MOVWF  01
064C:  MOVF   FC2,W
064E:  ANDLW  C3
0650:  IORWF  01,W
0652:  MOVWF  FC2
....................    reset_cac_bien(); 
0654:  BRA    05F0
0656:  GOTO   12DC (RETURN)
.................... }  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //ham 102: xuat 1 byte ra thanh ghi dich 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... void xuat_1byte(unsigned int8 bytexuat) 
.................... {                         
....................    unsigned int8   sb;    
....................    #bit bseri  = bytexuat.7                       
....................    for (sb=0;sb<8;sb++) 
*
067C:  MOVLB  5
067E:  CLRF   xA8
0680:  MOVF   xA8,W
0682:  SUBLW  07
0684:  BNC   06A2
....................    {                                                  
....................       output_bit(ssdo,bseri);     
0686:  BTFSC  xA7.7
0688:  BRA    068E
068A:  BCF    F8D.2
068C:  BRA    0690
068E:  BSF    F8D.2
0690:  BCF    F96.2
....................       output_low(ssck); output_high(ssck); 
0692:  BCF    F96.0
0694:  BCF    F8D.0
0696:  BCF    F96.0
0698:  BSF    F8D.0
....................       bytexuat = bytexuat<<1;          
069A:  BCF    FD8.0
069C:  RLCF   xA7,F
069E:  INCF   xA8,F
06A0:  BRA    0680
....................    } 
06A2:  MOVLB  0
06A4:  RETURN 0
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //module dieu khien relay,triac, buzzer, dong co, sim 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void xuat_buzzer_relay() 
.................... {      
....................    unsigned int8 rbdc1,rbdc2; 
....................    rbdc1=rbdc; rbdc2=rbdc>>8;       
*
0A32:  MOVFF  26,599
0A36:  MOVFF  27,59A
....................    xuat_1byte(rbdc2);      xuat_1byte(rbdc1);       
0A3A:  MOVFF  59A,5A7
0A3E:  RCALL  067C
0A40:  MOVFF  599,5A7
0A44:  RCALL  067C
....................    mo_relay_buzzer_dc; 
0A46:  BCF    25.2
....................    mo_ic_74573_b_thong_dl(); 
0A48:  BRA    0A02
....................        
....................    output_high(rck_buzerelay);   output_low(rck_buzerelay); 
0A4A:  BCF    F95.3
0A4C:  BSF    F8C.3
0A4E:  BCF    F95.3
0A50:  BCF    F8C.3
....................    chot_ic_74573_b_goi_du_lieu; 
0A52:  BCF    F95.0
0A54:  BCF    F8C.0
0A56:  GOTO   0A5E (RETURN)
.................... } 
.................... //ham 602 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void buzzer_on() 
.................... {     
....................    buzzer=1; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 603 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void buzzer_off() 
.................... {      
....................    buzzer=0; 
....................    xuat_buzzer_relay(); 
.................... } 
.................... //ham 604 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void relay_1_on() 
.................... {     
....................    relay_1=1; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 603 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void relay_1_off() 
.................... {     
....................    relay_1=0; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 604 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void relay_2_on() 
.................... {     
....................    relay_2=1; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 607 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void relay_2_off() 
.................... {     
....................    relay_2=0; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 608 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void relay_1_relay_2_on() 
.................... {     
....................    relay_1=1;  relay_2=1; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 609 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void relay_1_relay_2_off() 
.................... {     
....................    relay_1=0;  relay_2=0; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 610 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void triac_1_on() 
.................... {     
....................    triac_1=1; 
....................    xuat_buzzer_relay();          
.................... }    
.................... //ham 611 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void triac_1_off() 
.................... {     
....................    triac_1=0; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 612 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void triac_2_on() 
.................... {     
....................    triac_2=1; 
....................    xuat_buzzer_relay();          
.................... } 
.................... //ham 613 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void triac_2_off() 
.................... {     
....................    triac_2=0; 
....................    xuat_buzzer_relay();          
.................... }   
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx         
.................... const unsigned char ma7doan[16]= { 
.................... 0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8, 
.................... 0x80,0x90,0x88,0x83,0xc6,0xa1,0x86,0x8e}; 
.................... #define     maso0    0xc0 
.................... #define     maso1    0xf9                          
.................... #define     maso2    0xa4     
.................... #define     maso3    0xb0 
.................... #define     maso4    0x99 
.................... #define     maso5    0x92 
.................... #define     maso6    0x82                      
.................... #define     maso7    0xf8   
....................  
.................... #include <tv_03_mbi_32led_don.c> 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //ham 301 
.................... //chuong trinh con xuat 4 byte ra 32 led don 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... void xuat_32led_don_4byte(unsigned int8 bld3,bld2,bld1,bld0) 
.................... {      
....................       xuat_1byte(bld3);           
....................       xuat_1byte(bld2);                      
....................       xuat_1byte(bld1);           
....................       xuat_1byte(bld0);             
....................       mo_32_led_don;       
....................       mo_ic_74573_a_thong_dl();             
....................       output_high(rck_32led);    output_low(rck_32led); 
....................       chot_ic_74573_a_goi_du_lieu;       
.................... } 
.................... //ham 302 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con xuat 2 word 16 bitra 32 led don 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void xuat_32led_don_2word(unsigned int16 wld1, unsigned int16 wld0) 
.................... {      
....................      unsigned int8  b3,b2,b1,b0; 
....................      b3 = wld1>>8;  b2 = wld1;  
....................      b1 = wld0>>8;  b0 = wld0; 
....................      xuat_32led_don_4byte(b3,b2,b1,b0); 
.................... } 
.................... //ham 303 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con xuat 1 double word ra 32 led don 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void xuat_32led_don_1dw(unsigned long long dwld) 
.................... {      
....................      unsigned int16  wd1,wd0; 
....................      wd1 = dwld>>16;  wd0 = dwld; 
....................      xuat_32led_don_2word(wd1,wd0); 
.................... }  
....................  
....................  
.................... #include <tv_04_mbi_4led_7doan.c> 
.................... //ham 401 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //chuong trinh con xuat 4 byte ra 4 led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... void xuat_4led_7doan_4so(unsigned int bl743,bl742,bl741,bl740) 
.................... {      
....................       xuat_1byte(bl740);   xuat_1byte(bl741); 
*
0AAE:  MOVFF  59E,5A7
0AB2:  RCALL  067C
0AB4:  MOVFF  59D,5A7
0AB8:  RCALL  067C
....................       xuat_1byte(bl742);   xuat_1byte(bl743); 
0ABA:  MOVFF  59C,5A7
0ABE:  RCALL  067C
0AC0:  MOVFF  59B,5A7
0AC4:  RCALL  067C
....................        
....................       mo_4_led_7doan; 
0AC6:  BCF    24.6
....................       mo_ic_74573_a_thong_dl(); 
0AC8:  RCALL  06A6
....................         
....................       output_low(rck_4led7doan);   output_high(rck_4led7doan);  
0ACA:  BCF    F95.7
0ACC:  BCF    F8C.7
0ACE:  BCF    F95.7
0AD0:  BSF    F8C.7
....................       chot_ic_74573_a_goi_du_lieu; 
0AD2:  BCF    F95.1
0AD4:  BCF    F8C.1
0AD6:  GOTO   0B2E (RETURN)
.................... } 
.................... //ham 404 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... void xuat_4led_7doan_3so(unsigned int bl742,bl741,bl740) 
.................... {      
....................      xuat_4led_7doan_4so(0xff,bl742,bl741,bl740); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //ham 403 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... void xuat_4led_7doan_2so(unsigned int bl741,bl740) 
.................... {      
....................      xuat_4led_7doan_4so(0xff,0xff,bl741,bl740); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //ham 402 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... void xuat_4led_7doan_1so(unsigned int bl740) 
.................... {      
....................      xuat_4led_7doan_4so(0xff,0xff,0xff,bl740); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                                                            
.................... //ham 405 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con hien thi du lieu 16 bit tren 4 led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... unsigned char donvi4,chuc4,tram4,ngan4; 
.................... void  xuat_4led_7doan_giaima_xoa_so0 (unsigned int16 tam) 
.................... {          
....................       donvi4 = ma7doan[tam %10];          
....................       chuc4  = ma7doan[tam/10%10]; 
....................       tram4  = ma7doan[tam/100%10];  
....................       ngan4  = ma7doan[tam/1000%10];        
....................       if (ngan4==0xc0) 
....................       { 
....................          ngan4=0xff; 
....................          if (tram4==0xc0) 
....................          { 
....................             tram4=0xff; 
....................             if (chuc4==0xc0)   chuc4=0xff; 
....................          } 
....................       } 
....................       xuat_4led_7doan_4so(ngan4,tram4,chuc4,donvi4);    
.................... } 
....................  
.................... void  xuat_4led_7doan_2_so (unsigned int8 bh,bl) 
.................... {          
....................  xuat_4led_7doan_4so(ma7doan[bh/10],ma7doan[bh%10],ma7doan[bl/10],ma7doan[bl%10]);    
.................... }   
....................  
.................... unsigned char donvi2,donvi1,chuc2,chuc1; 
.................... void  xuat_4led_7doan_2_so_xoa_so0 (unsigned int8 bh,bl) 
.................... { 
....................    donvi2 = ma7doan[bh %10];          
....................    chuc2  = ma7doan[bh/10%10]; 
....................    donvi1 = ma7doan[bl %10];          
....................    chuc1  = ma7doan[bl/10%10]; 
....................    if(chuc2==0xc0) 
....................    { 
....................       chuc2=0xff; 
....................    } 
....................    if(chuc1==0xc0) 
....................    { 
....................       chuc1=0xff; 
....................    } 
....................    xuat_4led_7doan_4so(chuc2,donvi2,chuc1,donvi1); 
.................... } 
....................  
....................  
.................... #include <tv_05_mbi_8led_7doan.c> 
.................... //ham 501 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con xuat 2 byte ra dk 1 led quet sang 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void xuat_8led_7doan_quet_1(unsigned int ma,so_hthi) 
.................... {      
....................       xuat_1byte(~ma);   xuat_1byte(~so_hthi); 
....................        
....................       mo_8_led_quet; 
....................       mo_ic_74573_b_thong_dl(); 
....................        
....................       output_high(rck_8ledquet); output_low(rck_8ledquet); 
....................       chot_ic_74573_b_goi_du_lieu; 
.................... } 
.................... //ham 502 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con xuat 2 byte ra tat 8 led quet 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void xuat_8led_7doan_quet_tat_led() 
.................... { 
....................    xuat_8led_7doan_quet_1(0xff,0xff); 
.................... } 
.................... //ham 503 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con hien thi led theo thu tu 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... const unsigned char ttledquet[8]= {0x7f,0xbf,0xdf,0xef,0xf7,0xfb,0xfd,0xfe}; 
.................... void xuat_8led_7doan_quet_2(unsigned int thutuled,so_hthi) 
.................... {          
....................       xuat_1byte(~ (ttledquet[thutuled]));   xuat_1byte(~so_hthi);      
....................       mo_8_led_quet; 
....................       mo_ic_74573_b_thong_dl(); 
....................       output_high(rck_8ledquet); output_low(rck_8ledquet); 
....................       chot_ic_74573_b_goi_du_lieu; 
.................... } 
.................... //ham 504 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con hien thi 8 so tren 8 led quet - co kiem tra 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... unsigned char led_7dq[8]={0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff}; 
.................... unsigned int8 tt8led=0; 
.................... void hien_thi_8led_7doan_quet() 
.................... {      
....................       for(tt8led=0;tt8led<8;tt8led++) 
....................          if (led_7dq[tt8led]!=0xff) 
....................          {            
....................             xuat_8led_7doan_quet_2(tt8led, led_7dq[tt8led]); 
....................             delay_us(100); 
....................             xuat_8led_7doan_quet_tat_led();            
....................             } 
.................... } 
.................... //ham 505 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con hien thi 8 so tren 8 led quet - khong kiem tra 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void hien_thi_8led_7doan_quet_all() 
.................... {      
....................       for(tt8led=0;tt8led<8;tt8led++)          
....................          {            
....................             xuat_8led_7doan_quet_2(tt8led, led_7dq[tt8led]); 
....................             delay_us(100); 
....................             xuat_8led_7doan_quet_tat_led();            
....................             } 
.................... } 
....................  
.................... void delay_quet_8led(unsigned int16 dl) 
.................... {  
....................       unsigned int8 i; 
....................       for (i=0; i<dl;i++) 
....................       hien_thi_8led_7doan_quet_all(); 
.................... }  
....................  
.................... void giai_ma_gan_cho_8led_quet_16_xoa(unsigned int16 x) 
.................... {      
....................       led_7dq[0]= ma7doan [x %10];     
....................       led_7dq[1]= ma7doan [x/10%10]; 
....................       led_7dq[2]= ma7doan [x/100%10];     
....................       led_7dq[3]= ma7doan [x/1000%10]; 
....................       led_7dq[4]= ma7doan [x/10000%10]; 
....................       if (led_7dq[4]==maso0)  
....................       { 
....................             led_7dq[4]=0xff; 
....................             if (led_7dq[3]==maso0)  
....................             { 
....................                led_7dq[3]=0xff; 
....................                if (led_7dq[2]==maso0)  
....................                { 
....................                   led_7dq[2]=0xff; 
....................                   if (led_7dq[1]==maso0)  
....................                   { 
....................                      led_7dq[1]=0xff; 
....................                   } 
....................                } 
....................             } 
....................       } 
....................              
.................... } 
....................           
....................  
....................  
.................... #include <tv_06_mbi_lcd_glcd.c> 
.................... //ham 701 
....................    
.................... unsigned int8 lcddata=0;  
.................... unsigned int8 lcdcontrol=0; 
.................... unsigned int8 glcddata=0; 
.................... unsigned int8 glcdcontrol=0;     
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con xuat du lieu 4 byte ra glcd va lcd 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void xuat_glcd_lcd() 
.................... {       
....................     xuat_1byte(glcdcontrol);              
*
06D4:  MOVFF  3C,5A7
06D8:  RCALL  067C
....................     xuat_1byte(glcddata); 
06DA:  MOVFF  3B,5A7
06DE:  RCALL  067C
....................     xuat_1byte(lcdcontrol);        
06E0:  MOVFF  3A,5A7
06E4:  RCALL  067C
....................     xuat_1byte(lcddata);       
06E6:  MOVFF  39,5A7
06EA:  RCALL  067C
....................                                    
....................     mo_glcd_lcd; 
06EC:  BCF    24.2
....................     mo_ic_74573_a_thong_dl();             
06EE:  RCALL  06A6
....................     output_high(rck_lcd20x4);      
06F0:  BCF    F95.3
06F2:  BSF    F8C.3
....................     output_low(rck_lcd20x4); 
06F4:  BCF    F95.3
06F6:  BCF    F8C.3
....................     chot_ic_74573_a_goi_du_lieu; 
06F8:  BCF    F95.1
06FA:  BCF    F8C.1
06FC:  GOTO   0712 (RETURN)
.................... } 
.................... //ham 702 
.................... void xuat_lcd20x4(unsigned int8 lcd_signal,lcd_ins_hthi) 
.................... {      
....................     lcdcontrol = ~lcd_signal; 
0700:  MOVLB  5
0702:  MOVFF  5A5,3A
0706:  COMF   3A,F
....................     lcddata    = ~lcd_ins_hthi;       
0708:  MOVFF  5A6,39
070C:  COMF   39,F
....................     xuat_glcd_lcd(); 
070E:  MOVLB  0
0710:  BRA    06D4
0712:  RETURN 0
.................... } 
.................... //ham 703 
.................... void xuat_glcd128x64(unsigned int8 glcd_signal,glcd_ins_hthi) 
.................... {      
....................     glcdcontrol = ~glcd_signal; 
....................     glcddata    = ~glcd_ins_hthi;      
....................     xuat_glcd_lcd(); 
.................... } 
....................       
....................  
....................  
.................... #include <tv_10_mbi_led_matran.c>  
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx    
.................... //xuat 1 bit roi tra lai ket qua sau khi dich di 1 bit 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... unsigned  int8 xuat_1bit(unsigned int8 bytexuat) 
.................... { 
....................       unsigned int8   xbitx;    
....................       #bit bserix  = xbitx.0 
....................       xbitx = bytexuat; 
....................                                              
....................       output_bit(ssdo,bserix);     
....................       output_low(ssck); output_high(ssck); 
....................       xbitx= xbitx>>1;    
....................       return(xbitx);   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //ham 101 
....................  
.................... //ham 104 
....................  
....................  
....................  
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx          
.................... void xuat_2byte(unsigned int16 byte2xuat) 
.................... { 
....................    int8 sbb; 
....................    unsigned int16   xx;   //short  bseri; 
....................    #bit bserix  = xx.15 
....................    xx = byte2xuat; 
....................    for (sbb=0;sbb<16;sbb++) 
....................       {                                                  
....................          output_bit(ssdo,bserix);     
....................          output_low(ssck);         output_high(ssck); 
....................          xx= xx<<1;          
....................      } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con xuat ra led ma tran 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void xuat_matranled(unsigned int16 mahang,unsigned int16 macot1, 
.................... unsigned int16 macot2,unsigned int16 macot3) 
.................... {       
....................       xuat_2byte(macot3); 
....................       xuat_2byte(macot2); 
....................       xuat_2byte(macot1); 
....................       xuat_2byte(mahang); 
....................        
....................       mo_led_matran; 
....................       mo_ic_74573_b_thong_dl(); 
....................        
....................       output_high(rck_matranled); output_low(rck_matranled);  
....................       chot_ic_74573_b_goi_du_lieu; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //chuong trinh con xuat ra led ma tran 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void tat_matranled() 
.................... {       
....................       xuat_2byte(0); 
....................       xuat_2byte(0); 
....................       xuat_2byte(0); 
....................       xuat_2byte(0);            
....................       output_high(rck_matranled); output_low(rck_matranled);  
.................... } 
.................... unsigned  int8 hieu_chinh_4bit_cao(unsigned int8 xzy) 
.................... { 
....................       int1  btg; 
....................       unsigned int8   bx;    
....................       #bit bit4  = bx.4 
....................       #bit bit5  = bx.5 
....................       #bit bit6  = bx.6 
....................       #bit bit7  = bx.7 
....................       bx=xzy; 
....................       btg=bit4;   bit4=bit7;  bit7=btg; 
....................       btg=bit5;   bit5=bit6;  bit6=btg;       
....................       return(bx);   
.................... }   
....................  
....................  
....................  
....................  
.................... #include <TV_PICKIT2_SHIFT_32LED_DON.c> 
.................... UNSIGNED INT32 YP_CHAY=1,YT_CHAY=0X80000000,Y_CODINH=0; 
.................... UNSIGNED INT16 ZT,ZT_CHAY_T=0x8000,ZT_CHAY_P=1,ZT_CODINH=0; 
.................... UNSIGNED INT16 ZP,ZP_CHAY_T=0X8000,ZP_CHAY_P=1,ZP_CODINH=0; 
....................  
.................... UNSIGNED INT16 TGDLAY=0; 
.................... UNSIGNED INT8 DEM_LED=0;  
.................... SIGNED I32=32,J32=0,TTCT_TD=1,I16=16,J16=0,ttct; 
....................  
.................... UNSIGNED INT32    ZA=1,YA=1,XA=0XFFFFFFFE,ZB=0X80000000,YB=0X80000000,XB=0X7FFFFFFF;    
.................... SIGNED IA=1,JA=1;   
.................... VOID RESET_TOAN_BO_BIEN() 
.................... {  
....................       TTCT_TD++;     //CHUYEN CHUONG TRINH CHO TU DONG 
....................       Y=0;      YP_CHAY=1;      YT_CHAY=0X80000000;      Y_CODINH=0; 
....................       ZT_CHAY_T=0x8000;    ZT_CHAY_P=1;   ZT_CODINH=0; 
....................       ZP_CHAY_T=0X8000;    ZP_CHAY_P=1;   ZP_CODINH=0; 
....................       ZT=ZP=0; 
....................       I32=32;J32=0;I16=16,J16=0; 
....................       DEM_LED=0; 
....................        
....................       ZA=1;    YA=1;    XA=0XFFFFFFFE;     IA=1;    JA=1; 
....................      ZB=0X80000000;    YB=0X80000000;    XB=0X7FFFFFFF; 
.................... }  
....................  
.................... VOID TANG_DEM_LED_DELAY_1(UNSIGNED INT8 DL) 
.................... {  
....................       UNSIGNED INT8 I; 
....................       FOR (I=0; I<DL;I++) 
....................       HIEN_THI_8LED_7DOAN_QUET_ALL(); 
....................       DEM_LED++; 
.................... }  
....................  
.................... VOID TANG_DEM_LED_DELAY_0(UNSIGNED INT8 DL) 
.................... {  
....................       IF (DL>0)      DELAY_MS(DL);  
....................       DEM_LED++; 
.................... }  
....................  
.................... VOID DELAY_CHON(UNSIGNED INT8 DL,CHONDELAY) 
.................... {     
....................    IF (!CHONDELAY)   TANG_DEM_LED_DELAY_0(DL); 
....................    ELSE              TANG_DEM_LED_DELAY_1(DL); 
.................... } 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DON  PHAI SANG TRAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID DIEM_SANG_DICH_TRAI_MAT_DAN_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {        
....................    IF(IA<33) 
....................    { 
....................       IF(JA>0) 
....................       { 
....................          ZB = (ZB << 1); 
....................          Y = XB|ZB;         
....................          XUAT_32LED_DON_1DW(Y); 
....................          DELAY_CHON(DL,CHONDELAY); 
....................          JA--; 
....................       } 
....................       ELSE  
....................       { 
....................          IA++; 
....................          JA=IA;       
....................          YB = YB>>1; 
....................          XB = XB>>1; 
....................          ZB = YB; 
....................       } 
....................    } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
.................... }   
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DON  TRAI SANG PHAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID DIEM_SANG_DICH_PHAI_MAT_DAN_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {        
....................    IF(IA<33) 
....................    { 
....................       IF(JA>0) 
....................       { 
....................          ZA = (ZA >> 1); 
....................          Y = XA|ZA;         
....................          XUAT_32LED_DON_1DW(Y); 
....................          DELAY_CHON(DL,CHONDELAY); 
....................          JA--; 
....................       } 
....................       ELSE  
....................       { 
....................          IA++; 
....................          JA=IA;       
....................          YA = YA<<1; 
....................          XA = XA <<1; 
....................          ZA = YA; 
....................       } 
....................    } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
.................... }   
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: CHOP TAT  
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID DAO_DL_32BIT_VA_XUAT() 
.................... { 
....................    Y=~Y; 
....................    XUAT_32LED_DON_1DW(Y);  
.................... } 
.................... VOID SANG_TAT_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {         
....................       IF (TGDLAY==1)          XUAT_32LED_DON_1DW(Y);  
....................       ELSE IF (TGDLAY==50)    DAO_DL_32BIT_VA_XUAT(); 
....................       ELSE IF (TGDLAY==100)   DAO_DL_32BIT_VA_XUAT();           
....................       ELSE IF (TGDLAY==150)   DAO_DL_32BIT_VA_XUAT();                  
....................       ELSE IF (TGDLAY==200)   
....................       { 
....................          TTCT_TD++;   Y=0;        TGDLAY=0; 
....................       } 
....................       TGDLAY++; 
....................       DELAY_CHON(DL,CHONDELAY); 
.................... } 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DAN ROI TAT DAN TU NGOAI VAO 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_TAT_DAN_NGOAI_VAO_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {   
....................    IF (DEM_LED<16) 
....................    {   
....................       XUAT_32LED_DON_2WORD(ZP,ZT);         
....................       ZP= (ZP<<1)+1;  
....................       ZT= (ZT>>1)+0X8000; 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE  IF (DEM_LED<32) 
....................    {   
....................       XUAT_32LED_DON_2WORD(ZP,ZT); 
....................       ZP= (ZP<<1);  
....................       ZT= (ZT>>1); 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................  
.................... }    
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DAN ROI TAT DAN TU TRONG RA 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_TAT_DAN_TRONG_RA_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {   
....................    IF (DEM_LED<16) 
....................    {    
....................       XUAT_32LED_DON_2WORD(ZP,ZT);  
....................       ZP= (ZP>>1)+0X8000;  
....................       ZT= (ZT<<1)+1; 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE  IF (DEM_LED<32) 
....................    {   
....................       XUAT_32LED_DON_2WORD(ZP,ZT); 
....................       ZP= (ZP>>1);  
....................       ZT= (ZT<<1); 
....................       DELAY_CHON(DL,CHONDELAY); 
....................     } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................          
.................... }    
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: 2NHOM 16 LED SANG DAN ROI TAT DAN TU PHAI SANG TRAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_TAT_DAN_PHAI_SANG_TRAI_2X16LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {   
....................    IF (DEM_LED<16) 
....................    {    
....................       XUAT_32LED_DON_2WORD(ZP,ZP); 
....................       ZP= (ZP>>1)+0X8000; 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE  IF (DEM_LED<32) 
....................    {   
....................       XUAT_32LED_DON_2WORD(ZP,ZP); 
....................       ZP= (ZP>>1); 
....................       DELAY_CHON(DL,CHONDELAY); 
....................     } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................        
.................... }    
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: 2NHOM 16 LED SANG DAN ROI TAT DAN TU TRAI SANG PHAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_TAT_DAN_TRAI_SANG_PHAI_2X16LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {   
....................    IF (DEM_LED<16) 
....................    {    
....................       XUAT_32LED_DON_2WORD(ZT,ZT);   
....................       ZT= (ZT<<1)+1; 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE  IF (DEM_LED<32) 
....................    {   
....................       XUAT_32LED_DON_2WORD(ZT,ZT); 
....................       ZT= (ZT<<1); 
....................       DELAY_CHON(DL,CHONDELAY); 
....................     } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................          
.................... }    
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DAN ROI TAT DAN TU PHAI SANG TRAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_TAT_DAN_PST_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {         
....................    IF (DEM_LED<32) 
....................    {   
....................       XUAT_32LED_DON_1DW(Y); 
....................       Y= (Y<<1)+1; 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE  IF (DEM_LED<64) 
....................    {   
....................       XUAT_32LED_DON_1DW(Y);    
....................       Y= (Y<<1);  
....................       DELAY_CHON(DL,CHONDELAY); 
....................    }  
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................  
.................... }     
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DAN ROI TAT DAN TU TRAI SANG PHAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_TAT_DAN_TSP_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {            
....................       IF (DEM_LED<32) 
....................       {   
....................          XUAT_32LED_DON_1DW(Y); 
....................          Y= (Y>>1)+0x80000000;  
....................          DELAY_CHON(DL,CHONDELAY);       
....................       } 
....................       ELSE 
....................       IF (DEM_LED<64) 
....................       {   
....................          XUAT_32LED_DON_1DW(Y);  
....................          Y= (Y>>1); 
....................          DELAY_CHON(DL,CHONDELAY); 
....................       }  
....................       ELSE RESET_TOAN_BO_BIEN(); 
....................      
.................... }          
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: DIEM SANG DI CHUEYN TU PHAI SANG TRAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID DIEM_SANG_DI_CHUYEN_PST_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {         
....................    IF (DEM_LED==0) 
....................    {   
....................       Y=1; 
....................       XUAT_32LED_DON_1DW(Y); 
....................       Y= (Y<<1); 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE  IF (DEM_LED<33) 
....................    {   
....................       XUAT_32LED_DON_1DW(Y);    
....................       Y= (Y<<1);  
....................       DELAY_CHON(DL,CHONDELAY); 
....................    }  
....................    ELSE  RESET_TOAN_BO_BIEN(); 
.................... }     
....................  
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: DIEM SANG DI CHUEYN TU TRAI SANG PHAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID DIEM_SANG_DI_CHUYEN_TSP_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {         
....................    IF (DEM_LED==0) 
....................    {   
....................       Y=0X80000000; 
....................       XUAT_32LED_DON_1DW(Y); 
....................       Y= (Y>>1); 
....................       DELAY_CHON(DL,CHONDELAY); 
....................    } 
....................    ELSE  IF (DEM_LED<33) 
....................    {   
....................       XUAT_32LED_DON_1DW(Y);    
....................       Y= (Y>>1);  
....................       DELAY_CHON(DL,CHONDELAY); 
....................    }  
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................  
.................... }  
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DON  PHAI SANG TRAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_DON_PST_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {        
....................    IF(I32>0) 
....................    { 
....................       IF(J32<I32) 
....................       { 
....................          Y = Y_CODINH|YP_CHAY; 
....................          XUAT_32LED_DON_1DW(Y); 
....................          DELAY_CHON(DL,CHONDELAY);        
....................          YP_CHAY = YP_CHAY <<1; 
....................          J32++; 
....................       } 
....................       IF (J32==I32)  
....................       { 
....................          I32--; 
....................          J32=0;          
....................          Y_CODINH=Y; 
....................          YP_CHAY = 1; 
....................       } 
....................    } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
.................... }    
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DON  PHAI SANG TRAI 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_DON_TSP_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {        
....................    IF(I32>0) 
....................    { 
....................       IF(J32<I32) 
....................       { 
....................          Y = Y_CODINH|YT_CHAY; 
....................          XUAT_32LED_DON_1DW(Y); 
....................          DELAY_CHON(DL,CHONDELAY); 
....................          YT_CHAY = YT_CHAY >>1; 
....................          J32++; 
....................       } 
....................       IF (J32==I32)  
....................       { 
....................          I32--; 
....................          J32=0;          
....................          Y_CODINH=Y; 
....................          YT_CHAY = 0X80000000; 
....................       } 
....................    } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................  
.................... }   
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DON  TU NGOAI VAO 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_DON_TNT_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {        
....................    IF(I16>0) 
....................    { 
....................       IF(J16<I16) 
....................       { 
....................          ZP = ZP_CODINH|ZP_CHAY_P; 
....................          ZT = ZT_CODINH|ZT_CHAY_T; 
....................          XUAT_32LED_DON_2WORD(ZT,ZP); 
....................          DELAY_CHON(DL,CHONDELAY); 
....................  
....................          ZP_CHAY_P = ZP_CHAY_P <<1;          
....................          ZT_CHAY_T = ZT_CHAY_T >>1; 
....................          J16++; 
....................       } 
....................       IF (J16==I16)  
....................       { 
....................          I16--; 
....................          J16=0;          
....................          ZT_CODINH=ZT;  ZP_CODINH=ZP;          
....................          ZP_CHAY_P = 1;   ZT_CHAY_T = 0X8000; 
....................       } 
....................    } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
....................  
.................... }    
....................  
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //32 LED: SANG DON  TU NGOAI VAO 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID SANG_DON_TTR_32LED(UNSIGNED INT8 DL,CHONDELAY) 
.................... {        
....................    IF(I16>0) 
....................    { 
....................       IF(J16<I16) 
....................       { 
....................          ZP = ZP_CODINH|ZP_CHAY_T; 
....................          ZT = ZT_CODINH|ZT_CHAY_P; 
....................          XUAT_32LED_DON_2WORD(ZT,ZP); 
....................          DELAY_CHON(DL,CHONDELAY); 
....................          ZP_CHAY_T = ZP_CHAY_T >>1;          
....................          ZT_CHAY_P = ZT_CHAY_P <<1; 
....................          J16++; 
....................       } 
....................       IF (J16==I16)  
....................       { 
....................          I16--; 
....................          J16=0;          
....................          ZT_CODINH=ZT;   
....................          ZP_CODINH=ZP; 
....................          ZP_CHAY_T = 0X8000;   ZT_CHAY_P = 1; 
....................       } 
....................    } 
....................    ELSE RESET_TOAN_BO_BIEN(); 
.................... }    
....................  
.................... #include <TV_PICKIT2_SHIFT_DS18B20.c> 
.................... #DEFINE     TOUCH_PIN PIN_A5 
.................... #INCLUDE    <TOUCH.c> 
.................... /////////////////////////////////////////////////////////////////////////// 
.................... ////                        Dallas Touch Driver                        //// 
.................... ////                                                                   //// 
.................... ////                                                                   //// 
.................... ////  data = touch_read_bit()     Reads one bit from a touch device    //// 
.................... ////                                                                   //// 
.................... ////  data = touch_read_BYTE()    Reads one byte from a touch device.  //// 
.................... ////                                                                   //// 
.................... ////  ok = touch_write_bit(data)  Writes one bit to a touch device     //// 
.................... ////                              and returns true if all went ok.     //// 
.................... ////                              A false indicates a collision with   //// 
.................... ////                              another device.                      //// 
.................... ////                                                                   //// 
.................... ////  ok = touch_write_byte(data) Writes one byte to a touch device    //// 
.................... ////                              and returns true if all went ok.     //// 
.................... ////                              A false indicates a collision with   //// 
.................... ////                              another device.                      //// 
.................... ////                                                                   //// 
.................... ////  present = touch_present()   Issues a reset and returns true      //// 
.................... ////                              if the touch device is there.        //// 
.................... ////                                                                   //// 
.................... ////  reset_pulse()               Issues a reset and waits for a       //// 
.................... ////                              present pulse.                       //// 
.................... ////                                                                   //// 
.................... /////////////////////////////////////////////////////////////////////////// 
.................... ////        (C) Copyright 1996,2010 Custom Computer Services           //// 
.................... //// This source code may only be used by licensed users of the CCS C  //// 
.................... //// compiler.  This source code may only be distributed to other      //// 
.................... //// licensed users of the CCS C compiler.  No other use, reproduction //// 
.................... //// or distribution is permitted without written permission.          //// 
.................... //// Derivative programs created using this software in object code    //// 
.................... //// form are not restricted in any way.                               //// 
.................... /////////////////////////////////////////////////////////////////////////// 
....................  
.................... #ifndef  TOUCH_C 
.................... #define  TOUCH_C 
....................  
.................... #ifndef TOUCH_PIN 
....................    #define TOUCH_PIN  PIN_B0 
.................... #endif 
....................  
.................... #define TOUCH_PIN_LOW()    output_drive(TOUCH_PIN); output_low(TOUCH_PIN) 
.................... #define TOUCH_PIN_HIGH()    output_drive(TOUCH_PIN); output_high(TOUCH_PIN) 
.................... #define TOUCH_PIN_FLOAT()  output_float(TOUCH_PIN) 
.................... #define TOUCH_PIN_READ()      input_state(TOUCH_PIN) 
....................  
.................... ///////////////////////////// 
.................... ////                     //// 
.................... //// Function Prototypes //// 
.................... ////                     //// 
.................... ///////////////////////////// 
....................  
.................... /* 
.................... int1 touch_read_bit() 
.................... This will read back a bit from the DS1993 
.................... PARAMS: none 
.................... RETURNS: A bit from the DS1993 
.................... */ 
.................... int1 touch_read_bit(); 
....................  
.................... /* 
.................... BYTE touch_read_byte() 
.................... This will read back a byte from the DS1993 
.................... PARAMS: none 
.................... RETURNS: A byte from the DS1993 
.................... */ 
.................... BYTE touch_read_byte(); 
....................  
.................... /* 
.................... BOOLEAN touch_write_bit(int1 data) 
.................... This will write a bit to the DS1993 
.................... PARAMS: The bit to write 
.................... RETURNS: True if completed successfully, false if otherwise 
.................... */ 
.................... BOOLEAN touch_write_bit(int1 data); 
....................  
.................... /* 
.................... BOOLEAN touch_write_byte(BYTE data) 
.................... This will write a byte to the DS1993 
.................... PARAMS: The byte to write 
.................... RETURNS: True if completed successfully, false if otherwise 
.................... */ 
.................... BOOLEAN touch_write_byte(BYTE data); 
....................  
.................... /* 
.................... BOOLEAN touch_present() 
.................... This will evaluate whether or not there is a touch present on the DS1993 
.................... PARAMS: none 
.................... RETURNS: True if a touch is present, false if otherwise 
.................... */ 
.................... BOOLEAN touch_present(); 
....................  
.................... /* 
.................... void reset_pulse() 
.................... This will send the DS1993 a reset pulse 
.................... PARAMS: none 
.................... RETURNS: none 
.................... */ 
.................... void reset_pulse(); 
....................  
.................... ////////////////////////////////// 
.................... ////                          //// 
.................... //// Function Implementations //// 
.................... ////                          //// 
.................... ////////////////////////////////// 
....................  
.................... /* 
.................... int1 touch_read_bit() 
.................... This will read back a bit from the DS1993 
.................... PARAMS: none 
.................... RETURNS: A bit from the DS1993 
.................... */ 
.................... int1 touch_read_bit() 
.................... { 
....................    int1 data; 
....................  
....................    TOUCH_PIN_LOW(); 
....................    delay_us(14); 
....................    TOUCH_PIN_FLOAT(); 
....................    delay_us(5); 
....................    data = TOUCH_PIN_READ(); 
....................    delay_us(100); 
....................  
....................    return data; 
.................... } 
....................  
.................... /* 
.................... BYTE touch_read_byte() 
.................... This will read back a byte from the DS1993 
.................... PARAMS: none 
.................... RETURNS: A byte from the DS1993 
.................... */ 
.................... BYTE touch_read_byte() 
.................... { 
....................    BYTE i,data; 
....................  
....................    for(i=1; i <= 8; ++i) 
....................       shift_right(&data, 1, touch_read_bit()); 
....................  
....................    return data; 
.................... } 
....................  
.................... /* 
.................... BOOLEAN touch_write_bit(int1 data) 
.................... This will write a bit to the DS1993 
.................... PARAMS: The bit to write 
.................... RETURNS: True if completed successfully, false if otherwise 
.................... */ 
.................... BOOLEAN touch_write_bit(int1 data) 
.................... { 
....................    TOUCH_PIN_LOW(); 
*
0838:  BCF    F92.5
083A:  BCF    F92.5
083C:  BCF    F89.5
....................    delay_us(10); 
083E:  MOVLW  10
0840:  MOVWF  00
0842:  DECFSZ 00,F
0844:  BRA    0842
0846:  NOP   
....................    if(data) 
0848:  MOVLB  5
084A:  MOVF   x9C,F
084C:  BZ    086A
....................    { 
....................       TOUCH_PIN_HIGH(); 
084E:  BCF    F92.5
0850:  BCF    F92.5
0852:  BSF    F89.5
....................       delay_us(10); 
0854:  MOVLW  10
0856:  MOVWF  00
0858:  DECFSZ 00,F
085A:  BRA    0858
085C:  NOP   
....................       if(!TOUCH_PIN_READ()) 
085E:  BTFSC  F80.5
0860:  BRA    0868
....................          return FALSE; 
0862:  MOVLW  00
0864:  MOVWF  01
0866:  BRA    08A6
....................    } 
0868:  BRA    0884
....................    else 
....................    { 
....................       TOUCH_PIN_LOW(); 
086A:  BCF    F92.5
086C:  BCF    F92.5
086E:  BCF    F89.5
....................       delay_us(10); 
0870:  MOVLW  10
0872:  MOVWF  00
0874:  DECFSZ 00,F
0876:  BRA    0874
0878:  NOP   
....................       if(TOUCH_PIN_READ()) 
087A:  BTFSS  F80.5
087C:  BRA    0884
....................          return FALSE; 
087E:  MOVLW  00
0880:  MOVWF  01
0882:  BRA    08A6
....................    } 
....................    delay_us(50); 
0884:  MOVLW  52
0886:  MOVWF  00
0888:  DECFSZ 00,F
088A:  BRA    0888
088C:  BRA    088E
088E:  NOP   
....................    TOUCH_PIN_HIGH(); 
0890:  BCF    F92.5
0892:  BCF    F92.5
0894:  BSF    F89.5
....................    delay_us(50); 
0896:  MOVLW  52
0898:  MOVWF  00
089A:  DECFSZ 00,F
089C:  BRA    089A
089E:  BRA    08A0
08A0:  NOP   
....................    return TRUE; 
08A2:  MOVLW  01
08A4:  MOVWF  01
08A6:  MOVLB  0
08A8:  GOTO   08CA (RETURN)
.................... } 
....................  
.................... /* 
.................... BOOLEAN touch_write_byte(BYTE data) 
.................... This will write a byte to the DS1993 
.................... PARAMS: The byte to write 
.................... RETURNS: True if completed successfully, false if otherwise 
.................... */ 
.................... BOOLEAN touch_write_byte(BYTE data) 
.................... { 
....................    BYTE i; 
....................  
....................    for(i=1; i<=8; ++i) 
08AC:  MOVLW  01
08AE:  MOVLB  5
08B0:  MOVWF  x9A
08B2:  MOVF   x9A,W
08B4:  SUBLW  08
08B6:  BNC   08DA
....................       if(!touch_write_bit(shift_right(&data, 1, 0))) 
08B8:  BCF    FD8.0
08BA:  RRCF   x99,F
08BC:  MOVLW  00
08BE:  BTFSC  FD8.0
08C0:  MOVLW  01
08C2:  MOVWF  x9B
08C4:  MOVWF  x9C
08C6:  MOVLB  0
08C8:  BRA    0838
08CA:  MOVF   01,F
08CC:  BNZ   08D4
....................          return FALSE; 
08CE:  MOVLW  00
08D0:  MOVWF  01
08D2:  BRA    08E0
08D4:  MOVLB  5
08D6:  INCF   x9A,F
08D8:  BRA    08B2
....................  
....................    return TRUE; 
08DA:  MOVLW  01
08DC:  MOVWF  01
08DE:  MOVLB  0
08E0:  RETURN 0
.................... } 
....................  
.................... /* 
.................... BOOLEAN touch_present() 
.................... This will evaluate whether or not there is a touch present on the DS1993 
.................... PARAMS: none 
.................... RETURNS: True if a touch is present, false if otherwise 
.................... */ 
.................... BOOLEAN touch_present() 
.................... { 
....................    BOOLEAN present; 
....................    TOUCH_PIN_LOW(); 
*
07DE:  BCF    F92.5
07E0:  BCF    F92.5
07E2:  BCF    F89.5
....................    delay_us(500); 
07E4:  MOVLW  02
07E6:  MOVLB  5
07E8:  MOVWF  x9A
07EA:  MOVLW  F9
07EC:  MOVWF  x9B
07EE:  MOVLB  0
07F0:  RCALL  07BE
07F2:  MOVLB  5
07F4:  DECFSZ x9A,F
07F6:  BRA    07EA
....................    TOUCH_PIN_FLOAT(); 
07F8:  BSF    F92.5
....................    delay_us(5); 
07FA:  MOVLW  07
07FC:  MOVWF  00
07FE:  DECFSZ 00,F
0800:  BRA    07FE
0802:  BRA    0804
0804:  NOP   
....................  
....................    if(!TOUCH_PIN_READ()) 
0806:  BTFSC  F80.5
0808:  BRA    0810
....................       return FALSE; 
080A:  MOVLW  00
080C:  MOVWF  01
080E:  BRA    0834
....................  
....................    delay_us(65); 
0810:  MOVLW  6B
0812:  MOVWF  00
0814:  DECFSZ 00,F
0816:  BRA    0814
0818:  BRA    081A
081A:  NOP   
....................    present = !TOUCH_PIN_READ(); 
081C:  BCF    x99.0
081E:  BTFSS  F80.5
0820:  BSF    x99.0
....................    delay_us(240); 
0822:  MOVLW  F0
0824:  MOVWF  x9B
0826:  MOVLB  0
0828:  RCALL  07BE
....................    return present; 
082A:  MOVLW  00
082C:  MOVLB  5
082E:  BTFSC  x99.0
0830:  MOVLW  01
0832:  MOVWF  01
0834:  MOVLB  0
0836:  RETURN 0
.................... } 
....................  
.................... /* 
.................... void reset_pulse() 
.................... This will send the DS1993 a reset pulse 
.................... PARAMS: none 
.................... RETURNS: none 
.................... */ 
.................... void reset_pulse() 
.................... { 
....................    TOUCH_PIN_LOW(); 
....................    delay_us(500); 
....................    TOUCH_PIN_FLOAT(); 
....................    delay_us(5); 
....................    while(!touch_present()); 
.................... } 
....................  
....................  
.................... #endif 
....................  
.................... #DEFINE       SKIP_ROM              0xCC 
.................... #DEFINE       CONVERT_T             0x44 
.................... #DEFINE       READ_SCRATCHPAD       0xBE 
.................... #DEFINE       WRITE_SCRATCHPAD      0x4E 
.................... #DEFINE       COPY_SCRATCHPAD       0x48     
.................... UNSIGNED INT8     DS18AL, DS18AH, DS18A_TAM=0; 
.................... UNSIGNED INT16    DS18A; 
.................... VOID  KHOI_TAO_DS18B20() 
.................... {                          
....................       TOUCH_PRESENT(); 
*
08E2:  RCALL  07DE
....................       TOUCH_WRITE_BYTE(SKIP_ROM);       
08E4:  MOVLW  CC
08E6:  MOVLB  5
08E8:  MOVWF  x99
08EA:  MOVLB  0
08EC:  RCALL  08AC
....................       TOUCH_WRITE_BYTE(WRITE_SCRATCHPAD);     
08EE:  MOVLW  4E
08F0:  MOVLB  5
08F2:  MOVWF  x99
08F4:  MOVLB  0
08F6:  RCALL  08AC
....................       TOUCH_WRITE_BYTE(0x0);       // ghi 2 byte rong 
08F8:  MOVLB  5
08FA:  CLRF   x99
08FC:  MOVLB  0
08FE:  RCALL  08AC
....................       TOUCH_WRITE_BYTE(0x0);       // 
0900:  MOVLB  5
0902:  CLRF   x99
0904:  MOVLB  0
0906:  RCALL  08AC
....................       TOUCH_WRITE_BYTE(0x1F);      //Cau hinh do phan giai 9 bit 
0908:  MOVLW  1F
090A:  MOVLB  5
090C:  MOVWF  x99
090E:  MOVLB  0
0910:  RCALL  08AC
....................  
....................       TOUCH_PRESENT(); 
0912:  RCALL  07DE
....................       TOUCH_WRITE_BYTE(SKIP_ROM);       
0914:  MOVLW  CC
0916:  MOVLB  5
0918:  MOVWF  x99
091A:  MOVLB  0
091C:  RCALL  08AC
....................       TOUCH_WRITE_BYTE(COPY_SCRATCHPAD);  
091E:  MOVLW  48
0920:  MOVLB  5
0922:  MOVWF  x99
0924:  MOVLB  0
0926:  RCALL  08AC
0928:  GOTO   12EC (RETURN)
.................... } 
.................... VOID  DOC_GIATRI_DS18B20() 
.................... {  
....................       TOUCH_WRITE_BYTE(SKIP_ROM); 
....................       TOUCH_WRITE_BYTE (CONVERT_T);    
....................       TOUCH_PRESENT(); 
....................       TOUCH_WRITE_BYTE(SKIP_ROM); 
....................       TOUCH_WRITE_BYTE(READ_SCRATCHPAD);   
....................       DS18AL = TOUCH_READ_BYTE(); 
....................       DS18AH = TOUCH_READ_BYTE();       
....................       DS18A   =  MAKE16(DS18AH,DS18AL);         
.................... } 
....................              
....................  
....................  
.................... #include <TV_PICKIT2_SHIFT_STEP_MOTOR.c> 
.................... UNSIGNED  INT8 STEPMOTOR_FULLSTEP[]=  {0X1D,0X17,0X1B,0X0F}; 
.................... UNSIGNED  INT8 STEPMOTOR_HALFSTEP[]=  {0X1D,0X15,0X17,0X13,0X03,0X0B,0X09,0X0D}; 
.................... UNSIGNED  INT8 STEPMOTOR_I=0, STEPMOTOR_DELAY; 
.................... unsigned int16 so_buoc=0; 
.................... INT1 STEPMOTOR_TN=0,STEPMOTOR_ONOFF=0; 
.................... VOID STEP_MOTOR_QUAY_THUAN_FS() 
.................... { 
....................       RBDC=RBDC & 0xFFE0;            
....................       RBDC=RBDC | STEPMOTOR_FULLSTEP[STEPMOTOR_I]; 
....................       XUAT_BUZZER_RELAY();  
....................       STEPMOTOR_I++; 
....................       so_buoc++;     
....................       STEPMOTOR_I = STEPMOTOR_I & 0X03; 
.................... } 
.................... VOID STEP_MOTOR_QUAY_NGHICH_FS() 
.................... { 
....................       RBDC=RBDC & 0xFFE0;            
....................       RBDC=RBDC | STEPMOTOR_FULLSTEP[STEPMOTOR_I]; 
....................       XUAT_BUZZER_RELAY();  
....................       STEPMOTOR_I--; 
....................       so_buoc++; 
....................       STEPMOTOR_I = STEPMOTOR_I & 0X03; 
.................... } 
.................... VOID MOTOR_STEP_RUN_FS() 
.................... { 
....................    IF (STEPMOTOR_TN) STEP_MOTOR_QUAY_THUAN_FS(); 
....................    ELSE           STEP_MOTOR_QUAY_NGHICH_FS(); 
.................... } 
....................  
.................... VOID STEP_MOTOR_QUAY_THUAN_HS() 
.................... { 
....................       RBDC=RBDC & 0xE0;            
....................       RBDC=RBDC | STEPMOTOR_HALFSTEP[STEPMOTOR_I]; 
....................       XUAT_BUZZER_RELAY();  
....................       STEPMOTOR_I++; 
....................       STEPMOTOR_I = STEPMOTOR_I & 0X07; 
.................... } 
.................... VOID STEP_MOTOR_QUAY_NGHICH_HS() 
.................... { 
....................       RBDC=RBDC & 0xE0;            
....................       RBDC=RBDC | STEPMOTOR_HALFSTEP[STEPMOTOR_I]; 
....................       XUAT_BUZZER_RELAY();  
....................       STEPMOTOR_I--; 
....................       STEPMOTOR_I = STEPMOTOR_I & 0X07; 
.................... } 
.................... VOID MOTOR_STEP_RUN_HS() 
.................... { 
....................    IF (STEPMOTOR_TN) STEP_MOTOR_QUAY_THUAN_HS(); 
....................    ELSE           STEP_MOTOR_QUAY_NGHICH_HS(); 
.................... } 
....................  
....................  
.................... #include <TV_PICKIT2_SHIFT_DC_MOTOR.c> 
.................... INT1 DCMOTOR_TN = 0, DCMOTOR_ONOFF=0; 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //CAC HAM CHO DK DONG CO DC ON OFF 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... VOID DC_MOTOR_ENABLE() 
.................... { 
....................       DC_ENABLE=1; 
*
0A5A:  BSF    26.5
....................       XUAT_BUZZER_RELAY(); 
0A5C:  BRA    0A32
0A5E:  GOTO   133C (RETURN)
.................... } 
.................... VOID DC_MOTOR_QUAY_THUAN() 
.................... { 
....................       OUTPUT_HIGH(PIN_C1); 
....................       OUTPUT_LOW(PIN_C2); 
.................... } 
.................... VOID DC_MOTOR_QUAY_NGHICH() 
.................... { 
....................       OUTPUT_LOW(PIN_C1); 
....................       OUTPUT_HIGH(PIN_C2); 
.................... } 
.................... VOID DC_MOTOR_STOP() 
.................... { 
....................       OUTPUT_LOW(PIN_C1); 
....................       OUTPUT_LOW(PIN_C2); 
.................... } 
.................... VOID DC_MOTOR_CONTROL() 
.................... { 
....................       IF (DCMOTOR_ONOFF==1) 
....................       { 
....................          IF (DCMOTOR_TN)   DC_MOTOR_QUAY_THUAN(); 
....................          ELSE              DC_MOTOR_QUAY_NGHICH(); 
....................       } 
....................       ELSE                 DC_MOTOR_STOP(); 
....................        
.................... }          
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... //CAC HAM CHO DK DONG CO DC BANG PWM 
.................... //XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
.................... UNSIGNED INT16    PWM_DUTY; 
.................... VOID DC_MOTOR_KTAO_CCP1_THUAN() 
.................... {      
....................       SETUP_CCP2(CCP_OFF);       
....................       SETUP_CCP1(CCP_PWM); 
....................       OUTPUT_LOW(PIN_C1);       
.................... } 
.................... VOID DC_MOTOR_KTAO_CCP2_NGHICH() 
.................... {             
....................       SETUP_CCP1(CCP_OFF);       
....................       SETUP_CCP2(CCP_PWM); 
....................       OUTPUT_LOW(PIN_C2); 
.................... } 
.................... VOID DC_MOTOR_KTAO_CCPX_KTAO() 
.................... {          
....................      IF (DCMOTOR_TN)   DC_MOTOR_KTAO_CCP1_THUAN(); 
....................      ELSE               DC_MOTOR_KTAO_CCP2_NGHICH();             
.................... } 
.................... VOID DC_MOTOR_PWW_SETUP_DUTY() 
.................... {      
....................      IF (DCMOTOR_TN)   SET_PWM1_DUTY(PWM_DUTY); 
....................      ELSE               SET_PWM2_DUTY(PWM_DUTY);      
.................... }  
.................... VOID DC_MOTOR_PWM_CCP1_CCP2_STOP() 
.................... {          
....................       PWM_DUTY=0;             
....................       SETUP_CCP1(CCP_OFF); 
....................       SETUP_CCP2(CCP_OFF); 
....................       DC_MOTOR_KTAO_CCPX_KTAO(); 
....................       DC_MOTOR_PWW_SETUP_DUTY(); 
.................... } 
....................  
....................  
.................... #include <lbr_03_key.c> 
.................... #Define  bt0     pin_b5 
.................... #define  bt1     pin_b4 
.................... #define  bt2     pin_b3 
.................... #define  bt3     pin_b2 
....................  
.................... #define  on      bt0       //dk led don, motor 
.................... #define  off     bt1 
.................... #define  inv     bt2 
....................  
.................... #define  up      bt0    //dk led don 
.................... #define  dw      bt1 
.................... #define  clr     bt2 
.................... #define  mod     bt3 
....................  
.................... #define  stop    bt3 
....................  
.................... #define  on1     bt0      
.................... #define  off1    bt1 
.................... #define  on2     bt2        
.................... #define  off2    bt3    
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //thu vien cho cac phim don va ban phim cam ung 
.................... //co 2 cach phat hien va chong doi phim nhan 
.................... //tra ve  
.................... //tac gia: NDP su pham kt thuat tp hcm 
....................   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //cac ham con cua cac phim nhan don theo cach 1 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx     
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //phim bt0-cach 1: co chong doi, delay 20ms, cho nha phim 
.................... //dinh nghia them 1 so ten khac      
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                        
.................... #define phim_on_c1  phim_bt0_c1     
.................... #define phim_run_c1 phim_bt0_c1  
.................... #define phim_up_c1  phim_bt0_c1        
....................  
.................... int1 phim_bt0_c1(int1 ktnp,usi16 dl)    
.................... {                     
....................    if (!input(bt0))    
....................    {         
....................       delay_ms(20);                                      
....................       if (!input(bt0)) 
....................       { 
....................          if(ktnp) while(!input(bt0)); 
....................          if(dl!=0)  delay_ms(dl); 
....................          return co_nhan;       
....................       }                       
....................       return khong_nhan;    
....................    }          
....................   return khong_nhan;   
.................... }      
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //phim bt1-cach 1: co chong doi, delay 20ms, cho nha phim 
.................... //dinh nghia them 1 so ten khac       
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... #define phim_off_c1   phim_bt1_c1    
.................... #define phim_stop_c1  phim_bt1_c1 
.................... #define phim_dw_c1    phim_bt1_c1                   
.................... int1 phim_bt1_c1(int1 ktnp,usi16 dl)                                                
.................... { 
....................    if (!input(bt1))    
....................    {                        
....................       delay_ms(20); 
....................       if (!input(bt1)) 
....................       { 
....................          if(ktnp) while(!input(bt1));     
....................          if(dl!=0) delay_ms(dl); 
....................          return co_nhan; 
....................       }  
....................       return khong_nhan; 
....................    } 
....................    return khong_nhan;   
.................... }        
....................       
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //phim bt2-cach 1: co chong doi, delay 20ms, cho nha phim 
.................... //dinh nghia them 1 so ten khac       
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... #define phim_inv_c1 phim_bt2_c1       
.................... int1 phim_bt2_c1(int1 ktnp,usi16 dl)       
.................... { 
....................    if (!input(bt2))    
....................    {         
....................       delay_ms(20);                 
....................       if (!input(bt2)) 
....................       { 
....................          if(ktnp) while(!input(bt2));     
....................          if(dl!=0) delay_ms(dl); 
....................          return co_nhan; 
....................       }                                      
....................       return khong_nhan;  
....................    } 
....................    return khong_nhan;   
.................... }       
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //phim bt3-cach 1: co chong doi, delay 20ms, cho nha phim 
.................... //dinh nghia them 1 so ten khac       
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx      
.................... #define phim_mode_c1  phim_bt3_c1  
.................... #define phim_ud_c1    phim_bt3_c1   
.................... int1 phim_bt3_c1(int1 ktnp,usi16 dl)       
.................... {                        
....................    if (!input(bt3))    
....................    {                        
....................       delay_ms(20);                        
....................       if (!input(bt3)) 
....................       {                       
....................          if(ktnp) while(!input(bt3));     
....................          if(dl!=0) delay_ms(dl); 
....................          return co_nhan; 
....................       }  
....................       return khong_nhan;    
....................       }                        
....................    return khong_nhan;   
.................... }   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx       
.................... //ham kiem tra 2 phim on/off 
.................... //neu co nhan on lam bit tt = enable va tt phim = co nhan 
.................... //neu co nhan of lam bit tt = disable va tt phim = co nhan 
.................... //neu khong nhan thi bit tt khong doi va tt phim = khong nhan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx      
.................... int1 phim_on_off_inv_3btn()    
.................... {                                                       
....................    if(phim_on_c1(c_ktnp,0)==co_nhan)    
....................    {                 
....................       tt_on_off = tt_on; 
....................       return co_nhan;             
....................    }                          
....................    else                        
....................    if(phim_off_c1(c_ktnp,0)==co_nhan) 
....................    { 
....................       tt_on_off = tt_off;      
....................       return co_nhan;     
....................    }  
....................    else                        
....................    if(phim_inv_c1(c_ktnp,0)==co_nhan)      
....................    {                                                     
....................       tt_inv = true;                          
....................       return co_nhan;        
....................    }                         
....................    else   return khong_nhan; 
.................... } 
....................    
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx        
.................... //ham kiem tra 2 phim on/off 
.................... //neu co nhan on lam bit tt = enable va tt phim = co nhan 
.................... //neu co nhan of lam bit tt = disable va tt phim = co nhan 
.................... //neu khong nhan thi bit tt khong doi va tt phim = khong nhan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx      
.................... int1 phim_on_off_2btn()    
.................... {                      
....................    if(phim_on_c1(c_ktnp,0)==co_nhan)      
....................    { 
....................       tt_on_off = tt_on; 
....................       return co_nhan;    
....................    }                          
....................    else                        
....................    if(phim_off_c1(c_ktnp,0)==co_nhan) 
....................    { 
....................       tt_on_off = tt_off;      
....................       return co_nhan;     
....................    } 
....................    else   return khong_nhan;                    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx                                                
.................... //ham kiem tra phim on  
.................... //neu co nhan thi dao bit tt_on_off va tra ve co nhan 
.................... //neu khong nhan tra ve tt khong nhan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx      
.................... int1 phim_on_off_1btn()    
.................... {                      
....................    if(phim_on_c1(c_ktnp,0)==co_nhan)    
....................    { 
....................       tt_on_off = ~tt_on_off; 
....................       return co_nhan;    
....................    }                          
....................    else   return khong_nhan;                    
.................... }    
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //cac ham con cua cac phim nhan don theo cach 2 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx     
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //phim bt0-cach 2: nhan so lan thuc hien la bien dl 
.................... //kiem tra neu co nhan thi tang bien dem dl_btn,delay 1ms.    
.................... //Neu bien dl_btn = dl thi reset dl_btn = 0, 
.................... //xem nhu co nhan va ket thuc.  
.................... //con lai thi xem nhu chua nhan hoac chua du thoi gian nhan 
.................... //moi chu ky thuc hien lon nhat la 1ms - khong cho nha phim  
.................... //dinh nghia them 1 so ten khac   
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx     
.................... #define phim_on_c2  phim_bt0_c2                     
.................... #define phim_run_c2 phim_bt0_c2       
.................... #define phim_up_c2  phim_bt0_c2                     
.................... int1 phim_bt0_c2(usi16 dl)   
.................... {                       
....................    if (!input(bt0))                        
....................    {    
....................       dl_btn++;   delay_ms(1);                
....................       if(dl_btn>=dl)  
....................       {   
....................          dl_btn =0; 
....................          return co_nhan; 
....................       }      
....................       else 
....................       { 
....................          return khong_nhan;  
....................       } 
....................    } 
....................     else  return khong_nhan;     
.................... }  
....................      
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //ham chong doi cach 1 cho phim bt1 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx       
.................... #define phim_off_c2   phim_bt1_c2    
.................... #define phim_stop_c2  phim_bt1_c2   
.................... #define phim_dw_c2    phim_bt1_c2   
.................... int1 phim_bt1_c2(usi16 dl) 
.................... {                       
....................    if (!input(bt1))    
....................    {            
....................       dl_btn++;  delay_ms(1);  
....................       if(dl_btn >= dl)     
....................       {   
....................          dl_btn =0; 
....................          return co_nhan; 
....................       }      
....................       else 
....................       { 
....................          return khong_nhan;  
....................       } 
....................     } 
....................     else  return khong_nhan;     
.................... }      
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //ham chong doi cach 1 cho phim bt31 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... #define phim_inv_c2    phim_bt2_c2   
....................  
.................... int1 phim_bt2_c2(usi16 dl)  
.................... {                       
....................    if (!input(bt2))    
....................    {                                   
....................       dl_btn++;  delay_ms(1);  
....................       if(dl_btn >= dl)  
....................       {   
....................          dl_btn =0; 
....................          return co_nhan;    
....................       }      
....................       else             
....................       { 
....................          return khong_nhan;  
....................       } 
....................     } 
....................     else  return khong_nhan;     
.................... }                                        
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //ham chong doi cach 1 cho phim bt31 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx         
.................... #define phim_mode_c2  phim_bt3_c2   
.................... #define phim_ud_c2    phim_bt3_c2   
....................   
....................                                
.................... int1 phim_bt3_c2(usi16 dl)  
.................... {                       
....................    if (!input(bt3))     
....................    {                          
....................       dl_btn++;    delay_ms(1);                                                
....................       if(dl_btn >= dl)  
....................       {                               
....................          dl_btn =0;                                  
....................          return co_nhan;  
....................       }      
....................       else 
....................       { 
....................          return khong_nhan;  
....................       } 
....................     } 
....................     else  return khong_nhan;     
.................... }                      
....................  
....................  
....................  
.................... const unsigned char maquetkey[4]= {0x3f,0x7f,0xbf,0xff}; 
.................... unsigned int8  mpt1=0,mpt2=0;   
.................... unsigned int key_nhan() 
.................... {     signed int8 maphim,hang,cot; 
....................       maphim=hang=0xff; 
....................       for(cot=0;cot<4;cot++) 
....................             {    
....................                output_b(maquetkey[cot]); 
....................                if         (!input(pin_b2))      {hang=3;   break;} 
....................                else    if (!input(pin_b3))      {hang=2;   break;} 
....................                else    if (!input(pin_b4))      {hang=1;   break;} 
....................                else    if (!input(pin_b5))      {hang=0;   break;} 
....................             }           
....................          if (hang!=0xff)   maphim   = cot*4 + hang; 
....................          return(maphim); 
.................... } 
.................... unsigned int key_4x4_dw() 
.................... {      
....................       mpt1=key_nhan();          
....................       if (mpt1!=0xff)    
....................       {  delay_ms(1);   
....................          mpt1=key_nhan(); 
....................          do{mpt2=key_nhan();} 
....................          while (mpt2==mpt1); 
....................       }              
....................       return(mpt1); 
.................... } 
....................  
.................... unsigned int key_4x4_up() 
.................... {             
....................       mpt1=key_nhan(); 
....................       if (mpt1!=0xff)    
....................       {   
....................          if (mpt1!=mpt2) 
....................             { 
....................                return(mpt1);  //phim moi 
....................                mpt2=mpt1; 
....................             } 
....................          else 
....................          { 
....................             delay_ms(1); 
....................             mpt1=key_nhan(); 
....................             do 
....................             { 
....................                mpt2=key_nhan(); 
....................                } 
....................             while (mpt2!=mpt1); 
....................                return(mpt1);     //thoat vi trung ma phim da nhan 
....................                mpt2=mpt1;            
....................          } 
....................       }   
....................       else  
....................       { 
....................          return(mpt1);  //thoat vi khong nhan 
....................          mpt2=mpt1; 
....................       }       
.................... } 
....................  
....................  
....................  
....................                                        
....................                                        
....................  
.................... #include <lbr_04_timer_ngat.c>                                                             
....................  
....................  
....................  
.................... #include <lbr_06_lcd.c>                                                             
.................... unsigned int8 lcd_control;   
.................... #bit lcd_p  = lcd_control.3 
.................... #bit lcd_rs = lcd_control.2 
.................... #bit lcd_rw = lcd_control.1 
.................... #bit lcd_e  = lcd_control.0      
....................  
.................... #define lcd_function_set       0x38 
.................... #define lcd_display_control    0x0c 
.................... #define lcd_clear_display      0x01 
.................... #define lcd_entry_mode         0x06 
.................... #define lcd_shift_left         0x18 
.................... #define lcd_shift_right        0x1c 
....................  
.................... #define lcd_addr_line1         0x80 
.................... #define lcd_addr_line2         0xc0 
.................... #define lcd_addr_line3         0x94 
.................... #define lcd_addr_line4         0xd4 
....................  
.................... void lcd_xuat_8bit(int8 lcd_data_x) 
.................... { 
....................    lcd_e=1; xuat_lcd20x4(lcd_control,lcd_data_x);      
*
0714:  BSF    x95.0
0716:  MOVFF  95,5A5
071A:  MOVFF  5A4,5A6
071E:  RCALL  0700
....................    lcd_e=0; xuat_lcd20x4(lcd_control,lcd_data_x);  
0720:  BCF    x95.0
0722:  MOVFF  95,5A5
0726:  MOVFF  5A4,5A6
072A:  RCALL  0700
072C:  RETURN 0
.................... } 
.................... void lcd_command(int8 lcd_data_x)    
.................... { 
....................    lcd_rs = 0; 
072E:  BCF    x95.2
....................    lcd_xuat_8bit(lcd_data_x); 
0730:  MOVFF  5A3,5A4
0734:  RCALL  0714
0736:  RETURN 0
.................... } 
.................... void lcd_data(int8 lcd_data_x)        
.................... { 
....................    lcd_rs = 1;      
*
09F8:  BSF    x95.2
....................    lcd_xuat_8bit(lcd_data_x); 
09FA:  MOVFF  5A0,5A4
09FE:  RCALL  0714
0A00:  RETURN 0
.................... } 
....................    
.................... void lcd_power_off()        
.................... { 
....................    lcd_p  = 1;      
....................    xuat_lcd20x4(lcd_control,0x00); 
.................... } 
.................... void lcd_power_on()        
.................... { 
....................    lcd_p  = 0;      
....................    xuat_lcd20x4(lcd_control,0x00); 
.................... } 
.................... void setup_lcd () 
.................... {                      
....................    lcd_e  = 0;  
*
0762:  BCF    x95.0
....................    lcd_rw = 0;  
0764:  BCF    x95.1
....................    lcd_rs = 1;  
0766:  BSF    x95.2
....................    lcd_p  = 0; 
0768:  BCF    x95.3
....................    lcd_command(lcd_function_set);          
076A:  MOVLW  38
076C:  MOVLB  5
076E:  MOVWF  xA3
0770:  MOVLB  0
0772:  RCALL  072E
....................    delay_us(40); 
0774:  MOVLW  42
0776:  MOVWF  00
0778:  DECFSZ 00,F
077A:  BRA    0778
077C:  NOP   
....................    lcd_command(lcd_display_control);    
077E:  MOVLW  0C
0780:  MOVLB  5
0782:  MOVWF  xA3
0784:  MOVLB  0
0786:  RCALL  072E
....................    delay_us(40); 
0788:  MOVLW  42
078A:  MOVWF  00
078C:  DECFSZ 00,F
078E:  BRA    078C
0790:  NOP   
....................    lcd_command(lcd_clear_display);       
0792:  MOVLW  01
0794:  MOVLB  5
0796:  MOVWF  xA3
0798:  MOVLB  0
079A:  RCALL  072E
....................    delay_ms(2); 
079C:  MOVLW  02
079E:  MOVLB  5
07A0:  MOVWF  x99
07A2:  MOVLB  0
07A4:  BRA    0738
....................    lcd_command(lcd_entry_mode);        
07A6:  MOVLW  06
07A8:  MOVLB  5
07AA:  MOVWF  xA3
07AC:  MOVLB  0
07AE:  RCALL  072E
....................    delay_us(40);                 
07B0:  MOVLW  42
07B2:  MOVWF  00
07B4:  DECFSZ 00,F
07B6:  BRA    07B4
07B8:  NOP   
07BA:  GOTO   12E8 (RETURN)
.................... } 
....................  
.................... const unsigned char lcd_so_x[10][6] ={ 
....................                   0,1,2,4,3,5,               // so 0 
....................                   1,2,32,3,7,3,              // so 1 
....................                   6,6,2,4,3,3,               // so 2 
....................                   6,6,2,3,3,5,               // so 3 
....................                   7,3,7,32,32,7,             // so 4 
....................                   7,6,6,3,3,5,               // so 5 
....................                   0,6,6,4,3,5,               // so 6 
....................                   1,1,7,32,32,7,             // so 7 
....................                   0,6,2,4,3,5,               // so 8 
....................                   0,6,2,3,3,5};             // so 9 
....................                    
.................... const unsigned char lcd_ma_8doan[] = { 
....................    0x07,0x0f,0x1f,0x1f,0x1f,0x1f,0x1f,0x1f,  //doan f - 0 
....................    0x1f,0x1f,0x1f,0x00,0x00,0x00,0x00,0x00,  //doan a - 1 
....................    0x1c,0x1e,0x1f,0x1f,0x1f,0x1f,0x1f,0x1f,  //doan b - 2 
....................    0x00,0x00,0x00,0x00,0x00,0x1f,0x1f,0x1f,  //doan d - 3 
....................    0x1f,0x1f,0x1f,0x1f,0x1f,0x1f,0x0f,0x07,  //doan e - 4 
....................    0x1f,0x1f,0x1f,0x1f,0x1f,0x1f,0x1e,0x1c,  //doan c - 5       
....................    0x1f,0x1f,0x1f,0x00,0x00,0x00,0x1f,0x1f,  //doan g+d-6  
....................    0x1f,0x1f,0x1f,0x1f,0x1f,0x1f,0x1f,0x1f}; //doan i  -7 
....................     
.................... void lcd_goto_xy(signed int8 x, signed int8 y) 
.................... {  
....................    const unsigned int8 lcd_vitri[]={0x80,0xc0,0x94,0xd4}; 
....................    lcd_command(lcd_vitri[x]+y); 
*
0B5E:  CLRF   03
0B60:  MOVLB  5
0B62:  MOVF   xA0,W
0B64:  MOVFF  FF2,5A2
0B68:  BCF    FF2.7
0B6A:  MOVLB  0
0B6C:  CALL   0170
0B70:  MOVLB  5
0B72:  BTFSC  xA2.7
0B74:  BSF    FF2.7
0B76:  ADDWF  xA1,W
0B78:  MOVWF  xA2
0B7A:  MOVWF  xA3
0B7C:  MOVLB  0
0B7E:  RCALL  072E
0B80:  RETURN 0
.................... } 
....................  
.................... void xxx() 
.................... {  
....................    signed int8 x; 
....................    x= lcd_so_x[0][0]; 
....................    x= lcd_ma_8doan[0]; 
.................... } 
....................  
.................... void lcd_hienthi_so_z_toado_xy(signed int8 lcd_so, x1, y1) 
.................... {  signed int8 i; 
....................       lcd_goto_xy(x1,y1); 
*
0BD2:  MOVFF  59C,5A0
0BD6:  MOVFF  59D,5A1
0BDA:  RCALL  0B5E
....................       for (i=0;i<6;i++) 
0BDC:  MOVLB  5
0BDE:  CLRF   x9E
0BE0:  BTFSC  x9E.7
0BE2:  BRA    0BEA
0BE4:  MOVF   x9E,W
0BE6:  SUBLW  05
0BE8:  BNC   0C44
....................       {             
....................         if (i==3)   lcd_goto_xy(x1+1,y1);     
0BEA:  MOVF   x9E,W
0BEC:  SUBLW  03
0BEE:  BNZ   0C02
0BF0:  MOVLW  01
0BF2:  ADDWF  x9C,W
0BF4:  MOVWF  x9F
0BF6:  MOVWF  xA0
0BF8:  MOVFF  59D,5A1
0BFC:  MOVLB  0
0BFE:  RCALL  0B5E
0C00:  MOVLB  5
....................       lcd_data(lcd_so_x[lcd_so][i]); 
0C02:  MOVFF  59B,59F
0C06:  MOVLW  06
0C08:  MOVWF  xA0
0C0A:  MOVLB  0
0C0C:  BRA    0B82
0C0E:  MOVF   01,W
0C10:  MOVLB  5
0C12:  CLRF   xA0
0C14:  MOVWF  x9F
0C16:  CLRF   03
0C18:  MOVF   x9E,W
0C1A:  ADDWF  x9F,W
0C1C:  MOVWF  01
0C1E:  MOVF   xA0,W
0C20:  ADDWFC 03,F
0C22:  MOVF   01,W
0C24:  MOVFF  FF2,59F
0C28:  BCF    FF2.7
0C2A:  MOVLB  0
0C2C:  CALL   00C0
0C30:  MOVLB  5
0C32:  BTFSC  x9F.7
0C34:  BSF    FF2.7
0C36:  MOVWF  x9F
0C38:  MOVWF  xA0
0C3A:  MOVLB  0
0C3C:  RCALL  09F8
0C3E:  MOVLB  5
0C40:  INCF   x9E,F
0C42:  BRA    0BE0
....................     } 
0C44:  MOVLB  0
0C46:  RETURN 0
.................... } 
....................  
.................... void lcd_xoa_so_to_toado_xy(signed int8 x1, y1) 
.................... {  signed int8 i; 
....................       lcd_goto_xy(x1,y1); 
....................       for (i=0;i<6;i++) 
....................       {             
....................         if (i==3)   lcd_goto_xy(x1+1,y1);     
....................       lcd_data(' '); 
....................     } 
.................... } 
....................  
....................  
....................  
....................  
....................                                                                                           
....................  
.................... #include <lbr_06_glcd.c>                                                             
.................... unsigned int8 glcd_control;   
.................... #bit glcd_p2   = glcd_control.7 
.................... #bit glcd_p1   = glcd_control.6 
.................... #bit glcd_p0   = glcd_control.5 
.................... #bit glcd_rs   = glcd_control.4 
.................... #bit glcd_rw   = glcd_control.3 
.................... #bit glcd_e    = glcd_control.2 
.................... #bit glcd_nc   = glcd_control.1 
.................... #bit glcd_psb  = glcd_control.0 
....................  
.................... //#define glcd_function_set       0x30 
.................... #define glcd_text_mode          0x30 
.................... #define glcd_graphic_mode       0x36  
....................  
.................... #define glcd_clear_display      0x01 
.................... #define glcd_cursor_display     0x0c 
.................... #define glcd_entry_mode         0x06 
....................  
....................  
.................... #define glcd_addr_line1         0x80 
.................... #define glcd_addr_line2         0x90 
.................... #define glcd_addr_line3         0x88 
.................... #define glcd_addr_line4         0x98 
....................  
.................... void glcd_xuat_8bit(int8 glcd_data1) 
.................... { 
....................       glcd_e=1; xuat_glcd128x64(glcd_control,glcd_data1);      
....................       glcd_e=0; xuat_glcd128x64(glcd_control,glcd_data1);  
.................... } 
....................  
.................... void glcd_command(int8 glcd_data2)    
....................   { 
....................       glcd_rs = 0; 
....................       glcd_xuat_8bit(glcd_data2);       
....................   } 
.................... void glcd_data(int8 glcd_data3)        
....................   { 
....................       glcd_rs = 1;      
....................       glcd_xuat_8bit(glcd_data3);      
....................   } 
....................    
.................... void glcd_data_x(int8 glcd_data3) 
.................... { 
....................       glcd_rs = 1;      
....................       glcd_xuat_8bit(0xa1); 
....................       glcd_xuat_8bit(0x40);   
.................... } 
....................  
.................... void glcd_power_on() 
.................... { 
....................       glcd_p0 = 0;   glcd_p1 = 0;    glcd_p2 = 0;        
....................       xuat_glcd128x64(glcd_control,0x00);   
.................... } 
....................  
.................... void glcd_power_off() 
.................... { 
....................       glcd_p0 = 1;   glcd_p1 = 1;    glcd_p2 = 1;       
....................       xuat_glcd128x64(glcd_control,0x00);   
.................... } 
.................... void setup_glcd (int8 glcd_function_set_mode) 
.................... {                      
....................          glcd_psb = 1; 
....................          glcd_nc = 1; 
....................          glcd_e  = 0; 
....................          glcd_rw = 0;           
....................          glcd_p0 = 0;   glcd_p1 = 0;    glcd_p2 = 0;   
....................          glcd_command(glcd_function_set_mode);          
....................          delay_us(10); 
....................          glcd_command(glcd_cursor_display);        
....................          delay_us(10);     
....................          glcd_command(glcd_clear_display);       
....................          delay_ms(2); 
....................          glcd_command(glcd_entry_mode);       
....................          delay_us(10);                           
.................... } 
....................  
.................... #define glcd_ngang     16 //16x16=256 pixel 
.................... #define glcd_doc       32 //32 hang 
.................... #define glcd_width     128 //danh cho thu vien graphic.c 
.................... int8 doc, ngang; 
....................  
.................... typedef union  
.................... {  
....................   unsigned int16 word;  
....................   unsigned int8 nbyte[2];  
.................... } dots;  
....................  
.................... typedef struct  
.................... {  
....................   int1 refresh;  
....................   dots pixel[glcd_doc][glcd_ngang];     
....................   } gd_ram;     
....................  
.................... gd_ram gdram_vdk;  
....................  
....................  
.................... void glcd_mau_nen(int1 glcd_color)  
.................... {   
....................   int16 d;  
....................   if(glcd_color)  d=0xffff; else d=0; 
....................   for (doc=0; doc < glcd_doc; doc++)  
....................   {  
....................     for (ngang=0; ngang < glcd_ngang; ngang++)  
....................     {  
....................       gdram_vdk.pixel[doc][ngang].word = d;  
....................     }  
....................   }  
....................   gdram_vdk.refresh = true;  
.................... }  
....................  
.................... void glcd_pixel(int8 x, int8 y, int1 color)  
.................... {  
....................   int8  b;  
....................   if(y>31){x += 128; y-= 32;};  
....................   doc = y;  
....................   ngang = x/16;  
....................   b = 15 - (x % 16);  
....................    
....................   if (color == 1) bit_set (gdram_vdk.pixel[doc][ngang].word, b);  
....................   else bit_clear (gdram_vdk.pixel[doc][ngang].word, b);  
....................   gdram_vdk.refresh = true;  
.................... }  
....................  
....................  
.................... void gdram_vdk_to_gdram_glcd_all()  
.................... {  
....................   if (gdram_vdk.refresh)  
....................   {  
....................     for (doc = 0; doc <glcd_doc; doc++)  
....................     {  
....................       glcd_command( 0x80 | doc);   // set vertical address.  
....................       glcd_command( 0x80 | 0);   // set horizontal address.  
....................  
....................       for (ngang=0; ngang <glcd_ngang; ngang++)  
....................       {  
....................         glcd_data( gdram_vdk.pixel[doc][ngang].nbyte[1]);   // write high byte.  
....................         glcd_data( gdram_vdk.pixel[doc][ngang].nbyte[0]);   // write low byte.  
....................       }  
....................     }  
....................     gdram_vdk.refresh = false;  
....................   }  
.................... }  
....................  
.................... void gdram_vdk_to_gdram_glcd_area (int8 x,int8 y,int8 rong, int8 cao) 
.................... { 
....................   int8 hesox,hesoy;  
....................   if (gdram_vdk.refresh)  
....................   {  
....................        
....................       if(((rong+x)/16)!=0)    rong=((rong)/16)+1; 
....................       else                    rong=((rong)/16);  
....................       x = x/16; 
....................       for (doc = y; doc <(y+cao); doc++)  
....................       {  
....................          if(doc>31) 
....................             {   
....................                hesoy = doc-32; 
....................                hesox = 8+x; 
....................                } 
....................          else  
....................          { 
....................             hesoy = doc; 
....................             hesox = x; 
....................             } 
....................          glcd_command( 0x80 |hesoy);    
....................          glcd_command( 0x80 |hesox);   
....................        
....................          for (ngang=hesox; ngang <(hesox+rong); ngang++)  
....................          {  
....................             glcd_data( gdram_vdk.pixel[hesoy][ngang].nbyte[1]);   // write high byte.  
....................             glcd_data( gdram_vdk.pixel[hesoy][ngang].nbyte[0]);   // write low byte.  
....................          }  
....................        }  
....................     gdram_vdk.refresh = false;  
....................   }       
.................... } 
....................  
....................  
.................... //!const unsigned char logo_dhspkttp []= { 0x00,0x01,0x2e,0x00,0x39,0x00, 
.................... //!0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
.................... //!0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
.................... //!0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x00, 
.................... //!0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x02,0x04,0x00,0x00,0x00,0x01,0x02,0x0c, 
.................... //!0x00,0x00,0x00,0x01,0x82,0x0c,0x00,0x00,0x00,0x00,0x80,0x08,0x00,0x00,0x00,0x00, 
.................... //!0x80,0x00,0x00,0x00,0x00,0x00,0x0f,0x80,0x00,0x00,0x00,0x00,0x3f,0xc0,0x00,0x00, 
.................... //!0x00,0x70,0x70,0x70,0x70,0x00,0x00,0x38,0xc8,0x18,0xe0,0x00,0x00,0x18,0xd8,0x18, 
.................... //!0xc0,0x00,0x00,0x01,0xb0,0x0c,0x00,0x00,0x00,0x01,0xa0,0x0c,0x00,0x00,0x00,0x01, 
.................... //!0x60,0x0c,0x00,0x00,0x00,0x01,0x00,0x04,0x00,0x00,0x00,0x01,0x00,0x04,0x00,0x00, 
.................... //!0x00,0x31,0x00,0x04,0x00,0x00,0x00,0x79,0x80,0x0c,0xf0,0x00,0x00,0x71,0x80,0x0c, 
.................... //!0x70,0x00,0x00,0x01,0x80,0x0c,0x00,0x00,0x00,0x00,0xc0,0x18,0x00,0x00,0x00,0x00, 
.................... //!0xc0,0x18,0x00,0x00,0x00,0x00,0x60,0x30,0x00,0x00,0x00,0x00,0x60,0x30,0x00,0x00, 
.................... //!0x00,0x00,0x20,0x20,0x00,0x00,0x00,0x00,0x30,0x60,0x00,0x00,0x00,0x00,0x30,0x60, 
.................... //!0x00,0x00,0x00,0x00,0x3f,0xe0,0x00,0x00,0x00,0x00,0x3f,0xe0,0x00,0x00,0x00,0x00, 
.................... //!0x3f,0xe0,0x00,0x00,0x00,0x00,0x3f,0xe0,0x00,0x00,0x00,0x00,0x1f,0x80,0x00,0x00, 
.................... //!0x00,0x00,0x3e,0x60,0x00,0x00,0x00,0x00,0x39,0xe0,0x00,0x00,0x00,0x00,0x07,0xe0, 
.................... //!0x00,0x00,0x00,0x00,0x1f,0x80,0x00,0x00,0x00,0x00,0x3e,0x60,0x00,0x00,0x00,0x00, 
.................... //!0x3d,0xe0,0x00,0x00,0x00,0x00,0x3f,0xe0,0x00,0x00,0x00,0x00,0x1f,0xc0,0x00,0x00, 
.................... //!0x00,0x00,0x0f,0x80,0x00,0x00,0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
.................... //!0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
.................... //!0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 
.................... //!0x00,0x00,0x00,0x00,0x00,0x00,}; 
.................... //! 
.................... const unsigned char logo_dhspkttp [] = { 
.................... 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
.................... 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00, 
.................... 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x80, 0x00, 0x00, 0x00, 
.................... 0x00, 0x00, 0x00, 0x07, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xa0, 0x00, 0x00, 0x00, 
.................... 0x00, 0x00, 0x00, 0x03, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x20, 0x00, 0x00, 0x00, 
....................  
.................... 0x00, 0x00, 0x00, 0x02, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x30, 0x00, 0x00, 0x00, 
.................... 0x00, 0x00, 0x00, 0x02, 0x30, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x00, 0x00, 0x30, 0x00, 0x7e, 0x00, 
.................... 0x00, 0xfe, 0x00, 0x07, 0xe0, 0x00, 0x3f, 0x00, 0x01, 0xf8, 0x00, 0x03, 0xe0, 0x00, 0x1f, 0x80, 
.................... 0x03, 0xf0, 0x00, 0x01, 0xc0, 0x00, 0x0f, 0xc0, 0x03, 0xe0, 0x00, 0x01, 0xc0, 0x00, 0x07, 0xe0, 
.................... 0x07, 0xc0, 0x00, 0x03, 0xc0, 0x00, 0x03, 0xf0, 0x0f, 0xc0, 0x00, 0x17, 0xf4, 0x00, 0x01, 0xf0, 
....................  
.................... 0x0f, 0x80, 0x00, 0x1d, 0x98, 0x00, 0x00, 0xf8, 0x1f, 0x00, 0x00, 0x11, 0x8c, 0x00, 0x00, 0xf8, 
.................... 0x1f, 0x01, 0x00, 0x31, 0x84, 0x00, 0x80, 0x7c, 0x3e, 0x06, 0x00, 0x31, 0x86, 0x00, 0x20, 0x7c, 
.................... 0x3e, 0x18, 0x00, 0x71, 0x86, 0x00, 0x1c, 0x3e, 0x3c, 0x43, 0x00, 0x31, 0x84, 0x00, 0xc3, 0x3e, 
.................... 0x7c, 0x0c, 0x00, 0x11, 0x8c, 0x00, 0x38, 0x1e, 0x7c, 0x31, 0x00, 0x1d, 0x98, 0x00, 0x86, 0x1f, 
.................... 0x78, 0xc6, 0x00, 0x1f, 0xfc, 0x00, 0x63, 0x1f, 0x78, 0x18, 0x00, 0x03, 0xc0, 0x00, 0x0c, 0x1f, 
....................  
.................... 0xf8, 0x63, 0x80, 0x01, 0x80, 0x00, 0xc7, 0x0f, 0xf9, 0x8e, 0x00, 0x00, 0x00, 0x00, 0x38, 0x8f, 
.................... 0xf8, 0x38, 0x80, 0x00, 0x00, 0x01, 0x0c, 0x0f, 0xf8, 0xc3, 0x80, 0x00, 0x00, 0x00, 0xe3, 0x8f, 
.................... 0xf9, 0x8e, 0x00, 0x00, 0x00, 0x00, 0x30, 0xcf, 0xf8, 0x38, 0xf8, 0x00, 0x00, 0x1f, 0x9e, 0x0f, 
.................... 0xf8, 0xe3, 0xfe, 0x00, 0x00, 0x7f, 0xe3, 0x8f, 0xf9, 0x9f, 0xff, 0xc0, 0x03, 0xff, 0xf9, 0xcf, 
.................... 0x78, 0xff, 0xff, 0xe0, 0x07, 0xff, 0xff, 0x0f, 0x78, 0x1f, 0xff, 0xe0, 0x07, 0xff, 0xfc, 0x1f, 
....................  
.................... 0x7c, 0x07, 0xff, 0xe0, 0x07, 0xff, 0xe0, 0x1f, 0x7c, 0x00, 0xff, 0xe0, 0x07, 0xff, 0x80, 0x1e, 
.................... 0x7c, 0x00, 0x1f, 0xe0, 0x07, 0xfc, 0x00, 0x3e, 0x3e, 0x01, 0xcf, 0xe0, 0x07, 0xf3, 0x80, 0x3e, 
.................... 0x3e, 0x01, 0xff, 0xe0, 0x03, 0xff, 0x80, 0x7c, 0x1f, 0x01, 0xff, 0xe0, 0x03, 0xff, 0xc0, 0x7c, 
.................... 0x1f, 0x01, 0xff, 0xc0, 0x03, 0xff, 0xc0, 0xf8, 0x0f, 0x83, 0xff, 0xc0, 0x01, 0xff, 0xc0, 0xf8, 
.................... 0x0f, 0x83, 0xff, 0xc0, 0x01, 0xff, 0xc1, 0xf0, 0x07, 0xc3, 0xff, 0x80, 0x01, 0xff, 0xe3, 0xf0, 
....................  
.................... 0x03, 0xe3, 0xff, 0x80, 0x01, 0xff, 0xe7, 0xe0, 0x03, 0xf7, 0xff, 0x80, 0x00, 0xff, 0xef, 0xc0, 
.................... 0x01, 0xff, 0xff, 0x80, 0x00, 0xff, 0xff, 0x80, 0x00, 0xff, 0xff, 0x00, 0x00, 0xff, 0xff, 0x80, 
.................... 0x00, 0x7f, 0xff, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x3f, 0xff, 0x00, 0x00, 0xff, 0xfe, 0x00, 
.................... 0x00, 0x1f, 0xff, 0x00, 0x00, 0x7f, 0xf8, 0x00, 0x00, 0x0f, 0xfe, 0x00, 0x00, 0x7f, 0xf0, 0x00, 
.................... 0x00, 0x03, 0xff, 0x00, 0x00, 0x7f, 0xe0, 0x00, 0x00, 0x00, 0xff, 0xfc, 0x1f, 0xff, 0x80, 0x00, 
....................  
.................... 0x00, 0x00, 0x7f, 0xff, 0xff, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xff, 0xff, 0xf8, 0x00, 0x00, 
.................... 0x00, 0x00, 0x01, 0xff, 0xff, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xf0, 0x00, 0x00, 0x00 
.................... }; 
....................  
....................  
.................... void glcd_xuat_anh(int width,int height,int x,int y)  
.................... {  
....................    unsigned int i=0, j=0, k=0;  
....................    unsigned int16 count=0;  
....................    for(j=0;j<height;j++)  
....................       {     
....................          for(;i<width;)  
....................          {  
....................             for(k=8;k>0;k--) 
....................             { 
....................                glcd_pixel(i+x,j+y,bit_test(logo_dhspkttp[count],(k-1)));  
....................                i++;  
....................             }  
....................             count++;  
....................          }  
....................       i=0;  
....................       }  
.................... } 
....................  
....................  
....................  
.................... #include <lbr_08_i2c.c>    
.................... #define   GIAY_HTAI      0X55 
.................... #define   PHUT_HTAI      0X33 
.................... #define   GIO_HTAI       0X08 
.................... #define   THU_HTAI       8 
.................... #define   NGAY_HTAI      0X16 
.................... #define   THANG_HTAI     0X06 
.................... #define   NAM_HTAI       0X13       
.................... #define   MA_DS          0X98 
....................                                                     
.................... #define  ADDR_WR_1307   0xd0 
.................... #define  ADDR_RD_1307   0xd1 
.................... #define  ADDR_MEM        0x00 
....................  
.................... unsigned  char    nam_ds13,thang_ds13,ngay_ds13,thu_ds13,gio_ds13, 
....................                   phut_ds13,giay_ds13,ma_ds13,control_ds13,giaytam; 
....................                                                                               
.................... void thiet_lap_thoi_gian_hien_tai() 
.................... {     giay_ds13   =   giay_htai;       phut_ds13  =    phut_htai;    
....................       gio_ds13    =   gio_htai;        thu_ds13   =    thu_htai; 
....................       ngay_ds13   =   ngay_htai;       thang_ds13 =    thang_htai;    
....................       nam_ds13    =   nam_htai;    
....................       control_ds13 = 0x90;             ma_ds13      =   ma_ds;  
....................       giaytam=0; 
.................... } 
....................   
.................... void nap_thoi_gian_htai_vao_ds1307() 
.................... {     i2c_start();          
....................       i2c_write(addr_wr_1307);    i2c_write(0x00); 
....................       i2c_write(giay_ds13);        i2c_write(phut_ds13);       
....................       i2c_write(gio_ds13);         i2c_write(thu_ds13);       
....................       i2c_write(ngay_ds13);        i2c_write(thang_ds13);             
....................       i2c_write(nam_ds13);         i2c_write(control_ds13);    
....................       i2c_write(ma_ds13); 
....................       i2c_stop(); 
.................... } 
....................      
.................... void doc_thoi_gian_tu_realtime() 
.................... {    
....................       i2c_start(); 
....................       i2c_write(addr_wr_1307); 
....................       i2c_write(addr_mem);                      
....................       i2c_start();                 
....................                  
....................       i2c_write(addr_rd_1307); 
....................       giay_ds13      =  i2c_read();               
....................       phut_ds13      =  i2c_read();              
....................       gio_ds13       =  i2c_read();              
....................       thu_ds13       =  i2c_read();  
....................       ngay_ds13      =  i2c_read();  
....................       thang_ds13     =  i2c_read();  
....................       nam_ds13       =  i2c_read();  
....................       control_ds13   =  i2c_read();           
....................       ma_ds13        =  i2c_read(0);     //not ack 
....................       i2c_stop(); 
.................... }     
....................  
....................     
.................... void doc_giay_tu_realtime() 
.................... {    
....................       i2c_start(); 
....................       i2c_write(addr_wr_1307); 
....................       i2c_write(addr_mem);                      
....................       i2c_start();                 
....................                  
....................       i2c_write(addr_rd_1307); 
....................       giay_ds13      =  i2c_read(0);               
....................       i2c_stop(); 
.................... }   
....................          
....................   
.................... void hien_thi_thoi_gian_ds1307 ( ) 
.................... {     lcd_goto_xy(3,3);  //lcd_command (0x8c);    
....................       lcd_data(gio_ds13/16  +0x30);    lcd_data(gio_ds13%16  +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(phut_ds13/16 +0x30);    lcd_data(phut_ds13%16 +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(giay_ds13/16 +0x30);    lcd_data(giay_ds13%16 +0x30); 
....................       lcd_goto_xy(3,12); //lcd_command (0xcc);   
....................       lcd_data(ngay_ds13/16 +0x30);    lcd_data(ngay_ds13%16 +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(thang_ds13/16 +0x30);   lcd_data(thang_ds13%16 +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(nam_ds13/16 +0x30);     lcd_data(nam_ds13%16 +0x30);  
.................... } 
....................  
.................... #define pcf8591_address_wr    0x90 
.................... #define pcf8591_address_rd    0x91 
....................  
.................... #define pcf8591_channel_0       0x40 
.................... #define pcf8591_channel_1       0x41 
.................... #define pcf8591_channel_2       0x42 
.................... #define pcf8591_channel_3       0x43 
....................  
.................... void pcf8591_chonkenh(unsigned char kenh) 
.................... { 
....................    i2c_start(); 
....................    i2c_write(pcf8591_address_wr); 
....................    i2c_write(kenh); 
....................    i2c_stop(); 
.................... } 
....................  
.................... void pcf8591_xuat_dac(unsigned char dac_out) 
.................... { 
....................    i2c_start(); 
*
0996:  BSF    F93.0
0998:  MOVLW  05
099A:  MOVWF  00
099C:  DECFSZ 00,F
099E:  BRA    099C
09A0:  BSF    F93.1
09A2:  MOVLW  06
09A4:  MOVWF  00
09A6:  DECFSZ 00,F
09A8:  BRA    09A6
09AA:  BCF    F8A.0
09AC:  BCF    F93.0
09AE:  MOVLW  05
09B0:  MOVWF  00
09B2:  DECFSZ 00,F
09B4:  BRA    09B2
09B6:  BCF    F8A.1
09B8:  BCF    F93.1
....................    i2c_write(pcf8591_address_wr); 
09BA:  MOVLW  90
09BC:  MOVLB  5
09BE:  MOVWF  x9A
09C0:  MOVLB  0
09C2:  RCALL  0944
....................    i2c_write(pcf8591_channel_0); 
09C4:  MOVLW  40
09C6:  MOVLB  5
09C8:  MOVWF  x9A
09CA:  MOVLB  0
09CC:  RCALL  0944
....................    i2c_write(dac_out); 
09CE:  MOVFF  599,59A
09D2:  RCALL  0944
....................    i2c_stop(); 
09D4:  BCF    F93.0
09D6:  NOP   
09D8:  BSF    F93.1
09DA:  BTFSS  F81.1
09DC:  BRA    09DA
09DE:  MOVLW  05
09E0:  MOVWF  00
09E2:  DECFSZ 00,F
09E4:  BRA    09E2
09E6:  BRA    09E8
09E8:  NOP   
09EA:  BSF    F93.0
09EC:  MOVLW  05
09EE:  MOVWF  00
09F0:  DECFSZ 00,F
09F2:  BRA    09F0
09F4:  GOTO   12FC (RETURN)
.................... } 
....................  
.................... unsigned char  pcf8591_doc_adc() 
.................... { unsigned char tam; 
....................    i2c_start(); 
....................    i2c_write(pcf8591_address_rd);    
....................    tam= i2c_read(0); 
....................    i2c_stop(); 
....................  return tam; 
.................... } 
....................  
....................  
....................  
....................  
....................  
.................... //#include <lbr_09_dongco.c>  
.................... #include <lbr_10_matran_cot.c>                              
....................  
....................  
.................... #include <lbr_10_matran_hang.c>  
....................  
....................  
....................  
.................... #include <chuong3_32led_key.c> 
....................                                                                                            
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //TAT CA DEU VIET THEO BAI VA HAM THEO BAI  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //Khai bao bien 32led key 
.................... signed int8 mp,mp1=1; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 301: chop tat 8 led theo cach 1  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_301_chop_tat_8led_c1() 
.................... {                                                  
....................    xuat_32led_don_4byte(0,0,0,0); 
....................    delay_ms(200);    
....................    xuat_32led_don_4byte(0,0,0,0xff); 
....................    delay_ms(200);               
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 301: chop tat 8 led theo cach 2 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_301_chop_tat_8led_c2(unsigned int16 dl) 
.................... {                                                  
....................    xuat_32led_don_4byte(0,0,0,0); 
....................    delay_ms(dl);    
....................    xuat_32led_don_4byte(0,0,0,0xff); 
....................    delay_ms(dl);               
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 302: chop tat 16 led theo cach 2 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_302_chop_tat_16led(unsigned int16 dl) 
.................... {                                                  
....................    xuat_32led_don_4byte(0,0,0,0); 
....................    delay_ms(dl);    
....................    xuat_32led_don_4byte(0,0,0xff,0xff); 
....................    delay_ms(dl);               
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 303: chop tat 32 led  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_303_chop_tat_32led(unsigned int16 dl) 
.................... {                                                  
....................    xuat_32led_don_4byte(0,0,0,0); 
....................    delay_ms(dl);    
....................    xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................    delay_ms(dl);               
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 304: sang tat dan 8 led  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_304_std_pst_8led(unsigned int16 dl) 
.................... {                                                  
....................    for(i=0;i<8;i++) 
....................    { 
....................       y8=(y8<<1)+1; 
....................       xuat_32led_don_4byte(0,0,0,y8); 
....................       delay_ms(dl); 
....................    }              
....................    for(i=0;i<8;i++) 
....................    { 
....................       y8=(y8<<1); 
....................       xuat_32led_don_4byte(0,0,0,y8); 
....................       delay_ms(dl); 
....................    }                
.................... } 
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 305: sang tat dan 16 led  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_305_std_pst_16led(unsigned int16 dl) 
.................... {                                                  
....................    for(i=0;i<16;i++) 
....................    { 
....................       lp=(lp<<1)+1; 
....................       xuat_32led_don_2word(0,lp); 
....................       delay_ms(dl); 
....................    }              
....................    for(i=0;i<16;i++) 
....................    { 
....................       lp=(lp<<1); 
....................       xuat_32led_don_2word(0,lp); 
....................       delay_ms(dl); 
....................    }                
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 306: sang tat dan 16 led chay 2 nhom song song 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_306_std_pst_16led_ss(unsigned int16 dl) 
.................... {                                                  
....................    for(i=0;i<16;i++) 
....................    { 
....................       lt=(lt>>1)+0x8000; 
....................       xuat_32led_don_2word(lt,lt); 
....................       delay_ms(dl); 
....................    }              
....................    for(i=0;i<16;i++) 
....................    { 
....................       lt=(lt>>1); 
....................       xuat_32led_don_2word(lt,lt); 
....................       delay_ms(dl); 
....................    }                
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 307: sang tat dan 32 led pst 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_307_std_pst_32led(unsigned int16 dl) 
.................... {                                                  
....................    for(i=0;i<32;i++) 
....................    { 
....................       y=(y<<1)+1; 
....................       xuat_32led_don_1dw(y); 
....................       delay_ms(dl); 
....................    }              
....................    for(i=0;i<32;i++) 
....................    { 
....................       y=(y<<1); 
....................       xuat_32led_don_1dw(y); 
....................       delay_ms(dl); 
....................    }                
.................... } 
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 308: sang tat dan 32 led tsp 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_308_std_tsp_32led(unsigned int16 dl) 
.................... {                                                  
....................    for(i=0;i<32;i++) 
....................    { 
....................       y=(y>>1)+0x80000000; 
....................       xuat_32led_don_1dw(y); 
....................       delay_ms(dl); 
....................    }              
....................    for(i=0;i<32;i++) 
....................    { 
....................       y=(y>>1); 
....................       xuat_32led_don_1dw(y); 
....................       delay_ms(dl); 
....................    }                
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 309: sang tat dan 32 led pst-tsp 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_309_std_pst_32led(unsigned int16 dl) 
.................... {                                                  
....................    bai_307_std_pst_32led(dl); 
....................    bai_308_std_tsp_32led(dl); 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 310: tong hop nheu chuong trinh 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_310_chop_tat_32led_nlan(unsigned int16 dl,usi8 n) 
.................... {                                                     
....................    for(sl=0;sl<n;sl++) 
....................    { 
....................       bai_303_chop_tat_32led(dl); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_310_std_pst_32led_nlan(unsigned int16 dl,usi8 n) 
.................... {                                                     
....................    for(sl=0;sl<n;sl++) 
....................    { 
....................       bai_307_std_pst_32led(dl); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_310_std_tsp_32led_nlan(unsigned int16 dl,usi8 n) 
.................... {                                                     
....................    for(sl=0;sl<n;sl++) 
....................    { 
....................       bai_308_std_tsp_32led(dl); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_310_tong_hop_dk_32led() 
.................... {                                                  
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_310_std_pst_32led_nlan(30,2); 
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_310_std_tsp_32led_nlan(30,2);   
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 305: sang tat dan 16 led  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_311_xuat_std_tnv_ttr_pst_tsp(unsigned int16 dl, unsigned int8 tt) 
.................... { 
....................    if(tt==0)   xuat_32led_don_2word(lp,lp); 
....................    if(tt==1)   xuat_32led_don_2word(lt,lt); 
....................    if(tt==2)   xuat_32led_don_2word(lt,lp); 
....................    if(tt==3)   xuat_32led_don_2word(lp,lt);    
....................    delay_ms(dl); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void ham_311_std_tnv_ttr_pst_tsp(unsigned int16 dl,unsigned int8 tt) 
.................... {                                                  
....................    for(i=0;i<16;i++) 
....................    { 
....................       lp=(lp<<1)+1; 
....................       lt=(lt>>1)+0x8000; 
....................       ham_311_xuat_std_tnv_ttr_pst_tsp(dl,tt); 
....................    }              
....................    for(i=0;i<16;i++) 
....................    { 
....................       lp=(lp<<1); 
....................       lt=(lt>>1); 
....................       ham_311_xuat_std_tnv_ttr_pst_tsp(dl,tt); 
....................    }                
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_311_tong_hop_dk_32led() 
.................... {                                                  
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_310_std_pst_32led_nlan(30,2); 
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_310_std_tsp_32led_nlan(30,2);  
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_311_std_tnv_ttr_pst_tsp(30,2);  
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_311_std_tnv_ttr_pst_tsp(30,3);  
....................     
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_311_std_tnv_ttr_pst_tsp(30,0);  
....................    ham_310_chop_tat_32led_nlan(100,5); 
....................    ham_311_std_tnv_ttr_pst_tsp(30,1);  
....................     
.................... } 
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 321: dk 32led on off  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b321_dk_32led_on_off_2bt()   
.................... {   
....................    if(phim_on_c1(c_ktnp,0)==co_nhan) 
....................       xuat_32led_don_1dw(0xffffffff); 
....................    if(phim_off_c1(c_ktnp,0)==co_nhan)  
....................       xuat_32led_don_1dw(0);                                    
.................... }  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 322: dk 8led on off inv  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b322_on_off_inv_8led()   
.................... {   
....................    WHILE(INPUT(ON)); 
....................    Y8 = 0X0F; 
....................    XUAT_32LED_DON_4BYTE(0,0,0,Y8); 
....................    DO 
....................    { 
....................       IF(!INPUT(INV)) 
....................       { 
....................          Y8 = ~Y8; 
....................          XUAT_32LED_DON_4BYTE(0,0,0,Y8); 
....................       } 
....................    }WHILE(INPUT(OFF)); 
....................    XUAT_32LED_DON_4BYTE(0,0,0,0);                                   
.................... }  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 323: dk 8led on off inv CHONG DOI 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_323_phim_inv() 
.................... { 
....................    IF(!INPUT(INV)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(INV)) 
....................       { 
....................          Y8=~Y8; 
....................          XUAT_32LED_DON_4BYTE(0,0,0,Y8); 
....................          WHILE(!INPUT(INV)); 
....................       } 
....................    } 
.................... } 
.................... void b323_on_off_inv_cdoi_8led()   
.................... {   
....................    WHILE(INPUT(ON)); 
....................    Y8 = 0X0F; 
....................    XUAT_32LED_DON_4BYTE(0,0,0,Y8); 
....................    DO 
....................    { 
....................      ham_323_phim_inv();  
....................    }WHILE(INPUT(OFF)); 
....................    XUAT_32LED_DON_4BYTE(0,0,0,0);                                   
.................... }  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 324: dk 16led UP DW CLR 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_324_phim_up() 
.................... { 
....................    IF(!INPUT(UP)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(UP)) 
....................       { 
....................          lp=(lp<<1) + 1; 
....................          XUAT_32LED_DON_2WORD(0,lp); 
....................          do{}WHILE(!INPUT(UP)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_324_phim_dw() 
.................... { 
....................    IF(!INPUT(dw)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(dw)) 
....................       { 
....................          lp=(lp>>1); 
....................          XUAT_32LED_DON_2WORD(0,lp); 
....................          do{}WHILE(!INPUT(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_324_phim_clr() 
.................... { 
....................    IF(!INPUT(clr)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(clr)) 
....................       { 
....................          lp=0; 
....................          XUAT_32LED_DON_2WORD(0,lp); 
....................          do{}WHILE(!INPUT(clr)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b324_16led_up_dw_clr_1()   
.................... {   
....................      ham_324_phim_up(); 
....................      ham_324_phim_dw(); 
....................      ham_324_phim_clr(); 
....................                                       
.................... }  
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 325: dk 16led UP DW CLR - CLR them chuc nang dao chieu 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_325_phim_up() 
.................... { 
....................    IF(!INPUT(UP)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(UP)) 
....................       { 
....................          if(i==0) 
....................             lp=(lp<<1) + 1; 
....................          else 
....................             lp=(lp>>1) + 0x8000; 
....................          XUAT_32LED_DON_2WORD(0,lp); 
....................          do{}WHILE(!INPUT(UP)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_325_phim_dw() 
.................... { 
....................    IF(!INPUT(dw)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(dw)) 
....................       { 
....................          if(i==0) 
....................             lp=(lp>>1); 
....................          else 
....................             lp=(lp<<1); 
....................          XUAT_32LED_DON_2WORD(0,lp); 
....................          do{}WHILE(!INPUT(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_325_phim_clr() 
.................... { 
....................    IF(!INPUT(clr)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(clr)) 
....................       { 
....................          lp=0; 
....................          i=~i; 
....................          XUAT_32LED_DON_2WORD(0,lp); 
....................          do{}WHILE(!INPUT(clr)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b325_16led_up_dw_clr_2()   
.................... {   
....................      
....................      ham_325_phim_up(); 
....................      ham_325_phim_dw(); 
....................      ham_325_phim_clr(); 
....................                                       
.................... }  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 326: dk 32led UP DW CLR 7 che do 
.................... // Duoc giai o bai b337 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 332: ma tran phim hien thi led don 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b332_matranphim_leddon()   
.................... {   
....................     signed int8 mp; 
....................     mp = key_4x4_dw(); 
....................     if(mp!=0xff) 
....................       xuat_32led_don_4byte(0,0,0,mp); 
....................                                       
.................... }  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 333: ma tran phim dieu khien 8 led sang tat 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b333_matranphim_8led_on_off()   
.................... {   
....................     signed int8 mp; 
....................     do  
....................     { 
....................       mp=key_nhan(); 
....................     }while(mp!=1); 
....................     xuat_32led_don_4byte(0,0,0,0xff); 
....................      
....................     do  
....................     { 
....................       mp=key_nhan(); 
....................     }while(mp!=0); 
....................     xuat_32led_don_4byte(0,0,0,0); 
....................                                       
.................... }  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 334: ma tran phim dieu khien 8 phim led sang va 8 phim led tat 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b334_matranphim_8led_16_btn_on_off()   
.................... {   
....................       signed int8 mp; 
....................       mp=key_4x4_dw(); 
....................       if(mp<8) 
....................          {y8=y8|(1<<mp); 
....................          xuat_32led_don_4byte(0,0,0,y8);} 
....................       else if(mp<16) 
....................            {y8=y8  &(~(1<<(mp-8))); 
....................            xuat_32led_don_4byte(0,0,0,y8);}                                     
.................... }  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 335: BAI TONG HOP TUONG TU 326 NHUNG DUNG MA TRAN PHAM 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... void bai_335_7ct_7btn() 
.................... { 
....................    xuat_4led_7doan_1so(ma7doan[mp]); 
....................    mp=key_4x4_up(); 
....................    if(mp==1) sang_tat_32led(10,0); 
....................    if(mp==2) sang_tat_dan_pst_32led(10,0); 
....................    if(mp==3) sang_tat_dan_tsp_32led(10,0); 
....................    if(mp==4) sang_tat_dan_ngoai_vao_32led(10,0); 
....................    if(mp==5) sang_tat_dan_trong_ra_32led(10,0); 
....................    if(mp==6) sang_don_pst_32led(10,0); 
....................    if(mp==7) sang_don_tsp_32led(10,0); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 337: dk 32led UP DW CLR 7 che do *bai giai cho bai 326* 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_337_phim_up() 
.................... { 
....................    if(!input(up) && (ttct<7)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(up)) 
....................       { 
....................          ttct++; 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_337_phim_dw() 
.................... { 
....................    if(!input(dw) && (ttct>1)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(dw)) 
....................       { 
....................          ttct--; 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_337_phim_clr() 
.................... { 
....................    if(!input(clr) && (ttct>1)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(dw)) 
....................       { 
....................          ttct=1; 
....................          reset_toan_bo_bien(); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void b337_tonghop_up_dn_clr() 
.................... { 
....................    xuat_4led_7doan_1so(ma7doan[ttct]); 
....................    if(ttct==1) sang_tat_32led(10,0); 
....................    if(ttct==2) sang_tat_dan_pst_32led(10,0); 
....................    if(ttct==3) sang_tat_dan_tsp_32led(10,0); 
....................    if(ttct==4) sang_tat_dan_ngoai_vao_32led(10,0); 
....................    if(ttct==5) sang_tat_dan_trong_ra_32led(10,0); 
....................    if(ttct==6) sang_don_pst_32led(10,0); 
....................    if(ttct==7) sang_don_tsp_32led(10,0); 
....................    ham_337_phim_up(); 
....................    ham_337_phim_dw(); 
....................    ham_337_phim_clr();  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 338: dk 32led chay 7 che do tu dong 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................   
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void b338_quangcao() 
.................... { 
....................    if(ttct_td==1) sang_tat_32led(10,0); 
....................    if(ttct_td==2) sang_tat_dan_pst_32led(10,0); 
....................    if(ttct_td==3) sang_tat_dan_tsp_32led(10,0); 
....................    if(ttct_td==4) sang_tat_dan_ngoai_vao_32led(10,0); 
....................    if(ttct_td==5) sang_tat_dan_trong_ra_32led(10,0); 
....................    if(ttct_td==6) sang_don_pst_32led(10,0); 
....................    if(ttct_td==7) diem_sang_dich_trai_mat_dan_32led(10,0); 
....................    if(ttct_td==8) sang_don_tsp_32led(10,0); 
....................    if(ttct_td==9) diem_sang_dich_phai_mat_dan_32led(10,0); 
....................    if(ttct_td==10) sang_tat_dan_trai_sang_phai_2x16led(10,0); 
....................    if(ttct_td==11) sang_tat_dan_phai_sang_trai_2x16led(10,0); 
....................    if(ttct_td==12) diem_sang_di_chuyen_pst_32led(10,0); 
....................    if(ttct_td==13) diem_sang_di_chuyen_tsp_32led(10,0); 
....................    if(ttct_td==14) sang_don_tnt_32led(10,0); 
....................    if(ttct_td==15) sang_don_ttr_32led(10,0); 
....................    if(ttct_td>15) ttct_td=1; 
....................    xuat_4led_7doan_2so(ma7doan[ttct_td/10],ma7doan[ttct_td%10]); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
....................  
.................... #include <chuong4_4led_7doan.c>    
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //TAT CA DEU VIET THEO BAI VA HAM THEO BAI  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //Khai bao bien timer 
.................... unsigned int8 t0,t0_tam; 
.................... unsigned int16 t0_16bit,t0_tam_16bit; 
.................... unsigned int8 donvi=0,chuc=0,tram=0; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... void khoi_tao_timer0() 
.................... { 
....................    setup_timer_0(t0_ext_l_to_h | t0_div_1); 
*
065A:  MOVLW  A8
065C:  MOVWF  FD5
....................    set_timer0(0); 
065E:  CLRF   FD7
0660:  CLRF   FD6
0662:  GOTO   12E0 (RETURN)
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 401: hien thi 4 so tu 0-3 cho 4 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_401_hienthi_4so() 
.................... { 
....................    xuat_4led_7doan_4so(0xb0, 0xa4, 0xf9, 0xc0); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 402: hien thi 0-9 cho 1 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_402_dem_0_9() 
.................... { 
....................    for(i=0;i<10;i++) 
....................    { 
....................       xuat_4led_7doan_1so(ma7doan[i]); 
....................       delay_ms(500); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 403: hien thi 00-99 cho 2 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_403_dem_00_99() 
.................... { 
....................    for(i=0;i<99;i++) 
....................    { 
....................       xuat_4led_7doan_2so(ma7doan[i/10],ma7doan[i%10]); 
....................       delay_ms(100); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 404: hien thi 00-59 cho 2 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_404_dem_00_59() 
.................... { 
....................    for(i=0;i<60;i++) 
....................    { 
....................       xuat_4led_7doan_2so(ma7doan[i/10],ma7doan[i%10]); 
....................       delay_ms(500); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 405: hien thi 00-59-00 cho 2 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_405_dem_00_59_00() 
.................... { 
....................    for(i=0;i<60;i++) 
....................    { 
....................       xuat_4led_7doan_2so(ma7doan[i/10],ma7doan[i%10]); 
....................       delay_ms(200); 
....................    } 
....................    i=59; 
....................    for(i=59;i>0;i--) 
....................    { 
....................       xuat_4led_7doan_2so(ma7doan[i/10],ma7doan[i%10]); 
....................       delay_ms(200); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 406: hien thi 00-59-00 cho 2 led 7doan, thoi gian dung tai 59 va 00 la 3s 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_406_dem_00_59_00_3s() 
.................... { 
....................       i=0; 
....................       do 
....................       { 
....................          xuat_4led_7doan_2so(ma7doan[i/10],ma7doan[i%10]); 
....................          delay_ms(200); 
....................          if(i==59) 
....................             break; 
....................          i++; 
....................       }while(i<=59); 
....................       delay_ms(3000); 
....................       do 
....................       {  
....................             xuat_4led_7doan_2so(ma7doan[i/10],ma7doan[i%10]); 
....................             delay_ms(200); 
....................             if(i==0) 
....................                break; 
....................             i--; 
....................    
....................       }while(i>=0); 
....................       delay_ms(3000); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 407: hien thi 000-999 cho 3 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_407_dem_000_999() 
.................... { 
....................    for(y=0;y<1000;y++) 
....................    { 
....................       xuat_4led_7doan_3so(ma7doan[y/100],ma7doan[y/10%10],ma7doan[y%10]); 
....................       delay_ms(50); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 408: hien thi 00.0-9999 cho 4 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_408_dem_0000_9999() 
.................... { 
....................  
....................     
....................    for(y=0;y<10000;y++) 
....................    { 
....................       xuat_4led_7doan_4so(ma7doan[y/1000],ma7doan[y/100%10],ma7doan[y/10%10],ma7doan[y%10]); 
....................       delay_ms(50); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 409: hien thi dem phut giay cho 2 led 7doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_409_dem_phut_giay() 
.................... { 
....................    for(y=0;y<60;y++) 
....................    { 
....................       for(i=0;i<60;i++) 
....................       { 
....................          xuat_4led_7doan_4so(ma7doan[y/10],ma7doan[y%10],ma7doan[i/10],ma7doan[i%10]); 
....................          delay_ms(500); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 411: dem dung counter t0 hien thi 4 led 7doan 0-100 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_411_dem_xung_t0() 
.................... { 
....................    t0=get_timer0(); 
....................    xuat_4led_7doan_3so(ma7doan[t0/100],ma7doan[t0/10%10],ma7doan[t0%10]); 
....................    if(t0>=101) 
....................       set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 412: dem dung counter t0 hien thi 4 led 7doan 0-100 xoa so 0 vo nghia 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_412_giai_ma_hien_thi(unsigned int16 tam) 
.................... { 
....................    donvi=ma7doan[tam%10]; 
....................    chuc=ma7doan[tam/10%10]; 
....................    tram=ma7doan[tam/100]; 
....................    if(tram==0xc0) 
....................    { 
....................       tram=0xff; 
....................       if(chuc==0xc0) 
....................          chuc=0xff; 
....................    } 
....................    xuat_4led_7doan_3so(tram,chuc,donvi); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void bai_412_dem_xung_t0_xoa_so0_vn() 
.................... { 
....................    t0=get_timer0(); 
....................    ham_412_giai_ma_hien_thi(t0); 
....................    if(t0>=101) 
....................       set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 413: dem dung counter t0 hien thi 4 led 7doan 0-100 xoa so 0 vo nghia  
.................... //         nhung chi hien thi khi co ket qua dem 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void bai_413_dem_xung_t0_xoa_so0_vn_ct() 
.................... { 
....................    t0_tam=t0=0; 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    } 
....................    if(t0>=101) 
....................       set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 414: dem 4 led 7doan tu 240-255 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void bai_414_dem_xung_t0_240_255() 
.................... { 
....................    t0_tam=t0=0; 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    } 
....................    if(t0==0) 
....................       set_timer0(240); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 415: dem 4 led 7doan tu 250-300 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void bai_415_dem_xung_t0_250_300() 
.................... { 
....................    t0_tam_16bit=t0_16bit=0; 
....................    t0_16bit=get_timer0(); 
....................    if(t0_16bit!=t0_tam_16bit) 
....................    { 
....................       t0_tam_16bit=t0_16bit; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0_16bit); 
....................    } 
....................    if(t0_16bit>=301) 
....................       set_timer0(250); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 416: dem 4 led 7doan tu 0-9999 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void bai_416_dem_xung_t0_0_9999() 
.................... { 
....................    t0_tam_16bit=t0_16bit=0; 
....................    t0_16bit= get_timer0(); 
....................    if(t0_16bit!=t0_tam_16bit) 
....................    { 
....................       t0_tam_16bit=t0_16bit; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0_16bit); 
....................    } 
....................    if(t0_16bit>=10000) 
....................       set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 417: giong bai 413 nhung hien thi 32led don va co nut nhan on off 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_417_phim_on() 
.................... { 
....................    IF(!INPUT(on)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(on)) 
....................       { 
....................          setup_timer_0(t0_ext_l_to_h); 
....................          set_timer0(t0_16bit); 
....................          xuat_32led_don_1dw(0xFFFFFFFF); 
....................          do{}WHILE(!INPUT(on)); 
....................       } 
....................    } 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_417_phim_off() 
.................... { 
....................    IF(!INPUT(off)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(off)) 
....................       { 
....................          setup_timer_0(t0_ext_l_to_h | t0_div_1|T0_OFF); 
....................          xuat_32led_don_1dw(0x00); 
....................          set_timer0(t0_16bit); 
....................          do{}WHILE(!INPUT(off)); 
....................       } 
....................    } 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_417_dem_xung_t0_start_stop_32led() 
.................... { 
....................    ham_417_phim_on(); 
....................    ham_417_phim_off(); 
....................    t0_tam_16bit=t0_16bit=0; 
....................    t0_16bit=get_timer0(); 
....................    if(t0_16bit!=t0_tam_16bit) 
....................    { 
....................       t0_tam_16bit=t0_16bit; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0_16bit); 
....................    } 
....................    if(t0_16bit>=10000) 
....................       set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 421: ket hop 413 va 338 : vua dem san pham vua dieu khien 32 led don sang nhieu chuong trinh 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_421_phim_up() 
.................... { 
....................    if((!input(up)) && (ttct<7)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(up)) 
....................       { 
....................          ttct++; 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_421_phim_dw() 
.................... { 
....................    if((!input(dw)) && (ttct>1)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(dw)) 
....................       { 
....................          ttct--; 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_421_phim_clr() 
.................... { 
....................    if((!input(clr)) && (ttct>1)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(clr)) 
....................       { 
....................          ttct=1; 
....................          while(!input(clr)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_421_dem_xung_t0_quang_cao_32led() 
.................... { 
....................    //ttct=1; 
....................    t0_tam=t0; 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0); 
....................       if(t0>=101) 
....................          set_timer0(1); 
....................    } 
....................    if(ttct==1) sang_tat_32led(10,0); 
....................    if(ttct==2) sang_tat_dan_pst_32led(10,0); 
....................    if(ttct==3) sang_tat_dan_tsp_32led(10,0); 
....................    if(ttct==4) sang_tat_dan_ngoai_vao_32led(10,0); 
....................    if(ttct==5) sang_tat_dan_trong_ra_32led(10,0); 
....................    if(ttct==6) sang_don_pst_32led(10,0); 
....................    if(ttct==7) sang_don_tsp_32led(10,0); 
....................    ham_421_phim_up(); 
....................    ham_421_phim_dw(); 
....................    ham_421_phim_clr(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 422: ket hop 413 va 338 : vua dem san pham vua dieu khien 32 led don sang nhieu chuong trinh nhung tu dong 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_422_dem_xung_t0_quang_cao_32led() 
.................... { 
....................    //ttct=1; 
....................    t0_tam=t0; 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0); 
....................       if(t0>=101) 
....................          set_timer0(1); 
....................    } 
....................    if(ttct_td==1) sang_tat_32led(10,0); 
....................    if(ttct_td==2) sang_tat_dan_pst_32led(10,0); 
....................    if(ttct_td==3) sang_tat_dan_tsp_32led(10,0); 
....................    if(ttct_td==4) sang_tat_dan_ngoai_vao_32led(10,0); 
....................    if(ttct_td==5) sang_tat_dan_trong_ra_32led(10,0); 
....................    if(ttct_td==6) sang_don_pst_32led(10,0); 
....................    if(ttct_td==7) diem_sang_dich_trai_mat_dan_32led(10,0); 
....................    if(ttct_td==8) sang_don_tsp_32led(10,0); 
....................    if(ttct_td==9) diem_sang_dich_phai_mat_dan_32led(10,0); 
....................    if(ttct_td==10) sang_tat_dan_trai_sang_phai_2x16led(10,0); 
....................    if(ttct_td==11) sang_tat_dan_phai_sang_trai_2x16led(10,0); 
....................    if(ttct_td==12) diem_sang_di_chuyen_pst_32led(10,0); 
....................    if(ttct_td==13) diem_sang_di_chuyen_tsp_32led(10,0); 
....................    if(ttct_td==14) sang_don_tnt_32led(10,0); 
....................    if(ttct_td==15) sang_don_ttr_32led(10,0); 
....................    if(ttct_td>15) ttct_td=1; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 423: dich 4 led 7 doan, du lieu nhap tu ma tran phim 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... unsigned char m4led[4]={0x7f,0x7f,0x7f,0x7f}; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_423_key_4x4_4led_dich() 
.................... { 
....................    unsigned int mp,i; 
....................     
....................    xuat_4led_7doan_4so(m4led[3],m4led[2],m4led[1],m4led[0]); 
....................    do {mp=key_4x4_dw();} 
....................    while(mp==0xff); 
....................    for(i=3;i>0;i--) 
....................    { 
....................       m4led[i]=m4led[i-1];   
....................    } 
....................    m4led[0]=ma7doan[mp]; 
....................    xuat_4led_7doan_4so(m4led[3],m4led[2],m4led[1],m4led[0]); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 424: dich 4 led 7 doan, du lieu nhap tu ma tran phim, phim C tra ve ban dau, phim B undo toi da 4 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... unsigned char m4led8[8]={0x7f,0x7f,0x7f,0x7f,0x7f,0x7f,0x7f,0x7f}; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_424_key_4x4_4led_dich_undo4() 
.................... { 
....................    unsigned int mp; 
....................    signed int i,j; 
....................    xuat_4led_7doan_4so(m4led8[4],m4led8[5],m4led8[6],m4led8[7]); 
....................    do  
....................    { 
....................       mp=key_4x4_dw(); 
....................    } 
....................    while(mp==0xff); 
....................    if(mp<10) 
....................    { 
....................      for(i=0;i<8;i++) 
....................       { 
....................          m4led8[i]=m4led8[i+1]; 
....................       } 
....................       m4led8[7]=ma7doan[mp]; 
....................       if(j<4) 
....................          j++; 
....................    } 
....................    else if(mp==0x0B)//phimB 
....................    {  
....................       if(j>0) 
....................       { 
....................          j--; 
....................          for(i=6;i>-1;i--) 
....................             m4led8[i+1]=m4led8[i]; 
....................       } 
....................     } 
....................    else if(mp==0x0C)//phimC 
....................    { 
....................       j=0; 
....................       for(i=0;i<8;i++) 
....................          m4led8[i]=0x7f; 
....................    } 
....................    xuat_4led_7doan_4so(m4led8[4],m4led8[5],m4led8[6],m4led8[7]); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... #include <chuong5_8led_7doan.c>    
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //TAT CA DEU VIET THEO BAI VA HAM THEO BAI  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //Khai bao bien 8led 7 doan 
.................... unsigned int16 tg_delay; 
.................... signed int8 gio=0,phut=0,giay=0,bdn=0,dem_tg_exit=0; 
.................... unsigned int8 led7dq[8]={0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8}; 
.................... unsigned int8 gia_tri_mod; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //Khoi tao ngat timer1 
.................... #int_timer1 
.................... void interrupt_timer1() 
.................... { 
....................    bdn++; 
*
018E:  MOVLB  4
0190:  INCF   xC0,F
....................    set_timer1(3036); 
0192:  MOVLW  0B
0194:  MOVWF  FCF
0196:  MOVLW  DC
0198:  MOVWF  FCE
....................     
019A:  BCF    F9E.0
019C:  MOVLB  0
019E:  GOTO   0054
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Khoi tao timer1 va cho phep ngat timer1  
.................... void khoi_tao_timer1_ngat() 
.................... { 
....................    setup_timer_1(t1_internal| t1_div_by_8); 
*
0666:  MOVLW  B5
0668:  MOVWF  FCD
....................    set_timer1(3036); 
066A:  MOVLW  0B
066C:  MOVWF  FCF
066E:  MOVLW  DC
0670:  MOVWF  FCE
....................    enable_interrupts(global); 
0672:  MOVLW  C0
0674:  IORWF  FF2,F
....................    enable_interrupts(int_timer1); 
0676:  BSF    F9D.0
0678:  GOTO   12E4 (RETURN)
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 501: hien thi 8 led 7doan quet 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_501_hienthi_8so() 
.................... { 
....................   tg_delay=1; 
....................   xuat_8led_7doan_quet_1(0x7f,0xc0);//0 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xbf,0xf9);//1 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xdf,0xa4);//2 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xef,0xb0);//3 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xf7,0x99);//4 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xfb,0x92);//5 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xfd,0x82);//6 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xfe,0xf8);//7 
....................   delay_ms(tg_delay); 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 502: hien thi 8 led 7doan quet 2 so 1 0 ben phai 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_502_hienthi_10() 
.................... { 
....................   tg_delay=1; 
....................   xuat_8led_7doan_quet_1(0x7f,0xc0);//0 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_1(0xbf,0xf9);//1 
....................   delay_ms(tg_delay); 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 503: hien thi 8 led 7doan quet cach 2 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_503_hienthi_8so_cach2() 
.................... { 
....................   tg_delay=1; 
....................   xuat_8led_7doan_quet_2(0,0xc0);//0 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_2(1,0xf9);//1 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_2(2,0xa4);//2 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_2(3,0xb0);//3 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_2(4,0x99);//4 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_2(5,0x92);//5 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_2(6,0x82);//6 
....................   delay_ms(tg_delay); 
....................    
....................   xuat_8led_7doan_quet_2(7,0xf8);//7 
....................   delay_ms(tg_delay); 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 504: hien thi 8 led 7doan quet cach 3 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_504_hien_thi_8led() 
.................... { 
....................    for(i=0;i<8;i++) 
....................   { 
....................    xuat_8led_7doan_quet_2(i,led7dq[i]); 
....................    delay_us(100); 
....................    xuat_8led_7doan_quet_tat_led(); 
....................   } 
.................... } 
.................... void bai_504_hienthi_8so_cach3() 
.................... { 
....................   ham_504_hien_thi_8led(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 511: hien thi 8 led 7doan quet dem giay 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_511_hienthi_delay() 
.................... { 
....................    for(y=0;y<200;y++) 
....................   { 
....................    xuat_8led_7doan_quet_2(0,ma7doan[giay%10]); 
....................    delay_us(200); 
....................    xuat_8led_7doan_quet_tat_led(); 
....................    xuat_8led_7doan_quet_2(1,ma7doan[giay/10]); 
....................    delay_us(200); 
....................    xuat_8led_7doan_quet_tat_led(); 
....................   } 
.................... } 
.................... void bai_511_dem_giay() 
.................... { 
....................   for(giay=0;giay<60;giay++) 
....................    ham_511_hienthi_delay(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 512: hien thi 8 led 7doan quet dem giay chinh xac dung ngat timer1 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_512_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_512_dem_giay_cx() 
.................... { 
....................   ham_512_giai_ma_gan_cho_8led_quet(); 
....................   if(bdn<10) 
....................    hien_thi_8led_7doan_quet(); 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    giay++; 
....................    if(giay==60) 
....................       giay=0; 
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 513 hien thi 8 led 7doan quet dem phut giay chinh xac dung ngat timer1 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_513_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[2]=ma7doan[phut%10]; 
....................    led_7dq[3]=ma7doan[phut/10]; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_513_dem_phut_giay() 
.................... { 
....................   ham_513_giai_ma_gan_cho_8led_quet(); 
....................   if(bdn<10) 
....................    hien_thi_8led_7doan_quet(); 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................          phut=0; 
....................    } 
....................        
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 514 hien thi 8 led 7doan quet dem gio phut giay chinh xac dung ngat timer1 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_514_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[2]=ma7doan[phut%10]; 
....................    led_7dq[3]=ma7doan[phut/10]; 
....................    led_7dq[4]=ma7doan[gio%10]; 
....................    led_7dq[5]=ma7doan[gio/10]; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_514_dem_gio_phut_giay() 
.................... { 
....................   ham_514_giai_ma_gan_cho_8led_quet(); 
....................   if(bdn<10) 
....................    hien_thi_8led_7doan_quet(); 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
....................        
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 515 hien thi 8 led 7doan quet dem gio phut giay chinh xac dung ngat timer1 co phim nhan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_515_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[3]=ma7doan[phut%10]; 
....................    led_7dq[4]=ma7doan[phut/10]; 
....................    led_7dq[6]=ma7doan[gio%10]; 
....................    led_7dq[7]=ma7doan[gio/10]; 
....................    if(gia_tri_mod==1)   led_7dq[6]=led_7dq[6] & 0x7f; 
....................    else if(gia_tri_mod==2)   led_7dq[3]=led_7dq[3] & 0x7f; 
....................    else if(gia_tri_mod==3)   led_7dq[0]=led_7dq[0] & 0x7f; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_515_delay_hienthi() 
.................... { 
....................    for(i=0;i<100;i++) 
....................       hien_thi_8led_7doan_quet(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_515_phim_mod() 
.................... { 
....................    if(!input(mod)) 
....................    { 
....................       ham_515_delay_hienthi(); 
....................       if(!input(mod)) 
....................       { 
....................          gia_tri_mod++; 
....................          if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................          ham_515_giai_ma_gan_cho_8led_quet(); 
....................          do 
....................          { 
....................             hien_thi_8led_7doan_quet(); 
....................          }while(!input(mod)); 
....................       } 
....................        
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_515_phim_up() 
.................... { 
....................    if(!input(up)) 
....................    { 
....................       ham_515_delay_hienthi(); 
....................       if(!input(up)) 
....................       { 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==23) gio=0; 
....................                     else        gio++; 
....................                     break; 
....................             case 2: if(phut==59) phut=0; 
....................                     else         phut++; 
....................                     break; 
....................             case 3: if(giay==59) giay=0; 
....................                     else         giay++;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_515_giai_ma_gan_cho_8led_quet(); 
....................          do 
....................          { 
....................             hien_thi_8led_7doan_quet(); 
....................          }while(!input(up)); 
....................       } 
....................        
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_515_phim_dw() 
.................... { 
....................    if(!input(dw)) 
....................    { 
....................       ham_515_delay_hienthi(); 
....................       if(!input(dw)) 
....................       { 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==0) gio=23; 
....................                     else        gio--; 
....................                     break; 
....................             case 2: if(phut==0) phut=59; 
....................                     else         phut--; 
....................                     break; 
....................             case 3: if(giay==0) giay=59; 
....................                     else         giay--;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_515_giai_ma_gan_cho_8led_quet(); 
....................          do 
....................          { 
....................             hien_thi_8led_7doan_quet(); 
....................          }while(!input(dw)); 
....................       } 
....................        
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_515_dem_gio_phut_giay_key() 
.................... { 
....................   ham_515_giai_ma_gan_cho_8led_quet(); 
....................   if(bdn<10) 
....................   { 
....................    hien_thi_8led_7doan_quet(); 
....................    ham_515_phim_mod(); 
....................    ham_515_phim_up(); 
....................    ham_515_phim_dw(); 
....................     
....................   } 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
....................        
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 516 cai tien 515 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_516_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[3]=ma7doan[phut%10]; 
....................    led_7dq[4]=ma7doan[phut/10]; 
....................    led_7dq[6]=ma7doan[gio%10]; 
....................    led_7dq[7]=ma7doan[gio/10]; 
....................    if(gia_tri_mod==1)   led_7dq[6]=led_7dq[6] & 0x7f; 
....................    else if(gia_tri_mod==2)   led_7dq[3]=led_7dq[3] & 0x7f; 
....................    else if(gia_tri_mod==3)   led_7dq[0]=led_7dq[0] & 0x7f; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_516_phim_mod() 
.................... { 
....................    if(phim_bt1_c2(60)) 
....................    { 
....................          gia_tri_mod++; 
....................          if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................    }  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_516_phim_up() 
.................... { 
....................    if(phim_bt0_c2(60)) 
....................    { 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==23) gio=0; 
....................                     else        gio++; 
....................                     break; 
....................             case 2: if(phut==59) phut=0; 
....................                     else         phut++; 
....................                     break; 
....................             case 3: if(giay==59) giay=0; 
....................                     else         giay++;   
....................                     break; 
....................             default: break;         
....................          } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_516_phim_dw() 
.................... { 
....................    if(phim_bt2_c2(60)) 
....................    { 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==0) gio=23; 
....................                     else        gio--; 
....................                     break; 
....................             case 2: if(phut==0) phut=59; 
....................                     else         phut--; 
....................                     break; 
....................             case 3: if(giay==0) giay=59; 
....................                     else         giay--;   
....................                     break; 
....................             default: break;         
....................          }      
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_516_dem_gio_phut_giay_key_caitien() 
.................... { 
....................   ham_516_giai_ma_gan_cho_8led_quet(); 
....................   if(bdn<10) 
....................   { 
....................    hien_thi_8led_7doan_quet(); 
....................    ham_516_phim_mod(); 
....................    ham_516_phim_up(); 
....................    ham_516_phim_dw(); 
....................     
....................   } 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
....................        
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 517 cai tien 516 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_517_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[3]=ma7doan[phut%10]; 
....................    led_7dq[4]=ma7doan[phut/10]; 
....................    led_7dq[6]=ma7doan[gio%10]; 
....................    led_7dq[7]=ma7doan[gio/10]; 
....................    if(gia_tri_mod==1)   led_7dq[6]=led_7dq[6] & 0x7f; 
....................    else if(gia_tri_mod==2)   led_7dq[3]=led_7dq[3] & 0x7f; 
....................    else if(gia_tri_mod==3)   led_7dq[0]=led_7dq[0] & 0x7f; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_517_tat_2led_chinh() 
.................... { 
....................    if       (gia_tri_mod==1) {led_7dq[7]=0xff; led_7dq[6]=0xff;} 
....................    else if  (gia_tri_mod==2) {led_7dq[4]=0xff; led_7dq[3]=0xff;} 
....................    else if  (gia_tri_mod==3) {led_7dq[1]=0xff; led_7dq[0]=0xff;} 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_517_phim_mod() 
.................... { 
....................    if(phim_bt1_c2(60)) 
....................    { 
....................          gia_tri_mod++; 
....................          if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................          dem_tg_exit=0; 
....................    }  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_517_phim_up() 
.................... { 
....................     
....................    if(phim_bt0_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==23) gio=0; 
....................                     else        gio++; 
....................                     break; 
....................             case 2: if(phut==59) phut=0; 
....................                     else         phut++; 
....................                     break; 
....................             case 3: if(giay==59) giay=0; 
....................                     else         giay++;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_517_giai_ma_gan_cho_8led_quet(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_517_phim_dw() 
.................... { 
....................    if(phim_bt2_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==0) gio=23; 
....................                     else        gio--; 
....................                     break; 
....................             case 2: if(phut==0) phut=59; 
....................                     else         phut--; 
....................                     break; 
....................             case 3: if(giay==0) giay=59; 
....................                     else         giay--;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_517_giai_ma_gan_cho_8led_quet(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_517_dem_gio_phut_giay_key_caitien() 
.................... { 
....................   ham_517_giai_ma_gan_cho_8led_quet(); 
....................   if(bdn<10) 
....................   { 
....................    if(gia_tri_mod!=0) 
....................    { 
....................       if((bdn==0) &&(input(bt0))&&(input(bt2))) 
....................          ham_517_tat_2led_chinh(); 
....................       else if(bdn==5) ham_517_giai_ma_gan_cho_8led_quet(); 
....................    } 
....................    hien_thi_8led_7doan_quet(); 
....................    ham_517_phim_mod(); 
....................    ham_517_phim_up(); 
....................    ham_517_phim_dw(); 
....................     
....................   } 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    dem_tg_exit++; 
....................    if(dem_tg_exit==20) gia_tri_mod=0; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
....................        
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 518 dem xung ngoai dung counter t- hien thi tren 8led quet dem 00-99 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_518_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[t0%10]; 
....................    led_7dq[1]=ma7doan[t0/10]; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_518_phim_on() 
.................... { 
....................    IF(!INPUT(on)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(on)) 
....................       { 
....................          setup_timer_0(t0_ext_l_to_h); 
....................          set_timer0(t0); 
....................          do{}WHILE(!INPUT(on)); 
....................       } 
....................    } 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_518_phim_off() 
.................... { 
....................    IF(!INPUT(off)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(off)) 
....................       { 
....................          setup_timer_0(t0_ext_l_to_h | t0_div_1|T0_OFF); 
....................          set_timer0(t0); 
....................          do{}WHILE(!INPUT(off)); 
....................       } 
....................    } 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_518_phim_clr() 
.................... { 
....................    IF(!INPUT(clr)) 
....................    { 
....................       DELAY_MS(20); 
....................       IF(!INPUT(clr)) 
....................       { 
....................          setup_timer_0(t0_ext_l_to_h); 
....................          set_timer0(0); 
....................       } 
....................    } 
....................    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_518_dem_xung_t0_ssc() 
.................... { 
....................    t0_tam=t0=0; 
....................    ham_518_giai_ma_gan_cho_8led_quet(); 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       ham_518_giai_ma_gan_cho_8led_quet(); 
....................    } 
....................    if(t0==100) 
....................       set_timer0(0); 
....................     hien_thi_8led_7doan_quet(); 
....................     ham_518_phim_on(); 
....................     ham_518_phim_off(); 
....................     ham_518_phim_clr(); 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Bai 521 ket hop 3 module 1 2 3 (ket hop bai 517 voi bai 422) 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_521_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[3]=ma7doan[phut%10]; 
....................    led_7dq[4]=ma7doan[phut/10]; 
....................    led_7dq[6]=ma7doan[gio%10]; 
....................    led_7dq[7]=ma7doan[gio/10]; 
....................    if(gia_tri_mod==1)   led_7dq[6]=led_7dq[6] & 0x7f; 
....................    else if(gia_tri_mod==2)   led_7dq[3]=led_7dq[3] & 0x7f; 
....................    else if(gia_tri_mod==3)   led_7dq[0]=led_7dq[0] & 0x7f; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_521_tat_2led_chinh() 
.................... { 
....................    if       (gia_tri_mod==1) {led_7dq[7]=0xff; led_7dq[6]=0xff;} 
....................    else if  (gia_tri_mod==2) {led_7dq[4]=0xff; led_7dq[3]=0xff;} 
....................    else if  (gia_tri_mod==3) {led_7dq[1]=0xff; led_7dq[0]=0xff;} 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_521_phim_mod() 
.................... { 
....................    if(phim_bt1_c2(60)) 
....................    { 
....................          gia_tri_mod++; 
....................          if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................          dem_tg_exit=0; 
....................    }  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_521_phim_up() 
.................... { 
....................     
....................    if(phim_bt0_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==23) gio=0; 
....................                     else        gio++; 
....................                     break; 
....................             case 2: if(phut==59) phut=0; 
....................                     else         phut++; 
....................                     break; 
....................             case 3: if(giay==59) giay=0; 
....................                     else         giay++;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_521_giai_ma_gan_cho_8led_quet(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_521_phim_dw() 
.................... { 
....................    if(phim_bt2_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==0) gio=23; 
....................                     else        gio--; 
....................                     break; 
....................             case 2: if(phut==0) phut=59; 
....................                     else         phut--; 
....................                     break; 
....................             case 3: if(giay==0) giay=59; 
....................                     else         giay--;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_521_giai_ma_gan_cho_8led_quet(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... void bai_521_3module_123() 
.................... { 
....................    xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    ham_521_giai_ma_gan_cho_8led_quet(); 
....................    if(bdn<10) 
....................   { 
....................    if(gia_tri_mod!=0) 
....................    { 
....................       if((bdn==0) &&(input(bt0))&&(input(bt2))) 
....................          ham_521_tat_2led_chinh(); 
....................       else if(bdn==5) ham_521_giai_ma_gan_cho_8led_quet(); 
....................    } 
....................    hien_thi_8led_7doan_quet(); 
....................    ham_521_phim_mod(); 
....................    ham_521_phim_up(); 
....................    ham_521_phim_dw(); 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       xuat_4led_7doan_giaima_xoa_so0(t0); 
....................       if(t0>=101) set_timer0(1); 
....................    } 
....................    if(ttct_td==1) sang_tat_32led(10,0); 
....................    if(ttct_td==2) sang_tat_dan_pst_32led(10,0); 
....................    if(ttct_td==3) sang_tat_dan_tsp_32led(10,0); 
....................    if(ttct_td==4) sang_tat_dan_ngoai_vao_32led(10,0); 
....................    if(ttct_td==5) sang_tat_dan_trong_ra_32led(10,0); 
....................    if(ttct_td==6) sang_don_pst_32led(10,0); 
....................    if(ttct_td==7) diem_sang_dich_trai_mat_dan_32led(10,0); 
....................    if(ttct_td==8) sang_don_tsp_32led(10,0); 
....................    if(ttct_td==9) diem_sang_dich_phai_mat_dan_32led(10,0); 
....................    if(ttct_td==10) sang_tat_dan_trai_sang_phai_2x16led(10,0); 
....................    if(ttct_td==11) sang_tat_dan_phai_sang_trai_2x16led(10,0); 
....................    if(ttct_td==12) diem_sang_di_chuyen_pst_32led(10,0); 
....................    if(ttct_td==13) diem_sang_di_chuyen_tsp_32led(10,0); 
....................    if(ttct_td==14) sang_don_tnt_32led(10,0); 
....................    if(ttct_td==15) sang_don_ttr_32led(10,0); 
....................    if(ttct_td>15) ttct_td=1; 
....................   } 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    dem_tg_exit++; 
....................    if(dem_tg_exit==20) gia_tri_mod=0; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
....................        
....................   }   
....................     
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
....................  
....................  
....................  
....................  
....................  
....................  
....................  
.................... #include <chuong6_lcd_glcd.c>              
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //TAT CA DEU VIET THEO BAI VA HAM THEO BAI 
.................... #include <graphics.c> 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... ////                          graphics.c                             //// 
.................... ////                                                                 //// 
.................... ////   This file contains functions to draw lines, rectangles, s, //// 
.................... ////   circles and text to a display. A function which draws a       //// 
.................... ////   single pixel must be defined before calling the functions in  //// 
.................... ////   this file. Call it glcd_pixel(x, y, color) where x is the     //// 
.................... ////   horizontal coordinate, y is the vertical coordinate, and      //// 
.................... ////   color is 1 bit to turn the pixel on or off.                   //// 
.................... ////                                                                 //// 
.................... ////   * Note: (0, 0) is treated as the upper left corner            //// 
.................... ////                                                                 //// 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... ////                                                                 //// 
.................... ////  glcd_line(x1, y1, x2, y2, color)                               //// 
.................... ////     * Draws a line from the first point to the second point     //// 
.................... ////       with the given color                                      //// 
.................... ////       - color can be ON or OFF                                  //// 
.................... ////                                                                 //// 
.................... ////  glcd_rect(x1, y1, x2, y2, fill, color)                         //// 
.................... ////     * Draws a rectangle with one corner at point (x1,y1) and    //// 
.................... ////       the other corner at point (x2,y2)                         //// 
.................... ////       - fill can be YES or NO                                   //// 
.................... ////       - color can be ON or OFF                                  //// 
.................... ////                                                                 //// 
.................... ////  glcd_bar(x1, y1, x2, y2, width, color)                         //// 
.................... ////     * Draws a bar (wide line) from the first point to the       //// 
.................... ////       second point                                              //// 
.................... ////       - width is the number of pixels wide                      //// 
.................... ////       - color is ON or OFF                                      //// 
.................... ////                                                                 //// 
.................... ////  glcd_circle(x, y, radius, fill, color)                         //// 
.................... ////     * Draws a circle with center at (x,y)                       //// 
.................... ////       - fill can be YES or NO                                   //// 
.................... ////       - color can be ON or OFF                                  //// 
.................... ////                                                                 //// 
.................... ////  glcd_text57(x, y, textptr, size, color)                        //// 
.................... ////     * Write the null terminated text pointed to by textptr with //// 
.................... ////       the upper left coordinate of the first character at (x,y) //// 
.................... ////       Characters are 5 pixels wide and 7 pixels tall            //// 
.................... ////       - size is an integer that scales the size of the text     //// 
.................... ////       - color is ON or OFF                                      //// 
.................... ////     * Note - This function wraps characters to the next line    //// 
.................... ////              use #define GLCD_WIDTH to specify a display width  //// 
.................... ////                                                                 //// 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... ////        (C) Copyright 1996, 2010 Custom Computer Services        //// 
.................... //// This source code may only be used by licensed users of the CCS  //// 
.................... //// C compiler.  This source code may only be distributed to other  //// 
.................... //// licensed users of the CCS C compiler.  No other use,            //// 
.................... //// reproduction or distribution is permitted without written       //// 
.................... //// permission.  Derivative programs created using this software    //// 
.................... //// in object code form are not restricted in any way.              //// 
.................... ///////////////////////////////////////////////////////////////////////// 
....................  
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... #ifndef GRAPHICS_DRAWING_FUNCTIONS 
.................... #define GRAPHICS_DRAWING_FUNCTIONS 
.................... ///////////////////////////////////////////////////////////////////////// 
....................  
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... #ifndef ON 
.................... #define ON  1 
.................... #endif 
....................  
.................... #ifndef OFF 
.................... #define OFF 0 
.................... #endif 
....................  
.................... #ifndef YES 
.................... #define YES 1 
.................... #endif 
....................  
.................... #ifndef NO 
.................... #define NO  0 
.................... #endif 
.................... ///////////////////////////////////////////////////////////////////////// 
....................  
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... //// Defines a 5x7 font 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... const unsigned int8 FONT[51][5] ={0x00, 0x00, 0x00, 0x00, 0x00, // SPACE 
....................                          0x00, 0x00, 0x5F, 0x00, 0x00, // ! 
....................                          0x00, 0x03, 0x00, 0x03, 0x00, // " 
....................                          0x14, 0x3E, 0x14, 0x3E, 0x14, // # 
....................                          0x24, 0x2A, 0x7F, 0x2A, 0x12, // $ 
....................                          0x43, 0x33, 0x08, 0x66, 0x61, // % 
....................                          0x36, 0x49, 0x55, 0x22, 0x50, // & 
....................                          0x00, 0x05, 0x03, 0x00, 0x00, // ' 
....................                          0x00, 0x1C, 0x22, 0x41, 0x00, // ( 
....................                          0x00, 0x41, 0x22, 0x1C, 0x00, // ) 
....................                          0x14, 0x08, 0x3E, 0x08, 0x14, // * 
....................                          0x08, 0x08, 0x3E, 0x08, 0x08, // + 
....................                          0x00, 0x50, 0x30, 0x00, 0x00, // , 
....................                          0x08, 0x08, 0x08, 0x08, 0x08, // - 
....................                          0x00, 0x60, 0x60, 0x00, 0x00, // . 
....................                          0x20, 0x10, 0x08, 0x04, 0x02, // / 
....................                          0x3E, 0x51, 0x49, 0x45, 0x3E, // 0 
....................                          0x00, 0x04, 0x02, 0x7F, 0x00, // 1 
....................                          0x42, 0x61, 0x51, 0x49, 0x46, // 2 
....................                          0x22, 0x41, 0x49, 0x49, 0x36, // 3 
....................                          0x18, 0x14, 0x12, 0x7F, 0x10, // 4 
....................                          0x27, 0x45, 0x45, 0x45, 0x39, // 5 
....................                          0x3E, 0x49, 0x49, 0x49, 0x32, // 6 
....................                          0x01, 0x01, 0x71, 0x09, 0x07, // 7 
....................                          0x36, 0x49, 0x49, 0x49, 0x36, // 8 
....................                          0x26, 0x49, 0x49, 0x49, 0x3E, // 9 
....................                          0x00, 0x36, 0x36, 0x00, 0x00, // : 
....................                          0x00, 0x56, 0x36, 0x00, 0x00, // ; 
....................                          0x08, 0x14, 0x22, 0x41, 0x00, // < 
....................                          0x14, 0x14, 0x14, 0x14, 0x14, // = 
....................                          0x00, 0x41, 0x22, 0x14, 0x08, // > 
....................                          0x02, 0x01, 0x51, 0x09, 0x06, // ? 
....................                          0x3E, 0x41, 0x59, 0x55, 0x5E, // @ 
....................                          0x7E, 0x09, 0x09, 0x09, 0x7E, // A 
....................                          0x7F, 0x49, 0x49, 0x49, 0x36, // B 
....................                          0x3E, 0x41, 0x41, 0x41, 0x22, // C 
....................                          0x7F, 0x41, 0x41, 0x41, 0x3E, // D 
....................                          0x7F, 0x49, 0x49, 0x49, 0x41, // E 
....................                          0x7F, 0x09, 0x09, 0x09, 0x01, // F 
....................                          0x3E, 0x41, 0x41, 0x49, 0x3A, // G 
....................                          0x7F, 0x08, 0x08, 0x08, 0x7F, // H 
....................                          0x00, 0x41, 0x7F, 0x41, 0x00, // I 
....................                          0x30, 0x40, 0x40, 0x40, 0x3F, // J 
....................                          0x7F, 0x08, 0x14, 0x22, 0x41, // K 
....................                          0x7F, 0x40, 0x40, 0x40, 0x40, // L 
....................                          0x7F, 0x02, 0x0C, 0x02, 0x7F, // M 
....................                          0x7F, 0x02, 0x04, 0x08, 0x7F, // N 
....................                          0x3E, 0x41, 0x41, 0x41, 0x3E, // O 
....................                          0x7F, 0x09, 0x09, 0x09, 0x06, // P 
....................                          0x1E, 0x21, 0x21, 0x21, 0x5E, // Q 
....................                          0x7F, 0x09, 0x09, 0x09, 0x76};// R 
....................  
.................... const unsigned int8 FONT2[44][5]={0x26, 0x49, 0x49, 0x49, 0x32, // S 
....................                          0x01, 0x01, 0x7F, 0x01, 0x01, // T 
....................                          0x3F, 0x40, 0x40, 0x40, 0x3F, // U 
....................                          0x1F, 0x20, 0x40, 0x20, 0x1F, // V 
....................                          0x7F, 0x20, 0x10, 0x20, 0x7F, // W 
....................                          0x41, 0x22, 0x1C, 0x22, 0x41, // X 
....................                          0x07, 0x08, 0x70, 0x08, 0x07, // Y 
....................                          0x61, 0x51, 0x49, 0x45, 0x43, // Z 
....................                          0x00, 0x7F, 0x41, 0x00, 0x00, // [ 
....................                          0x02, 0x04, 0x08, 0x10, 0x20, // \ 
....................                          0x00, 0x00, 0x41, 0x7F, 0x00, // ] 
....................                          0x04, 0x02, 0x01, 0x02, 0x04, // ^ 
....................                          0x40, 0x40, 0x40, 0x40, 0x40, // _ 
....................                          0x00, 0x01, 0x02, 0x04, 0x00, // ` 
....................                          0x20, 0x54, 0x54, 0x54, 0x78, // a 
....................                          0x7F, 0x44, 0x44, 0x44, 0x38, // b 
....................                          0x38, 0x44, 0x44, 0x44, 0x44, // c 
....................                          0x38, 0x44, 0x44, 0x44, 0x7F, // d 
....................                          0x38, 0x54, 0x54, 0x54, 0x18, // e 
....................                          0x04, 0x04, 0x7E, 0x05, 0x05, // f 
....................                          0x08, 0x54, 0x54, 0x54, 0x3C, // g 
....................                          0x7F, 0x08, 0x04, 0x04, 0x78, // h 
....................                          0x00, 0x44, 0x7D, 0x40, 0x00, // i 
....................                          0x20, 0x40, 0x44, 0x3D, 0x00, // j 
....................                          0x7F, 0x10, 0x28, 0x44, 0x00, // k 
....................                          0x00, 0x41, 0x7F, 0x40, 0x00, // l 
....................                          0x7C, 0x04, 0x78, 0x04, 0x78, // m 
....................                          0x7C, 0x08, 0x04, 0x04, 0x78, // n 
....................                          0x38, 0x44, 0x44, 0x44, 0x38, // o 
....................                          0x7C, 0x14, 0x14, 0x14, 0x08, // p 
....................                          0x08, 0x14, 0x14, 0x14, 0x7C, // q 
....................                          0x00, 0x7C, 0x08, 0x04, 0x04, // r 
....................                          0x48, 0x54, 0x54, 0x54, 0x20, // s 
....................                          0x04, 0x04, 0x3F, 0x44, 0x44, // t 
....................                          0x3C, 0x40, 0x40, 0x20, 0x7C, // u 
....................                          0x1C, 0x20, 0x40, 0x20, 0x1C, // v 
....................                          0x3C, 0x40, 0x30, 0x40, 0x3C, // w 
....................                          0x44, 0x28, 0x10, 0x28, 0x44, // x 
....................                          0x0C, 0x50, 0x50, 0x50, 0x3C, // y 
....................                          0x44, 0x64, 0x54, 0x4C, 0x44, // z 
....................                          0x00, 0x08, 0x36, 0x41, 0x41, // { 
....................                          0x00, 0x00, 0x7F, 0x00, 0x00, // | 
....................                          0x41, 0x41, 0x36, 0x08, 0x00, // } 
....................                          0x02, 0x01, 0x02, 0x04, 0x02};// ~ 
.................... ///////////////////////////////////////////////////////////////////////// 
....................  
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... // Purpose:       Draw a line on a graphic LCD using Bresenham's 
.................... //                line drawing algorithm 
.................... // Inputs:        (x1, y1) - the start coordinate 
.................... //                (x2, y2) - the end coordinate 
.................... //                color - ON or OFF 
.................... // Dependencies:  glcd_pixel() 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... #ifdef LARGE_LCD 
.................... void glcd_line(unsigned int16 x1, unsigned int16 y1, unsigned int16 x2, iunsigned nt16 y2, int1 color) 
.................... #else 
.................... void glcd_line(unsigned int8 x1, unsigned int8 y1, unsigned int8 x2, unsigned int8 y2, int1 color) 
.................... #endif 
.................... { 
....................    unsigned int16        dy, dx; 
....................    signed int8  addx=1, addy=1; 
....................    signed int16 P, diff; 
....................  
....................    #ifdef LARGE_LCD 
....................    unsigned int16 i=0; 
....................    dx = abs((signed int16)(x2 - x1)); 
....................    dy = abs((signed int16)(y2 - y1)); 
....................    #else 
....................    unsigned int8 i=0; 
....................    dx = abs((signed int8)(x2 - x1)); 
....................    dy = abs((signed int8)(y2 - y1)); 
....................    #endif 
....................  
....................    if(x1 > x2) 
....................       addx = -1; 
....................    if(y1 > y2) 
....................       addy = -1; 
....................  
....................    if(dx >= dy) 
....................    { 
....................       dy *= 2; 
....................       P = dy - dx; 
....................       diff = P - dx; 
....................  
....................       for(; i<=dx; ++i) 
....................       { 
....................          glcd_pixel(x1, y1, color); 
....................  
....................          if(P < 0) 
....................          { 
....................             P  += dy; 
....................             x1 += addx; 
....................          } 
....................          else 
....................          { 
....................             P  += diff; 
....................             x1 += addx; 
....................             y1 += addy; 
....................          } 
....................       } 
....................    } 
....................    else 
....................    { 
....................       dx *= 2; 
....................       P = dx - dy; 
....................       diff = P - dy; 
....................  
....................       for(; i<=dy; ++i) 
....................       { 
....................          glcd_pixel(x1, y1, color); 
....................  
....................          if(P < 0) 
....................          { 
....................             P  += dx; 
....................             y1 += addy; 
....................          } 
....................          else 
....................          { 
....................             P  += diff; 
....................             x1 += addx; 
....................             y1 += addy; 
....................          } 
....................       } 
....................    } 
.................... } 
....................  
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... // Purpose:       Draw a rectangle on a graphic LCD 
.................... // Inputs:        (x1, y1) - the start coordinate 
.................... //                (x2, y2) - the end coordinate 
.................... //                fill  - YES or NO 
.................... //                color - ON or OFF 
.................... // Dependencies:  glcd_pixel(), glcd_line() 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... #ifdef LARGE_LCD 
.................... void glcd_rect(unsigned int16 x1, unsigned int16 y1, unsigned int16 x2, unsigned int16 y2, int1 fill, int1 color) 
.................... #else 
.................... void glcd_rect(unsigned int8 x1, unsigned int8 y1, unsigned int8 x2, unsigned int8 y2, int1 fill, int1 color) 
.................... #endif 
.................... { 
....................    if(fill) 
....................    { 
....................       #ifdef LARGE_LCD 
....................       unsigned int16 i, xmin, xmax, ymin, ymax; 
....................       #else 
....................       unsigned int8  i, xmin, xmax, ymin, ymax; 
....................       #endif 
....................  
....................       if(x1 < x2)                            //  Find x min and max 
....................       { 
....................          xmin = x1; 
....................          xmax = x2; 
....................       } 
....................       else 
....................       { 
....................          xmin = x2; 
....................          xmax = x1; 
....................       } 
....................  
....................       if(y1 < y2)                            // Find the y min and max 
....................       { 
....................          ymin = y1; 
....................          ymax = y2; 
....................       } 
....................       else 
....................       { 
....................          ymin = y2; 
....................          ymax = y1; 
....................       } 
....................  
....................       for(; xmin <= xmax; ++xmin) 
....................       { 
....................          for(i=ymin; i<=ymax; ++i) 
....................          { 
....................             glcd_pixel(xmin, i, color); 
....................          } 
....................       } 
....................    } 
....................    else 
....................    { 
....................       glcd_line(x1, y1, x2, y1, color);      // Draw the 4 sides 
....................       glcd_line(x1, y2, x2, y2, color); 
....................       glcd_line(x1, y1, x1, y2, color); 
....................       glcd_line(x2, y1, x2, y2, color); 
....................    } 
.................... } 
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... // Purpose:       Draw a bar (wide line) on a graphic LCD 
.................... // Inputs:        (x1, y1) - the start coordinate 
.................... //                (x2, y2) - the end coordinate 
.................... //                width  - The number of pixels wide 
.................... //                color - ON or OFF 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... #ifdef LARGE_LCD 
.................... void glcd_bar(unsigned int16 x1, unsigned int16 y1, unsigned int16 x2, unsigned int16 y2, unsigned int8 width, int1 color) 
.................... #else 
.................... void glcd_bar(unsigned int8 x1, unsigned int8 y1, unsigned int8 x2, unsigned int8 y2, unsigned int8 width, int1 color) 
.................... #endif 
.................... { 
....................    unsigned int8         half_width; 
....................    signed int16 dy, dx; 
....................    signed int8  addx=1, addy=1, j; 
....................    signed int16 P, diff, c1, c2; 
....................  
....................    #ifdef LARGE_LCD 
....................    unsigned int16 i=0; 
....................    dx = abs((signed int16)(x2 - x1)); 
....................    dy = abs((signed int16)(y2 - y1)); 
....................    #else 
....................    unsigned int8 i=0; 
....................    dx = abs((signed int8)(x2 - x1)); 
....................    dy = abs((signed int8)(y2 - y1)); 
....................    #endif 
....................  
....................    half_width = width/2; 
....................    c1 = -(dx*x1 + dy*y1); 
....................    c2 = -(dx*x2 + dy*y2); 
....................  
....................    if(x1 > x2) 
....................    { 
....................       signed int16 temp; 
....................       temp = c1; 
....................       c1 = c2; 
....................       c2 = temp; 
....................       addx = -1; 
....................    } 
....................    if(y1 > y2) 
....................    { 
....................       signed int16 temp; 
....................       temp = c1; 
....................       c1 = c2; 
....................       c2 = temp; 
....................       addy = -1; 
....................    } 
....................  
....................    if(dx >= dy) 
....................    { 
....................       P = 2*dy - dx; 
....................       diff = P - dx; 
....................  
....................       for(i=0; i<=dx; ++i) 
....................       { 
....................          for(j=-half_width; j<half_width+width%2; ++j) 
....................          { 
....................                glcd_pixel(x1, y1+j, color); 
....................          } 
....................          if(P < 0) 
....................          { 
....................             P  += 2*dy; 
....................             x1 += addx; 
....................          } 
....................          else 
....................          { 
....................             P  += diff; 
....................             x1 += addx; 
....................             y1 += addy; 
....................          } 
....................       } 
....................    } 
....................    else 
....................    { 
....................       P = 2*dx - dy; 
....................       diff = P - dy; 
....................  
....................       for(i=0; i<=dy; ++i) 
....................       { 
....................          if(P < 0) 
....................          { 
....................             P  += 2*dx; 
....................             y1 += addy; 
....................          } 
....................          else 
....................          { 
....................             P  += diff; 
....................             x1 += addx; 
....................             y1 += addy; 
....................          } 
....................          for(j=-half_width; j<half_width+width%2; ++j) 
....................          { 
....................                glcd_pixel(x1+j, y1, color); 
....................          } 
....................       } 
....................    } 
.................... } 
....................  
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... // Purpose:       Draw a circle on a graphic LCD 
.................... // Inputs:        (x,y) - the center of the circle 
.................... //                radius - the radius of the circle 
.................... //                fill - YES or NO 
.................... //                color - ON or OFF 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... #ifdef LARGE_LCD 
.................... void glcd_circle(unsigned int16 x, unsigned int16 y, unsigned int16 radius, int1 fill, int1 color) 
.................... #else 
.................... void glcd_circle(unsigned int8 x, unsigned int8 y, unsigned int8 radius, int1 fill, int1 color) 
.................... #endif 
.................... { 
....................    #ifdef LARGE_LCD 
....................    signed int16 a, b, P; 
....................    #else 
....................    signed int8  a, b, P; 
....................    #endif 
....................  
....................    a = 0; 
....................    b = radius; 
....................    P = 1 - radius; 
....................  
....................    do 
....................    { 
....................       if(fill) 
....................       { 
....................          glcd_line(x-a, y+b, x+a, y+b, color); 
....................          glcd_line(x-a, y-b, x+a, y-b, color); 
....................          glcd_line(x-b, y+a, x+b, y+a, color); 
....................          glcd_line(x-b, y-a, x+b, y-a, color); 
....................       } 
....................       else 
....................       { 
....................          glcd_pixel(a+x, b+y, color); 
....................          glcd_pixel(b+x, a+y, color); 
....................          glcd_pixel(x-a, b+y, color); 
....................          glcd_pixel(x-b, a+y, color); 
....................          glcd_pixel(b+x, y-a, color); 
....................          glcd_pixel(a+x, y-b, color); 
....................          glcd_pixel(x-a, y-b, color); 
....................          glcd_pixel(x-b, y-a, color); 
....................       } 
....................  
....................       if(P < 0) 
....................          P += 3 + 2 * a++; 
....................       else 
....................          P += 5 + 2 * (a++ - b--); 
....................     } while(a <= b); 
.................... } 
....................  
....................  
.................... ///////////////////////////////////////////////////////////////////////// 
.................... // Purpose:       Write text on a graphic LCD 
.................... // Inputs:        (x,y) - The upper left coordinate of the first letter 
.................... //                textptr - A pointer to an array of text to display 
.................... //                size - The size of the text: 1 = 5x7, 2 = 10x14, ... 
.................... //                color - ON or OFF 
.................... ///////////////////////////////////////////////////////////////////////// 
.................... #ifdef LARGE_LCD 
.................... void glcd_text57(unsigned int16 x, unsigned int16 y, char* textptr, unsigned int8 size, int1 color) 
.................... #else 
.................... void glcd_text57(unsigned int8 x, unsigned int8 y, char* textptr, unsigned int8 size, int1 color) 
.................... #endif 
.................... { 
....................    unsigned int8 j, k, l, m;                       // Loop counters 
....................    unsigned int8 pixelData[5];                     // Stores character data 
....................  
....................    for(; *textptr != '\0'; ++textptr, ++x)// Loop through the passed string 
....................    { 
....................       if(*textptr < 'S') // Checks if the letter is in the first font array 
....................          memcpy(pixelData, FONT[*textptr - ' '], 5); 
....................       else if(*textptr <= '~') // Check if the letter is in the second font array 
....................          memcpy(pixelData, FONT2[*textptr - 'S'], 5); 
....................       else 
....................          memcpy(pixelData, FONT[0], 5);   // Default to space 
....................  
....................       // Handles newline and carriage returns 
....................       switch(*textptr) 
....................       { 
....................          case '\n': 
....................             y += 7*size + 1; 
....................             continue; 
....................          case '\r': 
....................             x = 0; 
....................             continue; 
....................       } 
....................  
....................       if(x+5*size >= GLCD_WIDTH)          // Performs character wrapping 
....................       { 
....................          x = 0;                           // Set x at far left position 
....................          y += 7*size + 1;                 // Set y at next position down 
....................       } 
....................       for(j=0; j<5; ++j, x+=size)         // Loop through character byte data 
....................       { 
....................          for(k=0; k < 7; ++k)             // Loop through the vertical pixels 
....................          { 
....................             if(bit_test(pixelData[j], k)) // Check if the pixel should be set 
....................             { 
....................                for(l=0; l < size; ++l)    // These two loops change the 
....................                {                          // character's size 
....................                   for(m=0; m < size; ++m) 
....................                   { 
....................                      glcd_pixel(x+m, y+k*size+l, color); // Draws the pixel 
....................                   } 
....................                } 
....................             } 
....................          } 
....................       } 
....................    } 
.................... } 
....................  
.................... #endif 
....................  
.................... #include <math.h> 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... ////        (C) Copyright 1996,2011 Custom Computer Services            //// 
.................... //// This source code may only be used by licensed users of the CCS C   //// 
.................... //// compiler.  This source code may only be distributed to other       //// 
.................... //// licensed users of the CCS C compiler.  No other use, reproduction  //// 
.................... //// or distribution is permitted without written permission.           //// 
.................... //// Derivative programs created using this software in object code     //// 
.................... //// form are not restricted in any way.                                //// 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... ////                                                                    //// 
.................... //// History:                                                           //// 
.................... ////  * 9/20/2001 :  Improvments are made to sin/cos code.              //// 
.................... ////                 The code now is small, much faster,                //// 
.................... ////                 and more accurate.                                 //// 
.................... ////  * 2/21/2007 :  Compiler handles & operator differently and does   //// 
.................... ////                 not return generic (int8 *) so type cast is done   //// 
.................... ////  * 6/19/2010 :  Divisions by constants converted to multiplication //// 
.................... ////                 by its inverse to improve computation speed        //// 
.................... ////  * 1/21/2011 :  Constants used for double precision math updated   //// 
.................... ////                 Updated routines include 64 bit versions of cos,   //// 
.................... ////                 asin,atan,exp,log and dependant functions          //// 
.................... ////  * 1/31/2011 :  Optimized current 32-bit float routines for cos    //// 
.................... ////                 and log function                                   //// 
.................... ////  * 6/13/2011 :  Fixed PCD overload CEIL_FLOOR functions for values //// 
.................... ////                 greater then 10000000 and less then -10000000      //// 
.................... ////                                                                    //// 
.................... //////////////////////////////////////////////////////////////////////////// 
....................  
.................... #ifndef MATH_H 
.................... #define MATH_H 
....................  
.................... #ifdef PI 
.................... #undef  PI 
.................... #endif 
.................... #define PI     3.1415926535897932 
....................  
....................  
.................... #define SQRT2  1.4142135623730950 
....................  
.................... //float const ps[4] = {5.9304945, 21.125224, 8.9403076, 0.29730279}; 
.................... //float const qs[4] = {1.0000000, 15.035723, 17.764134, 2.4934718}; 
....................  
.................... ///////////////////////////// Round Functions ////////////////////////////// 
....................  
.................... float32 CEIL_FLOOR(float32 x, unsigned int8 n) 
.................... { 
....................    float32 y, res; 
....................    unsigned int16 l; 
....................    int1 s; 
....................  
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y <= 32768.0) 
....................       res = (float32)(unsigned int16)y; 
....................  
....................  else if (y < 10000000.0) 
....................    {  
....................       l = (unsigned int16)(y*0.000030517578125); 
....................       y = 32768.0*(y*0.000030517578125 - (float32)l); 
....................       res = 32768.0*(float32)l; 
....................       res += (float32)(unsigned int16)y; 
....................    } 
....................  
....................  else 
....................   res = y; 
....................  
....................  y = y - (float32)(unsigned int16)y; 
....................  
....................  if (s) 
....................   res = -res; 
....................  
....................  if (y != 0) 
....................  { 
....................   if (s == 1 && n == 0) 
....................    res -= 1.0; 
....................  
....................   if (s == 0 && n == 1) 
....................    res += 1.0; 
....................  } 
....................  if (x == 0) 
....................     res = 0; 
....................  
....................  return (res); 
.................... } 
....................  
.................... // Overloaded Functions to take care for new Data types in PCD 
.................... // Overloaded function CEIL_FLOOR() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 CEIL_FLOOR(float48 x, unsigned int8 n) 
.................... { 
....................    float48 y, res; 
....................    unsigned int32 l; 
....................    int1 s; 
....................  
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y <= 32768.0) 
....................       res = (float48)(unsigned int16)y; 
....................  
....................    else if (y < 549755813888.0) 
....................    { 
....................       l = (unsigned int32)(y*0.000030517578125); 
....................       y = 32768.0*(y*0.000030517578125 - (float48)l); 
....................       res = 32768.0*(float48)l; 
....................       res += (float48)(unsigned int16)y; 
....................    } 
....................    else 
....................    {   
....................       res = y; 
....................       y = 0.0; 
....................    } 
....................     
....................    if(y != 0) 
....................       y = y - (float48)(unsigned int16)y; 
....................  
....................    if (s) 
....................       res = -res; 
....................  
....................    if (y != 0) 
....................    { 
....................       if (s == 1 && n == 0) 
....................          res -= 1.0; 
....................  
....................       if (s == 0 && n == 1) 
....................          res += 1.0; 
....................    } 
....................    if (x == 0) 
....................       res = 0; 
....................  
....................    return (res); 
.................... } 
....................  
....................  
.................... // Overloaded function CEIL_FLOOR() for data type - Float64 
.................... float64 CEIL_FLOOR(float64 x, unsigned int8 n) 
.................... { 
....................    float64 y, res; 
....................    int64 l; 
....................    int1 s; 
....................  
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y <= 32768.0) 
....................       res = (float64)(unsigned int16)y; 
....................    else if (y < 4503599627370496.0) 
....................    { 
....................       l = (int64)(y*0.000030517578125); 
....................       y = 32768.0*(y*0.000030517578125 - (float64)l); 
....................       res = 32768.0*(float64)l; 
....................       res += (float64)(unsigned int16)y; 
....................    } 
....................    else 
....................    { 
....................       res = y; 
....................       y = 0.0; 
....................    } 
....................     
....................    if(y != 0) 
....................       y = y - (float64)(unsigned int16)y; 
....................  
....................    if (s) 
....................       res = -res; 
....................  
....................    if (y != 0) 
....................    { 
....................       if (s == 1 && n == 0) 
....................          res -= 1.0; 
....................  
....................       if (s == 0 && n == 1) 
....................          res += 1.0; 
....................    } 
....................     
....................    if (x == 0) 
....................       res = 0; 
....................  
....................    return (res); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float floor(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : rounds down the number x. 
.................... // Date : N/A 
.................... // 
.................... float32 floor(float32 x) 
.................... { 
....................    return CEIL_FLOOR(x,0); 
.................... } 
.................... // Following 2 functions are overloaded functions of floor() for PCD 
.................... // Overloaded function floor() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 floor(float48 x) 
.................... { 
....................    return CEIL_FLOOR(x, 0); 
.................... } 
....................  
.................... // Overloaded function floor() for data type - Float64 
.................... float64 floor(float64 x) 
.................... { 
....................    return CEIL_FLOOR(x, 0); 
.................... } 
.................... #endif 
....................  
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float ceil(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : rounds up the number x. 
.................... // Date : N/A 
.................... // 
.................... float32 ceil(float32 x) 
.................... { 
....................    return CEIL_FLOOR(x, 1); 
.................... } 
.................... // Following 2 functions are overloaded functions of ceil() for PCD 
.................... // Overloaded function ceil() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 ceil(float48 x) 
.................... { 
....................    return CEIL_FLOOR(x, 1); 
.................... } 
....................  
.................... // Overloaded function ceil() for data type - Float64 
.................... float64 ceil(float64 x) 
.................... { 
....................    return CEIL_FLOOR(x, 1); 
.................... } 
.................... #endif 
....................  
....................  //////////////////////////////////////////////////////////////////////////// 
.................... //   float fabs(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : Computes the absolute value of floating point number x 
.................... // Returns : returns the absolute value of x 
.................... // Date : N/A 
.................... // 
.................... #define fabs abs 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float fmod(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : Computes the floating point remainder of x/y 
.................... // Returns : returns the value of x= i*y, for some integer i such that, if y 
.................... // is non zero, the result has the same isgn of x na dmagnitude less than the 
.................... // magnitude of y. If y is zero then a domain error occurs. 
.................... // Date : N/A 
.................... // 
....................  
.................... float fmod(float32 x,float32 y) 
.................... { 
....................    float32 i; 
....................    if (y!=0.0) 
....................    { 
....................       i=(x/y < 0.0)? ceil(x/y): floor(x/y); 
....................       return(x-(i*y)); 
....................    } 
....................    else 
....................    { 
....................    #ifdef _ERRNO 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................    } 
.................... } 
.................... //Overloaded function for fmod() for PCD 
.................... // Overloaded function fmod() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 fmod(float48 x,float48 y) 
.................... { 
....................    float48 i; 
....................    if (y!=0.0) 
....................    { 
....................       i=(x/y < 0.0)? ceil(x/y): floor(x/y); 
....................       return(x-(i*y)); 
....................    } 
....................    else 
....................    { 
....................    #ifdef _ERRNO 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................    } 
.................... } 
.................... // Overloaded function fmod() for data type - Float64 
.................... float64 fmod(float64 x,float64 y) 
.................... { 
....................    float64 i; 
....................    if (y!=0.0) 
....................    { 
....................       i=(x/y < 0.0)? ceil(x/y): floor(x/y); 
....................       return(x-(i*y)); 
....................    } 
....................    else 
....................    { 
....................    #ifdef _ERRNO 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................    } 
.................... } 
.................... #endif 
.................... //////////////////// Exponential and logarithmic functions //////////////////// 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float exp(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the value (e^x) 
.................... // Date : N/A 
.................... // 
.................... #define LN2 0.6931471805599453 
.................... #define LN2_INV 1.4426950408889634073 
....................  
.................... float const pe[6] = {0.000207455774, 0.00127100575, 0.00965065093, 
....................                      0.0554965651,  0.240227138,  0.693147172}; 
....................  
....................  
.................... float32 exp(float32 x) 
.................... { 
....................    float32 y, res, r; 
....................    #if defined(__PCD__) 
....................    int8 data1; 
....................    #endif 
....................    signed int8 n; 
....................    int1 s; 
....................    #ifdef _ERRNO 
....................    if(x > 88.722838) 
....................    { 
....................       errno=ERANGE; 
....................       return(0); 
....................    } 
....................    #endif 
....................    n = (signed int16)(x*LN2_INV); 
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       n = -n; 
....................       y = -y; 
....................    } 
....................  
....................    res = 0.0; 
.................... #if !defined(__PCD__) 
....................    *((unsigned int8 *)(&res)) = n + 0x7F; 
.................... #endif 
....................  
.................... #if defined(__PCD__)  // Takes care of IEEE format for PCD 
....................    data1 = n+0x7F; 
....................    if(bit_test(data1,0)) 
....................    bit_set(*(((unsigned int8 *)(&res)+2)),7); 
....................    rotate_right(&data1,1); 
....................    bit_clear(data1,7); 
....................    *(((unsigned int8 *)(&res)+3)) = data1; 
.................... #endif 
....................  
....................    y = y*LN2_INV - (float32)n; 
....................  
....................    r = pe[0]*y + pe[1]; 
....................    r = r*y + pe[2]; 
....................    r = r*y + pe[3]; 
....................    r = r*y + pe[4]; 
....................    r = r*y + pe[5]; 
....................  
....................    res = res*(1.0 + y*r); 
....................  
....................    if (s) 
....................       res = 1.0/res; 
....................    return(res); 
.................... } 
....................  
....................  
.................... //Overloaded function for exp() for PCD 
.................... // Overloaded function exp() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 exp(float48 x) 
.................... { 
....................    float48 y, res, r; 
....................    int8 data1; 
....................    signed int8 n; 
....................    int1 s; 
....................    #ifdef _ERRNO 
....................    if(x > 88.722838) 
....................    { 
....................       errno=ERANGE; 
....................       return(0); 
....................    } 
....................    #endif 
....................    n = (signed int16)(x*LN2_INV); 
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       n = -n; 
....................       y = -y; 
....................    } 
....................  
....................    res = 0.0; 
....................  
....................    data1 = n+0x7F; 
....................    if(bit_test(data1,0)) 
....................    bit_set(*(((unsigned int8 *)(&res)+4)),7); 
....................    rotate_right(&data1,1); 
....................    bit_clear(data1,7); 
....................    *(((unsigned int8 *)(&res)+5)) = data1; 
....................  
....................    y = y*LN2_INV - (float48)n; 
....................  
....................    r = pe[0]*y + pe[1]; 
....................    r = r*y + pe[2]; 
....................    r = r*y + pe[3]; 
....................    r = r*y + pe[4]; 
....................    r = r*y + pe[5]; 
....................  
....................    res = res*(1.0 + y*r); 
....................  
....................    if (s) 
....................       res = 1.0/res; 
....................    return(res); 
.................... } 
....................  
.................... // Overloaded function exp() for data type - Float64 
.................... float64 const pe_64[12] ={9.30741400474913e-011,-4.28655416283316e-011, 
....................                           8.71486547014137e-009,9.84458531538385e-008, 
....................                           1.32588296983536e-006,1.52489283823016e-005, 
....................                           0.000154037598423921,0.00133335487036216, 
....................                           0.00961812936407326,0.0555041086222122, 
....................                           0.240226506962827,0.693147180559823}; 
....................  
.................... float64 exp(float64 x) 
.................... { 
....................    float64 y, res, r; 
....................    unsigned int16 data1, data2; 
....................    unsigned int16 *p; 
....................    signed int16 n; 
....................    int1 s; 
....................    #ifdef _ERRNO 
....................    if(x > 709.7827128) 
....................    { 
....................       errno=ERANGE; 
....................       return(0); 
....................    } 
....................    #endif 
....................    y = x*LN2_INV; 
....................    n = (signed int16)y; 
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       n = -n; 
....................       y = -y; 
....................    } 
....................  
....................    res = 0.0; 
....................  
.................... #if !defined(__PCD__) 
....................    *((unsigned int16 *)(&res)) = n + 0x7F; 
.................... #endif 
....................    p= (((unsigned int16 *)(&res))+3); 
....................    data1 = *p; 
....................    data2 = *p;    
....................    data1 = n + 0x3FF; 
....................    data1 = data1 <<4; 
....................    if(bit_test(data2,15)) 
....................    bit_set(data1,15); 
....................    data2 = data2 & 0x000F; 
....................    data1 ^= data2; 
....................  
....................    *(((unsigned int16 *)(&res)+3)) = data1; 
....................  
....................  
....................    y = y*LN2_INV - (float64)n; 
....................  
....................    r = pe_64[0]*y + pe_64[1]; 
....................    r = r*y + pe_64[2]; 
....................    r = r*y + pe_64[3]; 
....................    r = r*y + pe_64[4]; 
....................    r = r*y + pe_64[5]; 
....................    r = r*y + pe_64[6]; 
....................    r = r*y + pe_64[7]; 
....................    r = r*y + pe_64[8]; 
....................    r = r*y + pe_64[9]; 
....................    r = r*y + pe_64[10]; 
....................    r = r*y + pe_64[11]; 
....................     
....................    res = res*(1.0 + y*r); 
....................  
....................    if (s) 
....................       res = 1.0/res; 
....................    return(res); 
.................... } 
.................... #ENDIF 
....................  
....................  
.................... /************************************************************/ 
....................  
.................... float32 const pl[4] = {-1.080310025160955, 1.999999947089217}; 
.................... float32 const ql[4] = {0.091284365719509, -0.873491916557671}; 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float log(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the the natural log of x 
.................... // Date : N/A 
.................... // 
.................... float32 log(float32 x) 
.................... { 
....................    float32 y, res, r, y2; 
....................    #if defined(__PCD__) 
....................    unsigned int8  data1,data2; 
....................    #endif 
....................    signed int8 n; 
....................    #ifdef _ERRNO 
....................    if(x <0) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    if(x ==0) 
....................    { 
....................       errno=ERANGE; 
....................       return(0); 
....................    } 
....................    #endif 
....................    y = x; 
....................  
....................    if (y != 1.0) 
....................    { 
.................... #if !defined(__PCD__) 
....................     *((unsigned int8 *)(&y)) = 0x7E;  
.................... #endif 
....................  
.................... #if defined(__PCD__) // Takes care of IEEE format 
....................    data2 = *(((unsigned int8 *)(&y))+3); 
....................    *(((unsigned int8 *)(&y))+3) = 0x3F; 
....................    data1 = *(((unsigned int8 *)(&y))+2); 
....................    bit_clear(data1,7); 
....................    *(((unsigned int8 *)(&y))+2) = data1; 
....................    if(bit_test(data2,7)) 
....................      bit_set(*(((unsigned int8 *)(&y))+3),7); 
.................... #endif 
....................  
....................       y = (y - 1.0)/(y + 1.0); 
....................  
....................       y2=y*y; 
....................  
....................       res = pl[0]*y2 + pl[1]; 
....................  
....................       r = ql[0]*y2 + ql[1]; 
....................       r = r*y2 + 1.0; 
....................  
....................       res = y*res/r; 
.................... #if !defined(__PCD__) 
....................       n = *((unsigned int8 *)(&x)) - 0x7E; 
.................... #endif 
.................... #if defined(__PCD__)  
....................     data1 = *(((unsigned int8 *)(&x)+3)); 
....................     rotate_left(&data1,1); 
....................     data2 = *(((unsigned int8 *)(&x)+2)); 
....................     if(bit_test (data2,7)) 
....................       bit_set(data1,0); 
....................     n = data1 - 0x7E; 
.................... #endif 
....................  
....................       if (n<0)  
....................          r = -(float32)-n; 
....................       else 
....................          r = (float32)n; 
....................  
....................       res += r*LN2; 
....................    } 
....................  
....................    else 
....................       res = 0.0; 
....................  
....................    return(res); 
.................... } 
....................  
.................... //Overloaded function for log() for PCD 
.................... // Overloaded function log() for data type - Float48 
.................... #if defined(__PCD__) 
.................... // Overloaded function log() for data type - float64 
.................... float64 const pl_64[4] = {-0.145694052150681, 1.365485300000370, 
....................                           -3.120535668274329, 2.000000000000000}; 
....................  
.................... float64 const ql_64[4] = {0.006047500465908, -0.208298281937234, 
....................                           1.113943039156721, -1.893601167470470}; 
....................  
.................... float48 log(float48 x) 
.................... { 
....................    float48 y, res, r, y2; 
....................    unsigned int8  data1,data2; 
....................    signed int8 n; 
.................... #ifdef _ERRNO 
....................    if(x <0) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    if(x ==0) 
....................    { 
....................       errno=ERANGE; 
....................       return(0); 
....................    } 
.................... #endif 
....................    y = x; 
....................  
....................    if (y != 1.0) 
....................    { 
....................  
.................... #if !defined(__PCD__) 
....................       *((unsigned int8 *)(&y)) = 0x7E;  
.................... #endif 
....................       data2 = *(((unsigned int8 *)(&y))+5); 
....................       *(((unsigned int8 *)(&y))+5) = 0x3F; 
....................       data1 = *(((unsigned int8 *)(&y))+4); 
....................       bit_clear(data1,7); 
....................       *(((unsigned int8 *)(&y))+4) = data1; 
....................  
....................       if(bit_test(data2,7)) 
....................       bit_set(*(((unsigned int8 *)(&y))+4),7); 
....................       y = (y - 1.0)/(y + 1.0); 
....................  
....................       y2=y*y; 
....................  
....................       res = pl_64[0]*y2 + pl_64[1]; 
....................       res = res*y2 + pl_64[2]; 
....................       res = res*y2 + pl_64[3]; 
....................  
....................       r = ql_64[0]*y2 + ql_64[1]; 
....................       r = r*y2 + ql_64[2]; 
....................       r = r*y2 + ql_64[3]; 
....................       r = r*y2 + 1.0;  
....................       res = y*res/r; 
....................  
....................       data1 = *(((unsigned int8 *)(&x)+5)); 
....................       rotate_left(&data1,1); 
....................       data2 = *(((unsigned int8 *)(&x)+4)); 
....................       if(bit_test (data2,7)) 
....................       bit_set(data1,0); 
....................        
....................       n = data1 - 0x7E; 
....................  
....................       if (n<0) 
....................       r = -(float48)-n; 
....................       else 
....................       r = (float48)n; 
....................  
....................       res += r*LN2; 
....................    } 
....................  
....................    else 
....................    res = 0.0; 
....................  
....................    return(res); 
.................... } 
....................  
.................... float64 log(float64 x) 
.................... { 
....................    float64 y, res, r, y2; 
....................    unsigned int16  data1,data2; 
....................    unsigned int16 *p; 
....................    signed int16 n; 
....................    #ifdef _ERRNO 
....................    if(x <0) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    if(x ==0) 
....................    { 
....................       errno=ERANGE; 
....................       return(0); 
....................    } 
....................    #endif 
....................    y = x; 
....................  
....................    if (y != 1.0) 
....................    { 
....................    #if !defined(__PCD__) 
....................        *((unsigned int8 *)(&y)) = 0x7E;  
....................    #endif 
....................       p= (((unsigned int16 *)(&y))+3); 
....................       data1 = *p; 
....................       data2 = *p; 
....................       data1 = 0x3FE; 
....................       data1 = data1 <<4; 
....................       if(bit_test (data2,15)) 
....................          bit_set(data1,15); 
....................       data2 = data2 & 0x000F; 
....................       data1 ^=data2; 
....................  
....................       *p = data1; 
....................  
....................       y = (y - 1.0)/(y + 1.0); 
....................  
....................       y2=y*y; 
....................  
....................       res = pl_64[0]*y2 + pl_64[1]; 
....................       res = res*y2 + pl_64[2]; 
....................       res = res*y2 + pl_64[3]; 
....................  
....................       r = ql_64[0]*y2 + ql_64[1]; 
....................       r = r*y2 + ql_64[2]; 
....................       r = r*y2 + ql_64[3]; 
....................       r = r*y2 + 1.0; 
....................  
....................       res = y*res/r; 
....................   
....................       p= (((unsigned int16 *)(&x))+3); 
....................       data1 = *p; 
....................       bit_clear(data1,15); 
....................       data1 = data1 >>4;     
....................       n = data1 - 0x3FE; 
....................  
....................  
....................       if (n<0) 
....................          r = -(float64)-n; 
....................       else 
....................          r = (float64)n; 
....................  
....................       res += r*LN2; 
....................    } 
....................  
....................    else 
....................       res = 0.0; 
....................  
....................    return(res); 
.................... } 
.................... #endif 
....................  
....................  
.................... #define LN10 2.3025850929940456 
.................... #define LN10_INV 0.4342944819032518276 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float log10(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the the log base 10 of x 
.................... // Date : N/A 
.................... // 
.................... float32 log10(float32 x) 
.................... { 
....................    float32 r; 
....................  
....................    r = log(x); 
....................    r = r*LN10_INV; 
....................    return(r); 
.................... } 
....................  
.................... //Overloaded functions for log10() for PCD 
.................... // Overloaded function log10() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 log10(float48 x) 
.................... { 
....................    float48 r; 
....................  
....................    r = log(x); 
....................    r = r*LN10_INV; 
....................    return(r); 
.................... } 
....................  
.................... // Overloaded function log10() for data type - Float64 
.................... float64 log10(float64 x) 
.................... { 
....................    float64 r; 
....................  
....................    r = log(x); 
....................    r = r*LN10_INV; 
....................    return(r); 
.................... } 
.................... #endif 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float modf(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description :breaks the argument value int integral and fractional parts, 
.................... // ach of which have the same sign as the argument.  It stores the integral part 
.................... // as a float in the object pointed to by the iptr 
.................... // Returns : returns the signed fractional part of value. 
.................... // Date : N/A 
.................... // 
....................  
.................... float32 modf(float32 value,float32 *iptr) 
.................... { 
....................    *iptr=(value < 0.0)? ceil(value): floor(value); 
....................    return(value - *iptr); 
.................... } 
.................... //Overloaded functions for modf() for PCD 
.................... // Overloaded function modf() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 modf(float48 value,float48 *iptr) 
.................... { 
....................    *iptr=(value < 0.0)? ceil(value): floor(value); 
....................    return(value - *iptr); 
.................... } 
.................... // Overloaded function modf() for data type - Float64 
.................... float64 modf(float64 value,float64 *iptr) 
.................... { 
....................    *iptr=(value < 0.0)? ceil(value): floor(value); 
....................    return(value - *iptr); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float pwr(float x,float y) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the value (x^y) 
.................... // Date : N/A 
.................... // Note : 0 is returned when the function will generate an imaginary number 
.................... // 
.................... float32 pwr(float32 x,float32 y) 
.................... { 
....................    if(0 > x && fmod(y, 1) == 0) { 
....................       if(fmod(y, 2) == 0) { 
....................          return (exp(log(-x) * y)); 
....................       } else { 
....................          return (-exp(log(-x) * y)); 
....................       } 
....................    } else if(0 > x && fmod(y, 1) != 0) { 
....................       return 0; 
....................    } else { 
....................       if(x != 0 || 0 >= y) { 
....................          return (exp(log(x) * y)); 
....................       } 
....................    } 
.................... } 
.................... //Overloaded functions for pwr() for PCD 
.................... // Overloaded function pwr() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 pwr(float48 x,float48 y) 
.................... { 
....................    if(0 > x && fmod(y, 1) == 0) { 
....................       if(fmod(y, 2) == 0) { 
....................          return (exp(log(-x) * y)); 
....................       } else { 
....................          return (-exp(log(-x) * y)); 
....................       } 
....................    } else if(0 > x && fmod(y, 1) != 0) { 
....................       return 0; 
....................    } else { 
....................       if(x != 0 || 0 >= y) { 
....................          return (exp(log(x) * y)); 
....................       } 
....................    } 
.................... } 
.................... // Overloaded function pwr() for data type - Float64 
.................... float64 pwr(float64 x,float64 y) 
.................... { 
....................    if(0 > x && fmod(y, 1) == 0) { 
....................       if(fmod(y, 2) == 0) { 
....................          return (exp(log(-x) * y)); 
....................       } else { 
....................          return (-exp(log(-x) * y)); 
....................       } 
....................    } else if(0 > x && fmod(y, 1) != 0) { 
....................       return 0; 
....................    } else { 
....................       if(x != 0 || 0 >= y) { 
....................          return (exp(log(x) * y)); 
....................       } 
....................    } 
.................... } 
.................... #endif 
....................  
.................... //////////////////// Power functions //////////////////// 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float pow(float x,float y) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the value (x^y) 
.................... // Date : N/A 
.................... // Note : 0 is returned when the function will generate an imaginary number 
.................... // 
.................... float32 pow(float32 x,float32 y) 
.................... { 
....................    if(0 > x && fmod(y, 1) == 0) { 
....................       if(fmod(y, 2) == 0) { 
....................          return (exp(log(-x) * y)); 
....................       } else { 
....................          return (-exp(log(-x) * y)); 
....................       } 
....................    } else if(0 > x && fmod(y, 1) != 0) { 
....................       return 0; 
....................    } else { 
....................       if(x != 0 || 0 >= y) { 
....................          return (exp(log(x) * y)); 
....................       } 
....................    } 
.................... } 
.................... //Overloaded functions for pow() for PCD 
.................... // Overloaded function for pow() data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 pow(float48 x,float48 y) 
.................... { 
....................    if(0 > x && fmod(y, 1) == 0) { 
....................       if(fmod(y, 2) == 0) { 
....................          return (exp(log(-x) * y)); 
....................       } else { 
....................          return (-exp(log(-x) * y)); 
....................       } 
....................    } else if(0 > x && fmod(y, 1) != 0) { 
....................       return 0; 
....................    } else { 
....................       if(x != 0 || 0 >= y) { 
....................          return (exp(log(x) * y)); 
....................       } 
....................    } 
.................... } 
....................  
.................... // Overloaded function pow() for data type - Float64 
.................... float64 pow(float64 x,float64 y) 
.................... { 
....................    if(0 > x && fmod(y, 1) == 0) { 
....................       if(fmod(y, 2) == 0) { 
....................          return (exp(log(-x) * y)); 
....................       } else { 
....................          return (-exp(log(-x) * y)); 
....................       } 
....................    } else if(0 > x && fmod(y, 1) != 0) { 
....................       return 0; 
....................    } else { 
....................       if(x != 0 || 0 >= y) { 
....................          return (exp(log(x) * y)); 
....................       } 
....................    } 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float sqrt(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the square root of x 
.................... // Date : N/A 
.................... // 
.................... float32 sqrt(float32 x) 
.................... { 
....................    float32 y, res; 
....................    #if defined(__PCD__) 
....................    unsigned int16 data1,data2; 
....................    #endif 
....................    unsigned int8 *p; 
....................  
....................    #ifdef _ERRNO 
....................    if(x < 0) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................  
....................    if( x<=0.0) 
....................       return(0.0); 
....................  
....................    y=x; 
....................     
....................    #if !defined(__PCD__) 
....................     p=&y; 
....................    (*p)=(unsigned int8)((((unsigned int16)(*p)) + 127) >> 1); 
....................    #endif 
....................     
....................    #if defined(__PCD__) 
....................     p = (((unsigned int8 *)(&y))+3); 
....................     data1 = *(((unsigned int8 *)(&y))+3); 
....................     data2 = *(((unsigned int8 *)(&y))+2); 
....................     rotate_left(&data1,1);     
....................     if(bit_test(data2,7))     
....................        bit_set(data1,0);     
....................     data1 = ((data1+127) >>1); 
....................     bit_clear(data2,7); 
....................     if(bit_test(data1,0)) 
....................        bit_set(data2,7); 
....................     data1 = data1 >>1; 
....................     *(((unsigned int8 *)(&y))+3) = data1; 
....................     *(((unsigned int8 *)(&y))+2) = data2; 
....................      
....................   #endif 
....................  
....................    do { 
....................       res=y; 
....................       y+=(x/y); 
....................  
....................       #if !defined(__PCD__) 
....................      (*p)--; 
....................    #endif 
....................     
....................    #if defined(__PCD__) 
....................     data1 = *(((unsigned int8 *)(&y))+3); 
....................     data2 = *(((unsigned int8 *)(&y))+2); 
....................     rotate_left(&data1,1); 
....................     if(bit_test(data2,7)) 
....................        bit_set(data1,0);     
....................     data1--; 
....................     bit_clear(data2,7); 
....................     if(bit_test(data1,0)) 
....................        bit_set(data2,7); 
....................     data1 = data1 >>1; 
....................     *(((unsigned int8 *)(&y))+3) = data1; 
....................     *(((unsigned int8 *)(&y))+2) = data2; 
....................      
....................   #endif 
....................    } while(res != y); 
....................  
....................    return(res); 
.................... } 
.................... //Overloaded functions for sqrt() for PCD 
.................... // Overloaded function sqrt() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 sqrt(float48 x) 
.................... { 
....................    float48 y, res; 
....................    unsigned int16 data1,data2; 
....................    unsigned int8 *p; 
....................  
....................    #ifdef _ERRNO 
....................    if(x < 0) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................  
....................    if( x<=0.0) 
....................       return(0.0); 
....................  
....................    y=x; 
....................     
....................    #if !defined(__PCD__) 
....................     p=&y; 
....................    (*p)=(unsigned int8)((((unsigned int16)(*p)) + 127) >> 1); 
....................    #endif 
....................     
....................    #if defined(__PCD__) 
....................     p = (((unsigned int8 *)(&y))+5); 
....................     data1 = *(((unsigned int8 *)(&y))+5); 
....................     data2 = *(((unsigned int8 *)(&y))+4); 
....................     rotate_left(&data1,1); 
....................     if(bit_test(data2,7)) 
....................        bit_set(data1,0);     
....................     data1 = ((data1+127) >>1); 
....................     bit_clear(data2,7); 
....................     if(bit_test(data1,0)) 
....................        bit_set(data2,7); 
....................     data1 = data1 >>1; 
....................     *(((unsigned int8 *)(&y))+5) = data1; 
....................     *(((unsigned int8 *)(&y))+4) = data2; 
....................      
....................   #endif 
....................  
....................    do { 
....................       res=y; 
....................       y+=(x/y); 
....................  
....................       #if !defined(__PCD__) 
....................      (*p)--; 
....................    #endif 
....................     
....................     data1 = *(((unsigned int8 *)(&y))+5); 
....................     data2 = *(((unsigned int8 *)(&y))+4); 
....................     rotate_left(&data1,1); 
....................     if(bit_test(data2,7)) 
....................        bit_set(data1,0);     
....................     data1--; 
....................     bit_clear(data2,7); 
....................     if(bit_test(data1,0)) 
....................        bit_set(data2,7); 
....................     data1 = data1 >>1; 
....................     *(((unsigned int8 *)(&y))+5) = data1; 
....................     *(((unsigned int8 *)(&y))+4) = data2; 
....................      
....................    } while(res != y); 
....................  
....................    return(res); 
.................... } 
....................  
.................... // Overloaded function sqrt() for data type - Float64 
.................... float64 sqrt(float64 x) 
.................... { 
....................    float64 y, res; 
....................    unsigned int16 *p; 
....................    unsigned int16 temp1,temp2; 
....................  
....................    #ifdef _ERRNO 
....................    if(x < 0) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................  
....................    if( x<=0.0) 
....................       return(0.0); 
....................  
....................    y=x; 
....................    p= (((unsigned int16 *)(&y))+3); 
....................    temp1 = *p; 
....................    temp2 = *p; 
....................    bit_clear(temp1,15); 
....................    temp1 = (temp1>>4)+1023; 
....................    temp1 = temp1 >> 1; 
....................    temp1 = (temp1<<4) & 0xFFF0; 
....................    if(bit_test(temp2,15)) 
....................       bit_set(temp1,15); 
....................    temp2 = temp2 & 0x000F; 
....................    temp1 ^= temp2; 
....................     
....................    (*p) = temp1; 
....................     
....................    do { 
....................       res=y; 
....................       y+=(x/y); 
....................      temp1 = *p; 
....................      temp2 = *p; 
....................      bit_clear(temp1,15); 
....................      temp1 = (temp1>>4); 
....................      temp1--; 
....................      temp1 = (temp1<<4) & 0xFFF0; 
....................      if(bit_test(temp2,15)) 
....................         bit_set(temp1,15); 
....................      temp2 = temp2 & 0x000F; 
....................      temp1 ^= temp2; 
....................      (*p) = temp1; 
....................  
....................    } while(res != y); 
....................  
....................    return(res); 
.................... } 
.................... #endif 
....................  
.................... ////////////////////////////// Trig Functions ////////////////////////////// 
.................... #ifdef PI_DIV_BY_TWO_INV 
.................... #undef PI_DIV_BY_TWO_INV 
.................... #endif 
.................... #define PI_DIV_BY_TWO_INV 0.63661977236758134 
.................... #ifdef PI_DIV_BY_TWO 
.................... #undef PI_DIV_BY_TWO 
.................... #endif 
.................... #define PI_DIV_BY_TWO   1.5707963267948966 
.................... #ifdef TWOBYPI 
.................... #undef TWOBYPI 
.................... #endif 
.................... #define TWOBYPI          0.6366197723675813 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float cos(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the cosine value of the angle x, which is in radian 
.................... // Date : 9/20/2001 
.................... // 
.................... float32 cos(float32 x) 
.................... { 
....................    float32 y, t, t2 = 1.0; 
....................    unsigned int8 quad, i; 
....................    float32 frac; 
....................    float32 p[5] = {                    //by the series definition for cosine 
....................       -0.49999999456337096,            // sum ( ( (-1)^n * x^2n )/(2n)! ) 
....................        0.04166663896921267, 
....................       -0.00138883894522527, 
....................        0.00002476138231734, 
....................       -0.00000026070414770 
....................       //-0.00000000001147, 
....................       // 0.00000000000005 
....................    }; 
....................  
....................    if (x < 0) x = -x;                  // absolute value of input 
....................  
....................    quad = (unsigned int8)(x * PI_DIV_BY_TWO_INV);    // quadrant 
....................    frac = (x * PI_DIV_BY_TWO_INV) - quad;  // fractional part of input 
....................    quad = quad % 4;                    // quadrant (0 to 3) 
....................  
....................    if (quad == 0 || quad == 2) 
....................       t = frac * PI_DIV_BY_TWO; 
....................    else if (quad == 1) 
....................       t = (1-frac) * PI_DIV_BY_TWO; 
....................    else // should be 3 
....................       t = (frac-1) * PI_DIV_BY_TWO; 
....................  
....................    y = 1.0; 
....................    t = t * t; 
....................    for (i = 0; i <= 4; i++) 
....................    { 
....................       t2 = t2 * t; 
....................       y = y + p[i] * t2; 
....................    } 
....................  
....................    if (quad == 2 || quad == 1) 
....................       y = -y;  // correct sign 
....................  
....................    return (y); 
.................... } 
....................  
....................  
.................... //Overloaded functions for cos() for PCD 
.................... // Overloaded function cos() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 cos(float48 x) 
.................... { 
....................    float48 y, t, t2 = 1.0; 
....................    unsigned int8 quad, i; 
....................    float48 frac; 
....................    float48 p[6] = {                    //by the series definition for cosine 
....................       -0.5,                            // sum ( ( (-1)^n * x^2n )/(2n)! ) 
....................        0.04166666666667, 
....................       -0.00138888888889, 
....................        0.00002480158730, 
....................       -0.00000027557319, 
....................        0.00000000208767, 
....................       //-0.00000000001147, 
....................       // 0.00000000000005 
....................    }; 
....................  
....................    if (x < 0) x = -x;                  // absolute value of input 
....................  
....................    quad = (unsigned int8)(x * PI_DIV_BY_TWO_INV);    // quadrant 
....................    frac = (x * PI_DIV_BY_TWO_INV) - quad;  // fractional part of input 
....................    quad = quad % 4;                    // quadrant (0 to 3) 
....................  
....................    if (quad == 0 || quad == 2) 
....................       t = frac * PI_DIV_BY_TWO; 
....................    else if (quad == 1) 
....................       t = (1-frac) * PI_DIV_BY_TWO; 
....................    else // should be 3 
....................       t = (frac-1) * PI_DIV_BY_TWO; 
....................  
....................    y = 0.999999999781; 
....................    t = t * t; 
....................    for (i = 0; i <= 5; i++) 
....................    { 
....................       t2 = t2 * t; 
....................       y = y + p[i] * t2; 
....................    } 
....................  
....................    if (quad == 2 || quad == 1) 
....................       y = -y;  // correct sign 
....................  
....................    return (y); 
.................... } 
....................  
.................... // Overloaded function cos() for data type - Float64 
.................... float64 cos(float64 x) 
.................... { 
....................    float64 y, t, t2 = 1.0; 
....................    unsigned int8 quad, i; 
....................    float64 frac; 
....................    float64 p_64[9] = {               //by the series definition for cosine 
....................      -0.49999999999998740,           // sum ( ( (-1)^n * x^2n )/(2n)! )              
....................       0.04166666666656518, 
....................      -0.00138888888851691, 
....................       0.00002480158658490, 
....................      -0.00000027557239796, 
....................       0.00000000208715031, 
....................      -0.00000000001126577, 
....................       0.00000000000000427, 
....................       0.00000000000000372}; 
....................  
....................    if (x < 0) x = -x;                  // absolute value of input 
....................  
....................    quad = (unsigned int8)(x * PI_DIV_BY_TWO_INV);    // quadrant 
....................    frac = (x * PI_DIV_BY_TWO_INV) - quad;  // fractional part of input 
....................    quad = quad % 4;                    // quadrant (0 to 3) 
....................  
....................    if (quad == 0 || quad == 2) 
....................       t = frac * PI_DIV_BY_TWO; 
....................    else if (quad == 1) 
....................       t = (1-frac) * PI_DIV_BY_TWO; 
....................    else // should be 3 
....................       t = (frac-1) * PI_DIV_BY_TWO; 
....................  
....................    y = 1.0; 
....................    t = t * t; 
....................    for (i = 0; i <= 8; i++) 
....................    { 
....................       t2 = t2 * t; 
....................       y = y + p_64[i] * t2; 
....................    } 
....................  
....................    if (quad == 2 || quad == 1) 
....................       y = -y;  // correct sign 
....................  
....................    return (y); 
.................... } 
....................  
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float sin(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the sine value of the angle x, which is in radian 
.................... // Date : 9/20/2001 
.................... // 
.................... float32 sin(float32 x) 
.................... { 
....................    return cos(x - PI_DIV_BY_TWO); 
.................... } 
....................  
.................... //Overloaded functions for sin() for PCD 
.................... // Overloaded function sin() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 sin(float48 x) 
.................... { 
....................    return cos(x - PI_DIV_BY_TWO); 
.................... } 
....................  
.................... // Overloaded function sin() for data type - Float48 
.................... float64 sin(float64 x) 
.................... { 
....................    return cos(x - PI_DIV_BY_TWO); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float tan(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the tangent value of the angle x, which is in radian 
.................... // Date : 9/20/2001 
.................... // 
.................... float32 tan(float32 x) 
.................... { 
....................    float32 c, s; 
....................  
....................    c = cos(x); 
....................    if (c == 0.0) 
....................       return (1.0e+36); 
....................  
....................    s = sin(x); 
....................    return(s/c); 
.................... } 
.................... //Overloaded functions for tan() for PCD 
.................... // Overloaded function tan() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 tan(float48 x) 
.................... { 
....................    float48 c, s; 
....................  
....................    c = cos(x); 
....................    if (c == 0.0) 
....................       return (1.0e+36); 
....................  
....................    s = sin(x); 
....................    return(s/c); 
.................... } 
....................  
.................... // Overloaded function tan() for data type - Float48 
.................... float64 tan(float64 x) 
.................... { 
....................    float64 c, s; 
....................  
....................    c = cos(x); 
....................    if (c == 0.0) 
....................       return (1.0e+36); 
....................  
....................    s = sin(x); 
....................    return(s/c); 
.................... } 
.................... #endif 
....................  
.................... float32 const pas[3] = {0.49559947, -4.6145309, 5.6036290}; 
.................... float32 const qas[3] = {1.0000000,  -5.5484666, 5.6036290}; 
....................  
.................... float32 ASIN_COS(float32 x, unsigned int8 n) 
.................... { 
....................    float32 y, res, r, y2; 
....................    int1 s; 
....................    #ifdef _ERRNO 
....................    if(x <-1 || x > 1) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y > 0.5) 
....................    { 
....................       y = sqrt((1.0 - y)*0.5); 
....................       n += 2; 
....................    } 
....................  
....................    y2=y*y; 
....................  
....................    res = pas[0]*y2 + pas[1]; 
....................    res = res*y2 + pas[2]; 
....................  
....................    r = qas[0]*y2 + qas[1]; 
....................    r = r*y2 + qas[2]; 
....................  
....................    res = y*res/r; 
....................  
....................    if (n & 2)     // |x| > 0.5 
....................       res = PI_DIV_BY_TWO - 2.0*res; 
....................    if (s) 
....................       res = -res; 
....................    if (n & 1)           // take arccos 
....................       res = PI_DIV_BY_TWO - res; 
....................  
....................    return(res); 
.................... } 
....................  
....................  
.................... //Overloaded functions for ASIN_COS() for PCD 
.................... // Overloaded function ASIN_COS() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 ASIN_COS(float48 x, unsigned int8 n) 
.................... { 
....................    float48 y, res, r, y2; 
....................    int1 s; 
....................    #ifdef _ERRNO 
....................    if(x <-1 || x > 1) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y > 0.5) 
....................    { 
....................       y = sqrt((1.0 - y)*0.5); 
....................       n += 2; 
....................    } 
....................  
....................    y2=y*y; 
....................  
....................    res = pas[0]*y2 + pas[1]; 
....................    res = res*y2 + pas[2]; 
....................  
....................    r = qas[0]*y2 + qas[1]; 
....................    r = r*y2 + qas[2]; 
....................  
....................    res = y*res/r; 
....................  
....................    if (n & 2)     // |x| > 0.5 
....................       res = PI_DIV_BY_TWO - 2.0*res; 
....................    if (s) 
....................       res = -res; 
....................    if (n & 1)           // take arccos 
....................       res = PI_DIV_BY_TWO - res; 
....................  
....................    return(res); 
.................... } 
....................  
.................... // Overloaded function ASIN_COS() for data type - Float64 
.................... double pas_64[5]={1.000000000000000,-2.069938587724477,1.421444580548907, 
....................                  -0.360690137621842,0.024929451660228}; 
....................  
.................... double qas_64[5]={-2.236605254391134,1.719212122946451,-0.524122954476133, 
....................                    0.052808872045749,-0.000662536036570}; 
....................                     
.................... float64 ASIN_COS(float64 x, unsigned int8 n) 
.................... { 
....................    float64 y, res, r, y2; 
....................    int1 s; 
....................    #ifdef _ERRNO 
....................    if(x <-1 || x > 1) 
....................    { 
....................       errno=EDOM; 
....................    } 
....................    #endif 
....................    s = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y > 0.5) 
....................    { 
....................       y = sqrt((1.0 - y)*0.5); 
....................       n += 2; 
....................    } 
....................  
....................    y2=y*y; 
....................  
....................    res = pas_64[4]*y2 + pas_64[3]; 
....................    res = res*y2 + pas_64[2]; 
....................    res = res*y2 + pas_64[1]; 
....................    res = res*y2 + pas_64[0]; 
....................  
....................    r = qas_64[4]*y2 + qas_64[3]; 
....................    r = r*y2 + qas_64[2]; 
....................    r = r*y2 + qas_64[1]; 
....................    r = r*y2 + qas_64[0]; 
....................    r = r*y2 + 1.0; 
....................  
....................    res = y*res/r; 
....................  
....................    if (n & 2)     // |x| > 0.5 
....................       res = PI_DIV_BY_TWO - 2.0*res; 
....................    if (s) 
....................       res = -res; 
....................    if (n & 1)           // take arccos 
....................       res = PI_DIV_BY_TWO - res; 
....................  
....................    return(res); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float asin(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the arcsine value of the value x. 
.................... // Date : N/A 
.................... // 
.................... float32 asin(float32 x) 
.................... { 
....................    float32 r; 
....................  
....................    r = ASIN_COS(x, 0); 
....................    return(r); 
.................... } 
.................... //Overloaded functions for asin() for PCD 
.................... // Overloaded function asin() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 asin(float48 x) 
.................... { 
....................    float48 r; 
....................  
....................    r = ASIN_COS(x, 0); 
....................    return(r); 
.................... } 
....................  
.................... // Overloaded function asin() for data type - Float64 
.................... float64 asin(float64 x) 
.................... { 
....................    float64 r; 
....................  
....................    r = ASIN_COS(x, 0); 
....................    return(r); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float acos(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the arccosine value of the value x. 
.................... // Date : N/A 
.................... // 
.................... float32 acos(float32 x) 
.................... { 
....................    float32 r; 
....................  
....................    r = ASIN_COS(x, 1); 
....................    return(r); 
.................... } 
.................... //Overloaded functions for acos() for PCD 
.................... // Overloaded function acos() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 acos(float48 x) 
.................... { 
....................    float48 r; 
....................  
....................    r = ASIN_COS(x, 1); 
....................    return(r); 
.................... } 
....................  
.................... // Overloaded function acos() for data type - Float64 
.................... float64 acos(float64 x) 
.................... { 
....................    float64 r; 
....................  
....................    r = ASIN_COS(x, 1); 
....................    return(r); 
.................... } 
.................... #endif 
....................  
.................... float32 const pat[4] = {0.17630401, 5.6710795, 22.376096, 19.818457}; 
.................... float32 const qat[4] = {1.0000000,  11.368190, 28.982246, 19.818457}; 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float atan(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : returns the arctangent value of the value x. 
.................... // Date : N/A 
.................... // 
.................... float32 atan(float32 x) 
.................... { 
....................    float32 y, res, r; 
....................    int1 s, flag; 
....................  
....................    s = 0; 
....................    flag = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y > 1.0) 
....................    { 
....................       y = 1.0/y; 
....................       flag = 1; 
....................    } 
....................  
....................    res = pat[0]*y*y + pat[1]; 
....................    res = res*y*y + pat[2]; 
....................    res = res*y*y + pat[3]; 
....................  
....................    r = qat[0]*y*y + qat[1]; 
....................    r = r*y*y + qat[2]; 
....................    r = r*y*y + qat[3]; 
....................  
....................    res = y*res/r; 
....................  
....................  
....................    if (flag)                              // for |x| > 1 
....................       res = PI_DIV_BY_TWO - res; 
....................    if (s) 
....................       res = -res; 
....................  
....................    return(res); 
.................... } 
.................... //Overloaded functions for atan() for PCD 
.................... // Overloaded function atan() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 atan(float48 x) 
.................... { 
....................    float48 y, res, r; 
....................    int1 s, flag; 
....................  
....................    s = 0; 
....................    flag = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y > 1.0) 
....................    { 
....................       y = 1.0/y; 
....................       flag = 1; 
....................    } 
....................  
....................    res = pat[0]*y*y + pat[1]; 
....................    res = res*y*y + pat[2]; 
....................    res = res*y*y + pat[3]; 
....................  
....................    r = qat[0]*y*y + qat[1]; 
....................    r = r*y*y + qat[2]; 
....................    r = r*y*y + qat[3]; 
....................  
....................    res = y*res/r; 
....................  
....................  
....................    if (flag)                              // for |x| > 1 
....................       res = PI_DIV_BY_TWO - res; 
....................    if (s) 
....................       res = -res; 
....................  
....................    return(res); 
.................... } 
....................  
.................... float64 pat_64[6]={0.999999999999999,2.249923645595566,1.771541617806449, 
....................                    0.579678874003185,0.072162702162882,0.002281100141660}; 
....................  
.................... float64 qat_64[6]={2.583256978928510,2.432627277466967,1.016760379885393, 
....................                    0.182482977188688,0.011155377971690,0.000100013019160}; 
.................... // Overloaded function atan() for data type - Float64 
.................... float64 atan(float64 x) 
.................... { 
....................    float64 y,y2, res, r; 
....................    int1 s, flag; 
....................  
....................    s = 0; 
....................    flag = 0; 
....................    y = x; 
....................  
....................    if (x < 0) 
....................    { 
....................       s = 1; 
....................       y = -y; 
....................    } 
....................  
....................    if (y > 1.0) 
....................    { 
....................       y = 1.0/y; 
....................       flag = 1; 
....................    } 
....................    y2 = y*y; 
....................    res = pat_64[5]*y2 + pat_64[4]; 
....................    res = res*y2 + pat_64[3]; 
....................    res = res*y2 + pat_64[2]; 
....................    res = res*y2 + pat_64[1]; 
....................    res = res*y2 + pat_64[0]; 
....................  
....................    r = qat_64[5]*y2 + qat_64[4]; 
....................    r = r*y2 + qat_64[3]; 
....................    r = r*y2 + qat_64[2]; 
....................    r = r*y2 + qat_64[1]; 
....................    r = r*y2 + qat_64[0]; 
....................    r = r*y2 + 1.0; 
....................  
....................    res = y*res/r; 
....................  
....................  
....................    if (flag)                              // for |x| > 1 
....................       res = PI_DIV_BY_TWO - res; 
....................    if (s) 
....................       res = -res; 
....................  
....................    return(res); 
.................... } 
.................... #endif 
....................  
.................... ///////////////////////////////////////////////////////////////////////////// 
.................... //   float atan2(float y, float x) 
.................... ///////////////////////////////////////////////////////////////////////////// 
.................... // Description :computes the principal value of arc tangent of y/x, using the 
.................... // signs of both the arguments to determine the quadrant of the return value 
.................... // Returns : returns the arc tangent of y/x. 
.................... // Date : N/A 
.................... // 
....................  
.................... float32 atan2(float32 y,float32 x) 
.................... { 
....................    float32 z; 
....................    int1 sign; 
....................    unsigned int8 quad; 
....................    sign=0; 
....................    quad=0; //quadrant 
....................    quad=((y<=0.0)?((x<=0.0)?3:4):((x<0.0)?2:1)); 
....................    if(y<0.0) 
....................    { 
....................       sign=1; 
....................       y=-y; 
....................    } 
....................    if(x<0.0) 
....................    { 
....................       x=-x; 
....................    } 
....................    if (x==0.0) 
....................    { 
....................       if(y==0.0) 
....................       { 
....................       #ifdef _ERRNO 
....................       { 
....................          errno=EDOM; 
....................       } 
....................       #endif 
....................       } 
....................       else 
....................       { 
....................          if(sign) 
....................          { 
....................          return (-(PI_DIV_BY_TWO)); 
....................          } 
....................          else 
....................          { 
....................          return (PI_DIV_BY_TWO); 
....................          } 
....................       } 
....................    } 
....................    else 
....................    { 
....................       z=y/x; 
....................       switch(quad) 
....................       { 
....................          case 1: 
....................          { 
....................             return atan(z); 
....................             break; 
....................          } 
....................          case 2: 
....................          { 
.................... //            return (atan(z)+PI_DIV_BY_TWO);  //2L3122 
....................             return (PI-atan(z)); 
....................             break; 
....................          } 
....................          case 3: 
....................          { 
....................             return (atan(z)-PI); 
....................             break; 
....................          } 
....................          case 4: 
....................          { 
....................             return (-atan(z)); 
....................             break; 
....................          } 
....................       } 
....................    } 
.................... } 
....................  
.................... //Overloaded functions for atan2() for PCD 
.................... // Overloaded function atan2() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 atan2(float48 y,float48 x) 
.................... { 
....................    float48 z; 
....................    int1 sign; 
....................    unsigned int8 quad; 
....................    sign=0; 
....................    quad=0; //quadrant 
....................    quad=((y<=0.0)?((x<=0.0)?3:4):((x<0.0)?2:1)); 
....................    if(y<0.0) 
....................    { 
....................       sign=1; 
....................       y=-y; 
....................    } 
....................    if(x<0.0) 
....................    { 
....................       x=-x; 
....................    } 
....................    if (x==0.0) 
....................    { 
....................       if(y==0.0) 
....................       { 
....................       #ifdef _ERRNO 
....................       { 
....................          errno=EDOM; 
....................       } 
....................       #endif 
....................       } 
....................       else 
....................       { 
....................          if(sign) 
....................          { 
....................          return (-(PI_DIV_BY_TWO)); 
....................          } 
....................          else 
....................          { 
....................          return (PI_DIV_BY_TWO); 
....................          } 
....................       } 
....................    } 
....................    else 
....................    { 
....................       z=y/x; 
....................       switch(quad) 
....................       { 
....................          case 1: 
....................          { 
....................             return atan(z); 
....................             break; 
....................          } 
....................          case 2: 
....................          { 
.................... //            return (atan(z)+PI_DIV_BY_TWO);  //2L3122 
....................             return (PI-atan(z)); 
....................             break; 
....................          } 
....................          case 3: 
....................          { 
....................             return (atan(z)-PI); 
....................             break; 
....................          } 
....................          case 4: 
....................          { 
....................             return (-atan(z)); 
....................             break; 
....................          } 
....................       } 
....................    } 
.................... } 
....................  
.................... // Overloaded function atan2() for data type - Float64 
.................... float64 atan2(float64 y,float64 x) 
.................... { 
....................    float64 z; 
....................    int1 sign; 
....................    unsigned int8 quad; 
....................    sign=0; 
....................    quad=0; //quadrant 
....................    quad=((y<=0.0)?((x<=0.0)?3:4):((x<0.0)?2:1)); 
....................    if(y<0.0) 
....................    { 
....................       sign=1; 
....................       y=-y; 
....................    } 
....................    if(x<0.0) 
....................    { 
....................       x=-x; 
....................    } 
....................    if (x==0.0) 
....................    { 
....................       if(y==0.0) 
....................       { 
....................       #ifdef _ERRNO 
....................       { 
....................          errno=EDOM; 
....................       } 
....................       #endif 
....................       } 
....................       else 
....................       { 
....................          if(sign) 
....................          { 
....................          return (-(PI_DIV_BY_TWO)); 
....................          } 
....................          else 
....................          { 
....................          return (PI_DIV_BY_TWO); 
....................          } 
....................       } 
....................    } 
....................    else 
....................    { 
....................       z=y/x; 
....................       switch(quad) 
....................       { 
....................          case 1: 
....................          { 
....................             return atan(z); 
....................             break; 
....................          } 
....................          case 2: 
....................          { 
.................... //            return (atan(z)+PI_DIV_BY_TWO);  //2L3122 
....................             return (PI-atan(z)); 
....................             break; 
....................          } 
....................          case 3: 
....................          { 
....................             return (atan(z)-PI); 
....................             break; 
....................          } 
....................          case 4: 
....................          { 
....................             return (-atan(z)); 
....................             break; 
....................          } 
....................       } 
....................    } 
.................... } 
.................... #endif 
....................  
.................... //////////////////// Hyperbolic functions //////////////////// 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float cosh(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : Computes the hyperbolic cosine value of x 
.................... // Returns : returns the hyperbolic cosine value of x 
.................... // Date : N/A 
.................... // 
....................  
.................... float32 cosh(float32 x) 
.................... { 
....................    return ((exp(x)+exp(-x))*0.5); 
.................... } 
.................... //Overloaded functions for cosh() for PCD 
.................... // Overloaded function cosh() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 cosh(float48 x) 
.................... { 
....................    return ((exp(x)+exp(-x))*0.5); 
.................... } 
....................  
.................... // Overloaded function cosh() for data type - Float64 
.................... float64 cosh(float64 x) 
.................... { 
....................    return ((exp(x)+exp(-x))*0.5); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float sinh(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : Computes the hyperbolic sine value of x 
.................... // Returns : returns the hyperbolic sine value of x 
.................... // Date : N/A 
.................... // 
....................  
.................... float32 sinh(float32 x) 
.................... { 
....................  
....................    return ((exp(x) - exp(-x))*0.5); 
.................... } 
.................... //Overloaded functions for sinh() for PCD 
.................... // Overloaded function sinh() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 sinh(float48 x) 
.................... { 
....................  
....................    return ((exp(x) - exp(-x))*0.5); 
.................... } 
....................  
.................... // Overloaded function sinh() for data type - Float48 
.................... float64 sinh(float64 x) 
.................... { 
....................  
....................    return ((exp(x) - exp(-x))*0.5); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float tanh(float x) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : Computes the hyperbolic tangent value of x 
.................... // Returns : returns the hyperbolic tangent value of x 
.................... // Date : N/A 
.................... // 
....................  
.................... float32 tanh(float32 x) 
.................... { 
....................    return(sinh(x)/cosh(x)); 
.................... } 
.................... //Overloaded functions for tanh() for PCD 
.................... // Overloaded function tanh() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 tanh(float48 x) 
.................... { 
....................    return(sinh(x)/cosh(x)); 
.................... } 
....................  
.................... // Overloaded function tanh() for data type - Float64 
.................... float64 tanh(float64 x) 
.................... { 
....................    return(sinh(x)/cosh(x)); 
.................... } 
.................... #endif 
....................  
.................... //////////////////////////////////////////////////////////////////////////// 
.................... //   float frexp(float x, signed int *exp) 
.................... //////////////////////////////////////////////////////////////////////////// 
.................... // Description : breaks a floating point number into a normalized fraction and an integral 
.................... // power of 2. It stores the integer in the signed int object pointed to by exp. 
.................... // Returns : returns the value x, such that x is a double with magnitude in the interval 
.................... // [1/2,1) or zero, and value equals x times 2 raised to the power *exp.If value is zero, 
.................... // both parts of the result are zero. 
.................... // Date : N/A 
.................... // 
....................  
.................... #define LOG2 .30102999566398119521 
.................... #define LOG2_INV 3.32192809488736234787 
.................... float32 frexp(float32 x, signed int8 *exp) 
.................... { 
....................    float32 res; 
....................    int1 sign = 0; 
....................    if(x == 0.0) 
....................    { 
....................       *exp=0; 
....................       return (0.0); 
....................    } 
....................    if(x < 0.0) 
....................    { 
....................      x=-x; 
....................      sign=1; 
....................    } 
....................    if (x > 1.0) 
....................    { 
....................       *exp=(ceil(log10(x)*LOG2_INV)); 
....................       res=x/(pow(2, *exp)); 
....................       if (res == 1) 
....................       { 
....................          *exp=*exp+1; 
....................           res=.5; 
....................       } 
....................    } 
....................    else 
....................    { 
....................       if(x < 0.5) 
....................       { 
....................          *exp=-1; 
....................          res=x*2; 
....................       } 
....................       else 
....................       { 
....................          *exp=0; 
....................           res=x; 
....................       } 
....................    } 
....................    if(sign) 
....................    { 
....................       res=-res; 
....................    } 
....................    return res; 
.................... } 
....................  
.................... //Overloaded functions for frexp() for PCD 
.................... // Overloaded function frexp() for data type - Float48 
.................... #if defined(__PCD__) 
.................... float48 frexp(float48 x, signed int8 *exp) 
.................... { 
....................    float48 res; 
....................    int1 sign = 0; 
....................    if(x == 0.0) 
....................    { 
....................       *exp=0; 
....................       return (0.0); 
....................    } 
....................    if(x < 0.0) 
....................    { 
....................      x=-x; 
....................      sign=1; 
....................    } 
....................    if (x > 1.0) 
....................    { 
....................       *exp=(ceil(log10(x)*LOG2_INV)); 
....................       res=x/(pow(2, *exp)); 
....................       if (res == 1) 
....................       { 
....................          *exp=*exp+1; 
....................           res=.5; 
....................       } 
....................    } 
....................    else 
....................    { 
....................       if(x < 0.5) 
....................       { 
....................          *exp=-1; 
....................          res=x*2; 
....................       } 
....................       else 
....................       { 
....................          *exp=0; 
....................           res=x; 
....................       } 
....................    } 
....................    if(sign) 
....................    { 
....................       res=-res; 
....................    } 
....................    return res; 
.................... } 
....................  
.................... // Overloaded function frexp() for data type - Float64 
.................... float64 frexp(float64 x, signed int8 *exp) 
.................... { 
....................    float64 res; 
....................    int1 sign = 0; 
....................    if(x == 0.0) 
....................    { 
....................       *exp=0; 
....................       return (0.0); 
....................    } 
....................    if(x < 0.0) 
....................    { 
....................      x=-x; 
....................      sign=1; 
....................    } 
....................    if (x > 1.0) 
....................    { 
....................       *exp=(ceil(log10(x)*LOG2_INV)); 
....................       res=x/(pow(2, *exp)); 
....................       if (res == 1) 
....................       { 
....................          *exp=*exp+1; 
....................           res=.5; 
....................       } 
....................    } 
....................    else 
....................    { 
....................       if(x < 0.5) 
....................       { 
....................          *exp=-1; 
....................          res=x*2; 
....................       } 
....................       else 
....................       { 
....................          *exp=0; 
....................           res=x; 
....................       } 
....................    } 
....................    if(sign) 
....................    { 
....................       res=-res; 
....................    } 
....................    return res; 
.................... } 
.................... #endif 
....................  
.................... ////////////////////////////////////////////////////////////////////////////// 
.................... //   float ldexp(float x, signed int *exp) 
.................... ////////////////////////////////////////////////////////////////////////////// 
.................... // Description : multiplies a floating point number by an integral power of 2. 
.................... // Returns : returns the value of x times 2 raised to the power exp. 
.................... // Date : N/A 
.................... // 
....................  
.................... float32 ldexp(float32 value, signed int8 exp) 
.................... { 
....................    return (value * pow(2,exp)); 
.................... } 
.................... //Overloaded functions for ldexp() for PCD 
.................... // Overloaded function ldexp() for data type - Float48 
....................  
.................... #if defined(__PCD__) 
.................... float48 ldexp(float48 value, signed int8 exp) 
.................... { 
....................    return (value * pow(2,exp)); 
.................... } 
.................... // Overloaded function ldexp() for data type - Float64 
.................... float64 ldexp(float64 value, signed int8 exp) 
.................... { 
....................    return (value * pow(2,exp)); 
.................... } 
.................... #endif 
....................  
.................... #endif 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... void khoi_tao_glcd() 
.................... { 
....................    setup_glcd(glcd_text_mode); 
....................    setup_glcd(glcd_graphic_mode); 
....................    glcd_command(glcd_clear_display); 
....................    glcd_mau_nen(0); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //Khai bao bien LCD_GLCD 
.................... unsigned int8 gioi_han,flag=0,gioi_han_tam[2]; 
.................... unsigned char hang1[20]={"                    "}; 
.................... unsigned char hang2[20]={"                    "}; 
.................... unsigned char hang3[20]={"                    "}; 
.................... unsigned char hang4[20]={"                    "}; 
.................... unsigned char hang1234[80]={"                                                                                "}; 
.................... signed int8 dem; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 601: hien thi 4 hang ki tu 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_601_lcd_hienthi_4hang() 
.................... { 
....................   unsigned char hang1[]={"1 hien thi lcd 20x4** "}; 
....................   unsigned char hang2[]={"2 dai hoc su pham kt"}; 
....................   unsigned char hang3[]={"3 bo thi nghiem vdk "}; 
....................   unsigned char hang4[]={"0123456789abcdefghij"}; 
....................    
....................   lcd_command(lcd_addr_line1); 
....................   for (i=0;i<20;i++) { lcd_data(hang1[i]); } 
....................    
....................   lcd_command(lcd_addr_line2); 
....................   for (i=0;i<20;i++) { lcd_data(hang2[i]); } 
....................    
....................   lcd_command(lcd_addr_line3); 
....................   for (i=0;i<20;i++) { lcd_data(hang3[i]); } 
....................    
....................   lcd_command(lcd_addr_line4); 
....................   for (i=0;i<20;i++) { lcd_data(hang4[i]); } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 602: hien thi 4 hang ki tu cach 2 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_602_lcd_hienthi_4hang() 
.................... { 
....................   lcd_command(lcd_addr_line1); 
....................   lcd_data("1 hien thi lcd 20x4** ");  
....................    
....................   lcd_command(lcd_addr_line2); 
....................   lcd_data("2 dai hoc su pham kt");  
....................    
....................   lcd_command(lcd_addr_line3); 
....................   lcd_data("3 bo thi nghiem vdk ");  
....................    
....................   lcd_command(lcd_addr_line4); 
....................   lcd_data("0123456789abcdefghij");  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 603: hien thi 4 hang 4 ki tu A B C D 4 goc 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_603_lcd_ht_4kytu_4goc() 
.................... { 
....................    
....................   lcd_command(lcd_addr_line1); 
....................   lcd_data("A");  
....................    
....................   lcd_command(lcd_addr_line2); 
....................   lcd_data("                   B");  
....................    
....................   lcd_command(lcd_addr_line3); 
....................   lcd_data("  C");  
....................    
....................   lcd_command(lcd_addr_line4); 
....................   lcd_data("                 D");  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 604: hien thi 2 hang ki tu va dich trai sau 1 khoang thoi gian tre 1 giay 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_604_lcd_ht_2hang_dich_trai() 
.................... { 
....................    
....................   lcd_command(lcd_addr_line1); 
....................   lcd_data("khoa dien - dien tu ");  
....................    
....................   lcd_command(lcd_addr_line2); 
....................   lcd_data("bm dientucong nghiep");  
....................   delay_ms(1000); 
....................   lcd_command(lcd_shift_left); 
....................   delay_ms(1000); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 605: hien thi 2 hang ki tu va dich phai sau 1 khoang thoi gian tre 1 giay 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_605_lcd_ht_2hang_dich_phai() 
.................... { 
....................    
....................   lcd_command(lcd_addr_line1); 
....................   lcd_data("khoa dien - dien tu ");  
....................    
....................   lcd_command(lcd_addr_line2); 
....................   lcd_data("bm dientucong nghiep");  
....................   delay_ms(1000); 
....................   lcd_command(lcd_shift_right); 
....................   delay_ms(1000); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 606: hien thi 2 hang ki tu va dich trai 2 hang tren xuong 3 hang duoi r dich phai tro lai 2 hang tren r lap lai sau 1 khoang thoi gian tre 1 giay 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_606_lcd_ht_2hang_dich_2c() 
.................... { 
....................    
....................   lcd_command(lcd_addr_line1); 
....................   lcd_data("khoa dien - dien tu ");  
....................    
....................   lcd_command(lcd_addr_line2); 
....................   lcd_data("bm dientucong nghiep");  
....................   delay_ms(1000); 
....................    for(i=0;i<20;i++) 
....................   { 
....................    lcd_command(lcd_shift_left); 
....................    delay_ms(1000); 
....................   } 
....................   for(i=0;i<20;i++) 
....................   { 
....................    lcd_command(lcd_shift_right); 
....................    delay_ms(1000); 
....................   } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 611: hien thi lcd dem giay 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_611_lcd_hienthi_dongho() 
.................... { 
....................    lcd_goto_xy(0,18); 
....................    delay_us(20); 
....................    lcd_data(giay/10 + 0x30); 
....................    lcd_data(giay%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_611_lcd_ht_dem_giay() 
.................... { 
....................   lcd_goto_xy(0,0); 
....................   lcd_data("DONG HO:"); 
....................   ham_611_lcd_hienthi_dongho(); 
....................   delay_ms(1000); 
....................   giay++; 
....................   if(giay==60) giay=0; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 612: hien thi lcd dem phut giay 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_612_lcd_hienthi_dongho() 
.................... { 
....................    lcd_goto_xy(0,15); 
....................    delay_us(20); 
....................    lcd_data(phut/10 + 0x30); 
....................    lcd_data(phut%10 + 0x30); 
....................    lcd_data("-"); 
....................    lcd_data(giay/10 + 0x30); 
....................    lcd_data(giay%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_612_lcd_ht_dem_phut_giay() 
.................... { 
....................   lcd_goto_xy(0,0); 
....................   lcd_data("DONG HO:"); 
....................   ham_612_lcd_hienthi_dongho(); 
....................   delay_ms(1000); 
....................   giay++; 
....................   if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................          phut=0; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 613: hien thi lcd dem gio phut giay 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_613_lcd_hienthi_dongho() 
.................... { 
....................    lcd_goto_xy(0,12); 
....................    delay_us(20); 
....................    lcd_data(gio/10 + 0x30); 
....................    lcd_data(gio%10 + 0x30); 
....................    lcd_data("-"); 
....................    lcd_data(phut/10 + 0x30); 
....................    lcd_data(phut%10 + 0x30); 
....................    lcd_data("-"); 
....................    lcd_data(giay/10 + 0x30); 
....................    lcd_data(giay%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_613_lcd_ht_dem_gio_phut_giay() 
.................... { 
....................   lcd_goto_xy(0,0); 
....................   lcd_data("DONG HO:"); 
....................   ham_613_lcd_hienthi_dongho(); 
....................   delay_ms(1000); 
....................   giay++; 
....................   if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 614: hien thi lcd dem gio phut giay chinh xac co 3 nut nhan chinh thoi gian 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_614_lcd_hienthi_dongho() 
.................... { 
....................    lcd_goto_xy(0,12); 
....................    delay_us(20); 
....................    lcd_data(gio/10 + 0x30); 
....................    lcd_data(gio%10 + 0x30); 
....................    lcd_data("-"); 
....................    lcd_data(phut/10 + 0x30); 
....................    lcd_data(phut%10 + 0x30); 
....................    lcd_data("-"); 
....................    lcd_data(giay/10 + 0x30); 
....................    lcd_data(giay%10 + 0x30); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(gia_tri_mod + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_614_phim_mod() 
.................... { 
....................    if(phim_bt1_c2(60)) 
....................    { 
....................          gia_tri_mod++; 
....................          if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................          dem_tg_exit=0; 
....................    }  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_614_phim_up() 
.................... { 
....................    if(phim_bt0_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==23) gio=0; 
....................                     else        gio++; 
....................                     break; 
....................             case 2: if(phut==59) phut=0; 
....................                     else         phut++; 
....................                     break; 
....................             case 3: if(giay==59) giay=0; 
....................                     else         giay++;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_614_lcd_hienthi_dongho(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_614_phim_dw() 
.................... { 
....................    if(phim_bt2_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==0) gio=23; 
....................                     else        gio--; 
....................                     break; 
....................             case 2: if(phut==0) phut=59; 
....................                     else         phut--; 
....................                     break; 
....................             case 3: if(giay==0) giay=59; 
....................                     else         giay--;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_614_lcd_hienthi_dongho(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_614_lcd_gio_phut_giay() 
.................... { 
....................  
....................   lcd_goto_xy(0,0); 
....................   lcd_data("DONG HO:"); 
....................   ham_614_lcd_hienthi_dongho(); 
....................   if(bdn<10) 
....................   { 
....................    ham_614_phim_mod(); 
....................    ham_614_phim_up(); 
....................    ham_614_phim_dw();    
....................   } 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    dem_tg_exit++; 
....................    if(dem_tg_exit==20) gia_tri_mod=0; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
....................        
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 615: hien thi lcd dem gio phut giay chinh xac co 3 nut nhan chinh thoi gian va hien thi tren 8led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_615_lcd_hienthi_dongho() 
.................... { 
....................    lcd_goto_xy(0,12); 
....................    delay_us(20); 
....................    lcd_data(gio/10 + 0x30); 
....................    lcd_data(gio%10 + 0x30); 
....................    lcd_data("-"); 
....................    lcd_data(phut/10 + 0x30); 
....................    lcd_data(phut%10 + 0x30); 
....................    lcd_data("-"); 
....................    lcd_data(giay/10 + 0x30); 
....................    lcd_data(giay%10 + 0x30); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(gia_tri_mod + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_615_tat_2led_chinh() 
.................... { 
....................    if       (gia_tri_mod==1) {led_7dq[7]=0xff; led_7dq[6]=0xff;} 
....................    else if  (gia_tri_mod==2) {led_7dq[4]=0xff; led_7dq[3]=0xff;} 
....................    else if  (gia_tri_mod==3) {led_7dq[1]=0xff; led_7dq[0]=0xff;} 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_615_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[3]=ma7doan[phut%10]; 
....................    led_7dq[4]=ma7doan[phut/10]; 
....................    led_7dq[6]=ma7doan[gio%10]; 
....................    led_7dq[7]=ma7doan[gio/10]; 
....................    if(gia_tri_mod==1)   led_7dq[6]=led_7dq[6] & 0x7f; 
....................    else if(gia_tri_mod==2)   led_7dq[3]=led_7dq[3] & 0x7f; 
....................    else if(gia_tri_mod==3)   led_7dq[0]=led_7dq[0] & 0x7f; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_615_phim_mod() 
.................... { 
....................    if(phim_bt1_c2(60)) 
....................    { 
....................          gia_tri_mod++; 
....................          if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................          dem_tg_exit=0; 
....................    }  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_615_phim_up() 
.................... { 
....................    if(phim_bt0_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==23) gio=0; 
....................                     else        gio++; 
....................                     break; 
....................             case 2: if(phut==59) phut=0; 
....................                     else         phut++; 
....................                     break; 
....................             case 3: if(giay==59) giay=0; 
....................                     else         giay++;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_615_giai_ma_gan_cho_8led_quet(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_615_phim_dw() 
.................... { 
....................    if(phim_bt2_c2(60)) 
....................    { 
....................          dem_tg_exit=0; 
....................          switch(gia_tri_mod) 
....................          { 
....................             case 1: if(gio==0) gio=23; 
....................                     else        gio--; 
....................                     break; 
....................             case 2: if(phut==0) phut=59; 
....................                     else         phut--; 
....................                     break; 
....................             case 3: if(giay==0) giay=59; 
....................                     else         giay--;   
....................                     break; 
....................             default: break;         
....................          } 
....................          ham_615_giai_ma_gan_cho_8led_quet(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_615_lcd_8led_gio_phut_giay() 
.................... { 
....................  
....................   lcd_goto_xy(0,0); 
....................   lcd_data("DONG HO:"); 
....................   ham_615_lcd_hienthi_dongho(); 
....................   ham_517_giai_ma_gan_cho_8led_quet(); 
....................   if(bdn<10) 
....................   { 
....................    if(gia_tri_mod!=0) 
....................    { 
....................       if((bdn==0) &&(input(bt0))&&(input(bt2))) 
....................          ham_615_tat_2led_chinh(); 
....................       else if(bdn==5) ham_615_giai_ma_gan_cho_8led_quet(); 
....................    } 
....................    hien_thi_8led_7doan_quet(); 
....................    ham_615_phim_mod(); 
....................    ham_615_phim_up(); 
....................    ham_615_phim_dw(); 
....................     
....................   } 
....................   else 
....................   { 
....................    bdn=bdn-10; 
....................    dem_tg_exit++; 
....................    if(dem_tg_exit==20) gia_tri_mod=0; 
....................    giay++; 
....................    if(giay==60) 
....................    { 
....................       giay=0; 
....................       phut++; 
....................       if(phut==60) 
....................       { 
....................          phut=0; 
....................          gio++; 
....................          if(gio==24) 
....................             gio=0; 
....................       } 
....................    } 
....................        
....................   }   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 616:dem sp dung counter t0 hien thi tren lcd 20x4 o hang thu 1 va hien thi tren 4 led 7 doan, gioi han 000 - 100 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_616_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,17); 
....................    lcd_data(t0/100 + 0x30); 
....................    lcd_data(t0/10%10 + 0x30); 
....................    lcd_data(t0%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_616_lcd_4led_dem_sp_t0() 
.................... { 
....................    ham_616_hienthi_lcd(); 
....................    xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    do 
....................    { 
....................       t0=get_timer0(); 
....................    }while(t0==t0_tam); 
....................    if(t0>=101) set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 617:dem sp dung counter t0 hien thi tren lcd 20x4 o hang thu 1 va hien thi tren 4 led 7 doan 
.................... //co 3 nut nhan de cai gioi han dem (01-99) 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_617_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("GIA TRI CAI: "); 
....................    lcd_goto_xy(0,17); 
....................    lcd_data(gioi_han/10 + 0x30); 
....................    lcd_data(gioi_han%10 + 0x30); 
....................     
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data("GIA TRI DEM: "); 
....................    lcd_goto_xy(1,17); 
....................    lcd_data(t0/100 + 0x30); 
....................    lcd_data(t0/10%10 + 0x30); 
....................    lcd_data(t0%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_617_phim_up() 
.................... {   
....................    if(phim_bt0_c2(60)) 
....................    { 
....................       if(gioi_han<99) 
....................          gioi_han++; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_617_phim_dw() 
.................... {   
....................    if(phim_bt1_c2(60)) 
....................    { 
....................       if(gioi_han>1) 
....................          gioi_han--; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_617_phim_clr() 
.................... {   
....................    if(phim_bt2_c2(60)) 
....................    { 
....................       gioi_han=1; 
....................       set_timer0(00); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_617_lcd_4led_dem_sp_t0_ud() 
.................... { 
....................    ham_617_hienthi_lcd(); 
....................    ham_617_phim_up(); 
....................    ham_617_phim_dw(); 
....................    ham_617_phim_clr(); 
....................    xuat_4led_7doan_2_so_xoa_so0(gioi_han,t0); 
....................    do 
....................    { 
....................       t0=get_timer0(); 
....................    }while(t0==t0_tam); 
....................    if(t0>=(gioi_han+1)) set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 621:nhan phim bat ky cua ma tran phim thi xuat hien o vi tri dau tien bên phai hang 2. Neu nhan phim tiep theo thi so truoc do mat 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_621_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(1,19); 
....................    if(mp<10) lcd_data(mp + 0x30); 
....................    else      lcd_data(mp+0x37); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_621_lcd_key4x4() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("HAY NHAN PHIM"); 
....................    do 
....................    { 
....................       mp=key_4x4_up(); 
....................    }while(mp==0xff); 
....................    ham_621_hienthi_lcd(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 622:nhan phim bat ky cua ma tran phim thi xuat hien o vi tri dau tien bên phai hang 2. Neu nhan phim tiep theo thi so truoc do dich qua trai 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_622_lcd_key4x4_dich() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("HAY NHAN PHIM"); 
....................    lcd_goto_xy(1,0); 
....................    for (i=0;i<20;i++) { lcd_data(hang2[i]); } 
....................    do {mp=key_4x4_dw();} 
....................    while(mp==0xff); 
....................    for(i=0;i<19;i++) 
....................    { 
....................       hang2[i]=hang2[i+1];   
....................    } 
....................    if(mp<10) 
....................       hang2[19]=(mp+0x30); 
....................    else  
....................       hang2[19]=(mp+0x37); 
....................    lcd_goto_xy(1,0); 
....................    for (i=0;i<20;i++) { lcd_data(hang2[i]); } 
....................     
....................     
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 623:nhan phim bat ky cua ma tran phim thi xuat hien o vi tri dau tien bên phai hang 1. Neu nhan phim tiep theo thi so truoc do dich qua trai. Du hang 1 se dich xuong 2 3 4 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_623_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    for (i=0;i<20;i++) { lcd_data(hang1234[i+60]); } 
....................    lcd_goto_xy(1,0); 
....................    for (i=0;i<20;i++) { lcd_data(hang1234[i+40]); } 
....................    lcd_goto_xy(2,0); 
....................    for (i=0;i<20;i++) { lcd_data(hang1234[i+20]); } 
....................    lcd_goto_xy(3,0); 
....................    for (i=0;i<20;i++) { lcd_data(hang1234[i]); } 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_623_lcd_key4x4_dich_4hang_1234() 
.................... { 
....................    ham_623_hienthi_lcd(); 
....................    do {mp=key_4x4_dw();} 
....................    while(mp==0xff); 
....................    for(i=0;i<79;i++) 
....................    { 
....................       hang1234[i]=hang1234[i+1];   
....................    } 
....................     
....................    if(mp<10) 
....................       hang1234[79]=(mp+0x30); 
....................    else  
....................       hang1234[79]=(mp+0x37); 
....................  
....................    ham_623_hienthi_lcd(); 
....................     
....................     
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 624:ht 2 hang. Nhan A buzzer keu ung voi thoi gian Y(dc nhap tu ban phim 0-9). 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_624_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(1,17); 
....................    lcd_data(mp1 + 0x30); 
....................    if(flag==1) 
....................     { 
....................       lcd_goto_xy(1,8); 
....................       lcd_data("ON "); 
....................    }   
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_624_lcd_key4x4_dich() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("DIEU KHIEN BUZZER"); 
....................    lcd_goto_xy(1,0); 
....................    lcd_data("BUZZER: OFF, TG: "); 
....................    do  
....................    { 
....................       mp=key_4x4_dw(); 
....................    } 
....................    while(mp==0xff); 
....................    if(mp<10) 
....................    { 
....................       mp1=mp;  
....................       flag=0; 
....................       ham_624_hienthi_lcd(); 
....................    } 
....................    if(mp==0x0A) 
....................    { 
....................       flag=1; 
....................       buzzer_on(); 
....................       ham_624_hienthi_lcd(); 
....................       delay_ms(mp1*1000); 
....................       flag=0; 
....................       buzzer_off();             
....................    }                    
....................    ham_624_hienthi_lcd();  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 625:giong 617 nhung su dung ma tran phim de cai gioi han 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_625_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("GIA TRI CAI: "); 
....................    lcd_goto_xy(0,17); 
....................    lcd_data(gioi_han/10 + 0x30); 
....................    lcd_data(gioi_han%10 + 0x30); 
....................     
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data("GIA TRI DEM: "); 
....................    lcd_goto_xy(1,17); 
....................    lcd_data(t0/100 + 0x30); 
....................    lcd_data(t0/10%10 + 0x30); 
....................    lcd_data(t0%10 + 0x30); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_625_lcd_4led_dem_sp_t0_matrix_key() 
.................... { 
....................    xuat_4led_7doan_2_so_xoa_so0(gioi_han,t0); 
....................    ham_625_hienthi_lcd(); 
....................    t0_tam=t0; 
....................  
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       ham_625_hienthi_lcd(); 
....................       xuat_4led_7doan_2_so_xoa_so0(gioi_han,t0); 
....................    } 
....................    if(t0>=(gioi_han+1)) set_timer0(1); 
....................     
....................    mp=key_4x4_dw(); 
....................    if(mp!=0xff) 
....................    { 
....................       gioi_han_tam[0]=gioi_han_tam[1]; 
....................       gioi_han_tam[1]=mp;      
....................       if(mp==0x0C) 
....................          { 
....................             gioi_han_tam[0]=0; 
....................             gioi_han_tam[1]=1; 
....................          } 
....................       gioi_han=gioi_han_tam[0]*10+gioi_han_tam[1]; 
....................       ham_625_hienthi_lcd(); 
....................       xuat_4led_7doan_2_so_xoa_so0(gioi_han,t0); 
....................    } 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 631:HIEN THI TRAI TIM 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_631_ht_trai_tim() 
.................... { 
....................    unsigned char hang2[]={0x0a,0x15,0x11,0x11,0x0a,0x04,0,0}; 
....................     signed int8 i; 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("Hien thi trai tim"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<8;i++) lcd_data(hang2[i]); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(0); 
....................   while(true); 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 632:HIEN THI 20 TRAI TIM 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_632_ht_20_traitim() 
.................... { 
....................    unsigned char hang2[]={0x0a,0x15,0x11,0x11,0x0a,0x04,0,0}; 
....................     signed int8 i; 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("Hien thi trai tim"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<8;i++) lcd_data(hang2[i]); 
....................     
....................    lcd_goto_xy(1,0); 
....................    for(i=0;i<20;i++) 
....................       lcd_data(0); 
....................   while(true); 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 633:HIEN THI 3 ky tu trai tim - hinh thoi - hinh vuong 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_633_lcd_3kytu() 
.................... { 
....................    unsigned char hang1[]={0x0a,0x15,0x11,0x11,0x0a,0x04,0,0};//trai tim 
....................    unsigned char hang2[]={0x1f,0x11,0x11,0x11,0x11,0x1f,0,0};//hinh vuong 
....................    unsigned char hang3[]={0x04,0x0a,0x11,0x0a,0x04,0,0,0};//hinh thoi 
....................     signed int8 i; 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("Hien thi 3 ky tu"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<8;i++) lcd_data(hang1[i]); 
....................     
....................    lcd_command(0x48); 
....................    for(i=0;i<8;i++) lcd_data(hang2[i]); 
....................     
....................    lcd_command(0x50); 
....................    for(i=0;i<8;i++) lcd_data(hang3[i]); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(0); 
....................    lcd_data(1); 
....................    lcd_data(2); 
....................   while(true); 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 634:HIEN THI 8 ky tu bat ky 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_634_lcd_8kytu() 
.................... { 
....................    unsigned char hang1[]={0x0a,0x15,0x11,0x11,0x0a,0x04,0,0};//trai tim 
....................    unsigned char hang2[]={0x1f,0x11,0x11,0x11,0x11,0x1f,0,0};//hinh vuong 
....................    unsigned char hang3[]={0x04,0x0a,0x11,0x0a,0x04,0,0,0};//hinh thoi 
....................    unsigned char hang4[]={0,0,0x04,0x0a,0x1f,0,0,0};//tam giac 
....................    unsigned char hang5[]={0x1f,0x11,0x11,0x11,0x11,0x11,0x11,0x1f};// hinh chu nhat 
....................    unsigned char hang6[]={0x04,0x0a,0x11,0x11,0x11,0x11,0x1f,0};//ngoi nha  
....................    unsigned char hang7[]={0x0e,0x11,0x11,0x11,0x0e,0,0,0};//hinh bat giac  
....................    unsigned char hang8[]={0x04,0x0a,0x11,0x11,0x11,0x0a,0x04,0}; //hinh luc giac 
....................     signed int8 i; 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("Hien thi 8 ky tu"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<8;i++) lcd_data(hang1[i]); 
....................     
....................    lcd_command(0x48); 
....................    for(i=0;i<8;i++) lcd_data(hang2[i]); 
....................     
....................    lcd_command(0x50); 
....................    for(i=0;i<8;i++) lcd_data(hang3[i]); 
....................     
....................    lcd_command(0x58); 
....................    for(i=0;i<8;i++) lcd_data(hang4[i]); 
....................     
....................    lcd_command(0x60); 
....................    for(i=0;i<8;i++) lcd_data(hang5[i]); 
....................     
....................    lcd_command(0x68); 
....................    for(i=0;i<8;i++) lcd_data(hang6[i]); 
....................     
....................    lcd_command(0x70); 
....................    for(i=0;i<8;i++) lcd_data(hang7[i]); 
....................     
....................    lcd_command(0x78); 
....................    for(i=0;i<8;i++) lcd_data(hang8[i]); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(0); lcd_data(1); lcd_data(2); lcd_data(3); 
....................    lcd_data(4); lcd_data(5); lcd_data(6); lcd_data(7);   
....................   while(true); 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 635:HIEN THI bieu tuong apple 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_635_lcd_apple() 
.................... { 
....................    unsigned char hang1[]={0,0,0,0,0x0f,0x0f,0x1f,0x1f}; 
....................    unsigned char hang2[]={0x08,0x08,0x18,0x10,0x1e,0x1f,0x1e,0x1c}; 
....................    unsigned char hang3[]={0x1f,0x1f,0x1f,0x1f,0x0f,0x0f,0x07,0x07}; 
....................    unsigned char hang4[]={0x1c,0x1c,0x1e,0x1f,0x1f,0x1c,0x1c,0x0c}; 
....................     signed int8 i; 
....................     lcd_goto_xy(0,0); 
....................     lcd_data("BIEU TUONG APPLE"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<8;i++) lcd_data(hang1[i]); 
....................     
....................    lcd_command(0x48); 
....................    for(i=0;i<8;i++) lcd_data(hang2[i]); 
....................     
....................    lcd_command(0x50); 
....................    for(i=0;i<8;i++) lcd_data(hang3[i]); 
....................     
....................    lcd_command(0x58); 
....................    for(i=0;i<8;i++) lcd_data(hang4[i]); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(0);  
....................    lcd_data(1);  
....................    lcd_goto_xy(2,0); 
....................    lcd_data(2);  
....................    lcd_data(3); 
....................  
....................   while(true); 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 636:HIEN THI bieu tuong apple di chuyen tu phai sang trai r tu trai sang phai 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_636_lcd_apple_dichchuyen() 
.................... { 
....................    unsigned char hang1[]={0,0,0,0,0x0f,0x0f,0x1f,0x1f}; 
....................    unsigned char hang2[]={0x08,0x08,0x18,0x10,0x1e,0x1f,0x1e,0x1c}; 
....................    unsigned char hang3[]={0x1f,0x1f,0x1f,0x1f,0x0f,0x0f,0x07,0x07}; 
....................    unsigned char hang4[]={0x1c,0x1c,0x1e,0x1f,0x1f,0x1c,0x1c,0x0c}; 
....................     signed int8 i; 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("BIEU TUONG APPLE"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<8;i++) lcd_data(hang1[i]); 
....................     
....................    lcd_command(0x48); 
....................    for(i=0;i<8;i++) lcd_data(hang2[i]); 
....................     
....................    lcd_command(0x50); 
....................    for(i=0;i<8;i++) lcd_data(hang3[i]); 
....................     
....................    lcd_command(0x58); 
....................    for(i=0;i<8;i++) lcd_data(hang4[i]); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(0);  
....................    lcd_data(1);  
....................    lcd_goto_xy(2,0); 
....................    lcd_data(2);  
....................    lcd_data(3); 
....................    delay_ms(500); 
....................     
....................    for(i=0;i<18;i++) 
....................    { 
....................       lcd_goto_xy(1,i); 
....................       lcd_data(" "); 
....................       lcd_data(0);  
....................       lcd_data(1); 
....................       lcd_goto_xy(2,i); 
....................       lcd_data(" "); 
....................       lcd_data(2);  
....................       lcd_data(3);   
....................       delay_ms(500); 
....................    } 
....................    for(i=17;i>=0;i--) 
....................    { 
....................       lcd_goto_xy(1,i); 
....................       lcd_data(0);  
....................       lcd_data(1); 
....................       lcd_data(" "); 
....................       lcd_goto_xy(2,i); 
....................       lcd_data(2);  
....................       lcd_data(3);  
....................       lcd_data(" "); 
....................       delay_ms(500); 
....................    } 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 641:HIEN THI ky tu so 0, moi con so chiem 6 ki tu tren lcd2004 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_641_lcd_so_0() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("hien thi so 0 hang 3"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
....................    lcd_hienthi_so_z_toado_xy(0,2,0); 
....................  
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 642:HIEN THI ky tu so 0123, moi con so chiem 6 ki tu tren lcd2004 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_642_lcd_so_0123() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("hien thi so 0123"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
....................    lcd_hienthi_so_z_toado_xy(0,2,0); 
....................    lcd_hienthi_so_z_toado_xy(1,2,4); 
....................    lcd_hienthi_so_z_toado_xy(2,2,8); 
....................    lcd_hienthi_so_z_toado_xy(3,2,12); 
....................  
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 643:dem tu 00-99 hien thi kich thuoc lon 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_643_lcd_dem_00_99() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("**dem tu so 00 den 99**"); 
....................    lcd_command(0x40); 
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
....................    lcd_hienthi_so_z_toado_xy(0,2,0); 
....................    for(dem=0;dem<100;dem++) 
....................    { 
....................       lcd_hienthi_so_z_toado_xy(dem/10,2,0); 
....................       lcd_hienthi_so_z_toado_xy(dem%10,2,3); 
....................       delay_ms(200); 
....................    } 
....................  
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 644:dem sp dung counter t0 hien thi tren lcd 20x4 o hang thu 1 va hien thi tren 4 led 7 doan, gioi han 000 - 100  
.................... //HIEN THI SO LON(HIEU CHINH BAI 616) 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_644_hienthi_lcd_ktl() 
.................... { 
....................    lcd_hienthi_so_z_toado_xy(t0/100,2,0); 
....................    lcd_hienthi_so_z_toado_xy(t0/10%10,2,3); 
....................    lcd_hienthi_so_z_toado_xy(t0%10,2,6); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_644_lcd_dem_sp_ktl() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("**DEM SAN PHAM**"); 
....................    ham_644_hienthi_lcd_ktl(); 
....................    lcd_command(0x40); 
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
....................    xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    do 
....................    { 
....................       t0=get_timer0(); 
....................    }while(t0==t0_tam); 
....................    if(t0>=101) set_timer0(1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //****GLCD**********************GLCD********************** 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 652:hien thi chuoi GLCD fornt 16x16 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_652_glcd_hien_thi_chuoi() 
.................... { 
....................    glcd_command(glcd_addr_line1); 
....................    glcd_data("dh-supham kt hcm"); 
....................     
....................    glcd_command(glcd_addr_line2); 
....................    glcd_data("bo mon dien tu"); 
....................     
....................    glcd_command(glcd_addr_line3); 
....................    glcd_data("cong nghiep"); 
....................     
....................    glcd_command(glcd_addr_line4); 
....................    glcd_data("thuc hanh vdk"); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 653:dem san pham dung counter t0 hien thi tren GLCD fornt 16x16 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_653_glcd_hienthi_t0(unsigned t0) 
.................... { 
....................    glcd_command(glcd_addr_line2); 
....................    glcd_data(t0/100 + 0x30); 
....................    glcd_data(t0/10%10 + 0x30); 
....................    glcd_data(t0%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_653_glcd_dem_sp_t0() 
.................... { 
....................    glcd_command(glcd_addr_line1); 
....................    glcd_data("dem san pham"); 
....................    t0=get_timer0(); 
....................    ham_653_glcd_hienthi_t0(t0); 
....................    if(t0!=t0_tam) 
....................    { 
....................       ham_653_glcd_hienthi_t0(t0); 
....................       t0_tam=t0; 
....................    } 
....................    xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    if(t0>=101) set_timer0(1); 
....................     
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 654:dem san pham dung counter t0 hien thi tren GLCD fornt 16x16,4led 7 doan va LCD 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_654_glcd_hienthi_t0(unsigned t0) 
.................... { 
....................    glcd_command(glcd_addr_line2); 
....................    glcd_data(t0/100 + 0x30); 
....................    glcd_data(t0/10%10 + 0x30); 
....................    glcd_data(t0%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_654_hienthi_lcd() 
.................... {  
....................    lcd_goto_xy(1,0); 
....................    lcd_data(t0/100 + 0x30); 
....................    lcd_data(t0/10%10 + 0x30); 
....................    lcd_data(t0%10 + 0x30); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_654_glcd_lcd_4led_dem_sp_t0() 
.................... { 
....................    glcd_command(glcd_addr_line1); 
....................    glcd_data("dem san pham"); 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("dem san pham"); 
....................    t0=get_timer0(); 
....................    ham_654_glcd_hienthi_t0(t0); 
....................    ham_654_hienthi_lcd(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................    } 
....................    xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    ham_654_glcd_hienthi_t0(t0); 
....................    ham_654_hienthi_lcd(); 
....................    if(t0>=101) set_timer0(1); 
....................     
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 661:hien thi logo DHSPKT tren glcd 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_661_glcd_bitmap_spkt() 
.................... { 
....................    glcd_mau_nen(0); 
....................    glcd_xuat_anh(64,64,32,0); 
....................    gdram_vdk_to_gdram_glcd_all (); 
....................     
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 662:hien thi 2 logo DHSPKT tren glcd 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_662_glcd_2bitmap_spkt() 
.................... { 
....................    glcd_mau_nen(0); 
....................    glcd_xuat_anh(64,64,64,0); 
....................    glcd_xuat_anh(64,64,0,0); 
....................    gdram_vdk_to_gdram_glcd_all (); 
....................     
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 663:ve duong thang, duong tron tren glcd 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_663_glcd_dt_dt() 
.................... { 
....................    glcd_mau_nen(0); 
....................    glcd_line(0,0,50,50,1); 
....................    glcd_circle(40,40,20,0,1); 
....................    gdram_vdk_to_gdram_glcd_all (); 
....................     
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 664: 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_664_hienthi() 
.................... { 
....................    glcd_rect(donvi*7,0,donvi*7+5,5,0,1); 
....................    glcd_rect(chuc*7,7,chuc*7+5,12,0,1); 
....................    glcd_rect(tram*7,14,tram*7+5,19,0,1); 
....................    gdram_vdk_to_gdram_glcd_all (); 
....................     
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_664_glcd_dem_sp_t0_ht_cot() 
.................... { 
....................    delay_ms(5); 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       donvi++; 
....................       t0_tam=t0; 
....................    } 
....................    ham_664_hienthi(); 
....................    if(donvi==10) 
....................    { 
....................       donvi=0; 
....................       chuc++; 
....................       glcd_rect(0,0,90,5,1,0); 
....................       if(chuc==10) 
....................       { 
....................          chuc=0; 
....................          tram++; 
....................          glcd_rect(0,7,90,12,1,0); 
....................          if(tram==10) 
....................          { 
....................             tram=0; 
....................             glcd_rect(0,14,90,19,1,0); 
....................          } 
....................       } 
....................    } 
....................    ham_664_hienthi(); 
....................     
....................     
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 665:VE VONG TRON VA KIM GIAY, VE DONG HO. DUNG T1 DINH THOI. 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... VOID ham_665_SO_LAMA() 
.................... { 
....................    // SO XII 
....................    GLCD_LINE(26, 2, 30, 6, 1); 
....................    GLCD_LINE(30, 2, 26, 6, 1); 
....................    GLCD_LINE(32, 2, 32, 6, 1); 
....................    GLCD_LINE(34, 2, 34, 6, 1); 
....................    // SO III 
....................    GLCD_LINE(56, 29, 56, 33, 1); 
....................    GLCD_LINE(58, 29, 58, 33, 1); 
....................    GLCD_LINE(60, 29, 60, 33, 1); 
....................    // SO VI 
....................    GLCD_LINE(27, 54, 29, 60, 1); 
....................    GLCD_LINE(31, 54, 29, 60, 1); 
....................    GLCD_LINE(33, 54, 33, 60, 1); 
....................    //SO IX 
....................    GLCD_LINE(3, 29, 3, 33, 1); 
....................    GLCD_LINE(5, 29, 9, 33, 1); 
....................    GLCD_LINE(9, 29, 5, 33, 1); 
....................    // 
....................    GLCD_CIRCLE(31, 31, 31, 0, 1); 
....................    GLCD_CIRCLE(31, 31, 2, 1, 1); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... VOID ham_665_DONGHO_TEXT() 
.................... { 
....................    GLCD_COMMAND(0x80 + 4); 
....................    GLCD_DATA("Dong Ho"); 
....................    // TEXT GIAY 
....................    GLCD_COMMAND(0x98 + 4); 
....................    GLCD_DATA("Giay:"); 
....................    GLCD_DATA(giay / 10 + 0x30); 
....................    GLCD_DATA(giay % 10 + 0x30); 
....................    GLCD_DATA("S"); 
....................    // TEXT PHUT 
....................    GLCD_COMMAND(0x88 + 4); 
....................    GLCD_DATA("Phut:"); 
....................    GLCD_DATA(phut / 10 + 0x30); 
....................    GLCD_DATA(phut % 10 + 0x30); 
....................    GLCD_DATA("P"); 
....................    // TEXT GIO 
....................    GLCD_COMMAND(0x94); 
....................    GLCD_DATA("Gio:"); 
....................    GLCD_DATA(gio / 10 + 0x30); 
....................    GLCD_DATA(gio % 10 + 0x30); 
....................    GLCD_DATA("H"); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_665_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("DONG HO: "); 
....................    lcd_data(gio/10 + 0x30); 
....................    lcd_data(gio%10 + 0x30); 
....................    lcd_data(":"); 
....................    lcd_data(phut/10+0x30); 
....................    lcd_data(phut%10+0x30); 
....................    lcd_data(":"); 
....................    lcd_data(giay/10+0x30); 
....................    lcd_data(giay%10+0x30); 
.................... } 
....................  //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... VOID BAI_655_GLCD_DEM_GIAY() 
.................... { 
....................    GDRAM_VDK_TO_GDRAM_GLCD_ALL(); 
....................    ham_665_hienthi_lcd(); 
....................    GLCD_CIRCLE(31, 31, 31, 0, 1); 
....................    GLCD_CIRCLE(31, 31, 2, 1, 1); 
....................    ham_665_SO_LAMA(); 
....................       IF(bdn < 10) 
....................       { 
....................       } 
....................  
....................       ELSE 
....................       { 
....................          bdn = 0; 
....................          giay++; 
....................          IF(giay == 60) 
....................          { 
....................             giay = 0; 
....................             phut++; 
....................             IF(phut == 60) 
....................             { 
....................                phut = 0; 
....................                gio++; 
....................                IF(gio == 13) 
....................                { 
....................                   gio = 0; 
....................                } 
....................             } 
....................          } 
....................  
....................          //SETUP_GLCD(0x30); 
....................          //DONGHO_TEXT(); 
....................          // KIM GIAY, PHUT, GIO 
....................          //GLCD_COMMAND(0x36); 
....................          GLCD_MAU_NEN(0); 
....................          GLCD_LINE(31, 31,(FLOAT)31 + 25 * sin((6 * 3.14) / 180 * giay),(float)31 - 24* cos((6 * 3.14) / 180 * giay), 1); 
....................          GLCD_LINE(31, 31,(FLOAT)31 + 20 * sin((6 * 3.14) / 180 * phut),(float)31 - 20 * cos((6 * 3.14) / 180 * phut), 1); 
....................          GLCD_LINE(31, 31,(FLOAT)31 + 12 * sin((6 * 3.14) / 180 * gio),(float)31 - 15 * cos((6 * 3.14) / 180 * gio), 1); 
....................           
....................          ham_665_SO_LAMA(); 
....................          ham_665_hienthi_lcd(); 
....................          GDRAM_VDK_TO_GDRAM_GLCD_ALL(); 
....................       } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 671:32led don chay quang cao || 8led quet dem gio phu giay || LCD GLCD,4led thi hien thi ket qua dem san pham tu t0 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_671_glcd_hienthi_t0() 
.................... { 
....................    glcd_command(glcd_addr_line2); 
....................    glcd_data(t0/100 + 0x30); 
....................    glcd_data(t0/10%10 + 0x30); 
....................    glcd_data(t0%10 + 0x30); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(t0/100 + 0x30); 
....................    lcd_data(t0/10%10 + 0x30); 
....................    lcd_data(t0%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_671_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[2]=0xbf; 
....................    led_7dq[3]=ma7doan[phut%10]; 
....................    led_7dq[4]=ma7doan[phut/10]; 
....................    led_7dq[5]=0xbf; 
....................    led_7dq[6]=ma7doan[gio%10]; 
....................    led_7dq[7]=ma7doan[gio/10]; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_671_tat_2led_chinh() 
.................... { 
....................    if     (gia_tri_mod == 1)    {led_7dq[7]=0xff;  led_7dq[6]=0xff;} 
....................    else if(gia_tri_mod == 2)    {led_7dq[4]=0xff;  led_7dq[3]=0xff;} 
....................    else if(gia_tri_mod == 3)    {led_7dq[1]=0xff;  led_7dq[0]=0xff;} 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_671_phim_mod() 
.................... { 
....................    if(phim_bt1_c2(50)) 
....................    { 
....................       gia_tri_mod++; 
....................       if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................       dem_tg_exit=0; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_671_phim_up() 
.................... { 
....................    if(phim_bt0_c2(50)) 
....................    { 
....................      dem_tg_exit=0; 
....................      switch (gia_tri_mod) 
....................      { 
....................          case 1:     if(gio==23)    gio=0; 
....................                      else           gio++; 
....................                      break; 
....................          case 2:     if(phut==59)    phut=0; 
....................                      else           phut++; 
....................                      break; 
....................          case 3:     if(giay==59)    giay=0; 
....................                      else           giay++; 
....................                      break;  
....................          default:    break;         
....................      } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_671_phim_dw() 
.................... { 
....................    if(phim_bt2_c2(20)) 
....................    { 
....................       dem_tg_exit=0; 
....................       switch (gia_tri_mod) 
....................       { 
....................          case 1:     if(gio==0)    gio=23; 
....................                      else           gio--; 
....................                      break; 
....................          case 2:     if(phut==0)    phut=59; 
....................                      else           phut--; 
....................                      break; 
....................          case 3:     if(giay==0)    giay=59; 
....................                      else           giay--; 
....................                      break;  
....................          default:    break;      
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_671_glcd_tonghop_5_module() 
.................... { 
....................    glcd_command(glcd_addr_line1); 
....................    glcd_data("dem san pham:"); 
....................    lcd_command(lcd_addr_line1); 
....................    lcd_data("lcd: dem san pham:"); 
....................    xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    ham_671_glcd_hienthi_t0(); 
....................    ham_671_giai_ma_gan_cho_8led_quet(); 
....................    if(bdn<10) 
....................      { 
....................          if((bdn<5)&&(input(bt0))&&(input(bt2))) 
....................             ham_671_tat_2led_chinh(); 
....................          hien_thi_8led_7doan_quet_all(); 
....................          ham_671_phim_mod(); 
....................          ham_671_phim_up(); 
....................          ham_671_phim_dw(); 
....................          t0=get_timer0(); 
....................          if(t0!=t0_tam) 
....................          { 
....................             t0_tam = t0; 
....................             ham_671_glcd_hienthi_t0(); 
....................             xuat_4led_7doan_giaima_xoa_so0(t0); 
....................             if (t0>=101)   set_timer0(1); 
....................          } 
....................             if (ttct_td==1) sang_tat_32led(2,1); 
....................             if (ttct_td==2) sang_tat_dan_pst_32led(5,1); 
....................             if (ttct_td==3) sang_tat_dan_tsp_32led(5,1); 
....................             if (ttct_td==4) sang_tat_dan_ngoai_vao_32led(5,1); 
....................             if (ttct_td==5) sang_tat_dan_trong_ra_32led(5,1); 
....................             if (ttct_td==6) sang_don_pst_32led(5,1); 
....................             if (ttct_td==7) diem_sang_dich_trai_mat_dan_32led(5,1); 
....................             if (ttct_td==8) sang_don_tsp_32led(5,1); 
....................             if (ttct_td==9) diem_sang_dich_phai_mat_dan_32led(5,1); 
....................             if (ttct_td==10) sang_tat_dan_trai_sang_phai_2x16led(5,1); 
....................             if (ttct_td==11) sang_tat_dan_phai_sang_trai_2x16led(5,1); 
....................             if (ttct_td==12) diem_sang_di_chuyen_pst_32led(5,1); 
....................             if (ttct_td==13) diem_sang_di_chuyen_tsp_32led(5,1); 
....................             if (ttct_td==14) sang_don_tnt_32led(5,1); 
....................             if (ttct_td==15) sang_don_ttr_32led(5,1); 
....................             if (ttct_td>15) ttct_td=1; 
....................      } 
....................      else 
....................      { 
....................          bdn = bdn-10; 
....................          dem_tg_exit++; 
....................          if (dem_tg_exit==20)  gia_tri_mod=0; 
....................          giay++; 
....................          if (giay==60)  
....................          { 
....................             giay = 0; 
....................             phut++; 
....................             if(phut==60) 
....................             { 
....................                phut=0; 
....................                gio++; 
....................                if(gio==24) gio=0; 
....................             } 
....................          } 
....................       } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 672:giong 671 nhung them logo su pham ky thuat 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_672_glcd_hienthi_t0() 
.................... { 
....................    glcd_command(glcd_addr_line2); 
....................    glcd_data(t0/100 + 0x30); 
....................    glcd_data(t0/10%10 + 0x30); 
....................    glcd_data(t0%10 + 0x30); 
....................     
....................    lcd_goto_xy(1,0); 
....................    lcd_data(t0/100 + 0x30); 
....................    lcd_data(t0/10%10 + 0x30); 
....................    lcd_data(t0%10 + 0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_672_giai_ma_gan_cho_8led_quet() 
.................... { 
....................    led_7dq[0]=ma7doan[giay%10]; 
....................    led_7dq[1]=ma7doan[giay/10]; 
....................    led_7dq[2]=0xbf; 
....................    led_7dq[3]=ma7doan[phut%10]; 
....................    led_7dq[4]=ma7doan[phut/10]; 
....................    led_7dq[5]=0xbf; 
....................    led_7dq[6]=ma7doan[gio%10]; 
....................    led_7dq[7]=ma7doan[gio/10]; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_672_tat_2led_chinh() 
.................... { 
....................    if     (gia_tri_mod == 1)    {led_7dq[7]=0xff;  led_7dq[6]=0xff;} 
....................    else if(gia_tri_mod == 2)    {led_7dq[4]=0xff;  led_7dq[3]=0xff;} 
....................    else if(gia_tri_mod == 3)    {led_7dq[1]=0xff;  led_7dq[0]=0xff;} 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_672_phim_mod() 
.................... { 
....................    if(phim_bt1_c2(50)) 
....................    { 
....................       gia_tri_mod++; 
....................       if(gia_tri_mod>=4)   gia_tri_mod=0; 
....................       dem_tg_exit=0; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_672_phim_up() 
.................... { 
....................    if(phim_bt0_c2(50)) 
....................    { 
....................      dem_tg_exit=0; 
....................      switch (gia_tri_mod) 
....................      { 
....................          case 1:     if(gio==23)    gio=0; 
....................                      else           gio++; 
....................                      break; 
....................          case 2:     if(phut==59)    phut=0; 
....................                      else           phut++; 
....................                      break; 
....................          case 3:     if(giay==59)    giay=0; 
....................                      else           giay++; 
....................                      break;  
....................          default:    break;         
....................      } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_672_phim_dw() 
.................... { 
....................    if(phim_bt2_c2(20)) 
....................    { 
....................       dem_tg_exit=0; 
....................       switch (gia_tri_mod) 
....................       { 
....................          case 1:     if(gio==0)    gio=23; 
....................                      else           gio--; 
....................                      break; 
....................          case 2:     if(phut==0)    phut=59; 
....................                      else           phut--; 
....................                      break; 
....................          case 3:     if(giay==0)    giay=59; 
....................                      else           giay--; 
....................                      break;  
....................          default:    break;      
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_672_glcd_tonghop_5_module() 
.................... { 
....................    setup_glcd(glcd_graphic_mode); 
....................    glcd_xuat_anh(64,64,64,0); 
....................    gdram_vdk_to_gdram_glcd_all(); 
....................    setup_glcd(glcd_text_mode); 
....................    glcd_command(glcd_addr_line1); 
....................    glcd_data("dem:"); 
....................    lcd_command(lcd_addr_line1); 
....................    lcd_data("lcd: dem san pham:"); 
....................    xuat_4led_7doan_giaima_xoa_so0(t0); 
....................    ham_672_glcd_hienthi_t0(); 
....................    ham_672_giai_ma_gan_cho_8led_quet(); 
....................     
....................    if(bdn<10) 
....................      { 
....................          if((bdn<5)&&(input(bt0))&&(input(bt2))) 
....................             ham_671_tat_2led_chinh(); 
....................          hien_thi_8led_7doan_quet_all(); 
....................          ham_672_phim_mod(); 
....................          ham_672_phim_up(); 
....................          ham_672_phim_dw(); 
....................          t0=get_timer0(); 
....................          if(t0!=t0_tam) 
....................          { 
....................             t0_tam = t0; 
....................             ham_672_glcd_hienthi_t0(); 
....................             xuat_4led_7doan_giaima_xoa_so0(t0); 
....................             if (t0>=101)   set_timer0(1); 
....................          } 
....................             if (ttct_td==1) sang_tat_32led(2,1); 
....................             if (ttct_td==2) sang_tat_dan_pst_32led(5,1); 
....................             if (ttct_td==3) sang_tat_dan_tsp_32led(5,1); 
....................             if (ttct_td==4) sang_tat_dan_ngoai_vao_32led(5,1); 
....................             if (ttct_td==5) sang_tat_dan_trong_ra_32led(5,1); 
....................             if (ttct_td==6) sang_don_pst_32led(5,1); 
....................             if (ttct_td==7) diem_sang_dich_trai_mat_dan_32led(5,1); 
....................             if (ttct_td==8) sang_don_tsp_32led(5,1); 
....................             if (ttct_td==9) diem_sang_dich_phai_mat_dan_32led(5,1); 
....................             if (ttct_td==10) sang_tat_dan_trai_sang_phai_2x16led(5,1); 
....................             if (ttct_td==11) sang_tat_dan_phai_sang_trai_2x16led(5,1); 
....................             if (ttct_td==12) diem_sang_di_chuyen_pst_32led(5,1); 
....................             if (ttct_td==13) diem_sang_di_chuyen_tsp_32led(5,1); 
....................             if (ttct_td==14) sang_don_tnt_32led(5,1); 
....................             if (ttct_td==15) sang_don_ttr_32led(5,1); 
....................             if (ttct_td>15) ttct_td=1; 
....................      } 
....................      else 
....................      { 
....................          bdn = bdn-10; 
....................          dem_tg_exit++; 
....................          if (dem_tg_exit==20)  gia_tri_mod=0; 
....................          giay++; 
....................          if (giay==60)  
....................          { 
....................             giay = 0; 
....................             phut++; 
....................             if(phut==60) 
....................             { 
....................                phut=0; 
....................                gio++; 
....................                if(gio==24) gio=0; 
....................             } 
....................          } 
....................       } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
....................  
....................  
....................  
....................  
.................... #include <chuong7_adc_cb.c>                           
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //TAT CA DEU VIET THEO BAI VA HAM THEO BAI 
.................... #define nd_tren 30 
.................... #define nd_duoi 25 
.................... #define gh_nda_tren 0x23 
.................... #define gh_nda_duoi 0x21 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... void khoi_tao_adc() 
.................... { 
....................    setup_adc(adc_clock_div_32); 
*
092C:  MOVF   FC0,W
092E:  ANDLW  C0
0930:  IORLW  02
0932:  MOVWF  FC0
0934:  BSF    FC0.7
0936:  BSF    FC2.0
....................    //setup_adc_ports(an0 | vss_vdd); 
....................    //set_adc_channel(0); 
....................    setup_adc_ports(an0_to_an1 | vss_vdd); 
0938:  MOVF   FC1,W
093A:  ANDLW  C0
093C:  IORLW  0D
093E:  MOVWF  FC1
0940:  GOTO   12F0 (RETURN)
....................    //set_adc_channel(2); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //Khai bao bien TT SANG SO -ADC,CAC CAM BIEN 
.................... unsigned int8 j,solan=100; 
.................... unsigned int16 lm35a=0,lm35b=0,gtcdt=35; 
.................... unsigned int16 kqadc; 
.................... float k_cach,clk_cach; 
.................... int1 ttqn=0; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 701: do nhiet do hien thi tren 4 led 7 doan dung adc kenh thu 0. Do trung binh 100 lan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_701_lm35a() 
.................... { 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_ms(1); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/solan; 
....................    xuat_4led_7doan_giaima_xoa_so0(lm35a); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 702: do nhiet do hien thi tren 4 led 7 doan dung adc kenh thu 0. Do trung binh 100 lan 
.................... // nhiet do qua 40 buzzer keu 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_702_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>nd_tren)&&(ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       buzzer_on(); 
....................    } 
....................    else if((lm35a>nd_tren)&&(ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       buzzer_off(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_702_lm35a_buzz() 
.................... { 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_ms(1); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/solan; 
....................    xuat_4led_7doan_giaima_xoa_so0(lm35a); 
....................    ham_702_so_sanh_dk_buzzer(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 703: do nhiet do hien thi tren 4 led 7 doan dung adc kenh thu 0. Do trung binh 100 lan 
.................... // che do mo den tu dong nhiet do qua 40 buzzer keu=> led tat de giam nhiet do va nguoc lai 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_703_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>nd_tren)&&(ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       buzzer_on(); 
....................       triac_2_off(); 
....................    } 
....................    else if((lm35a>nd_tren)&&(ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       buzzer_off(); 
....................    } 
....................    else if((lm35a<nd_duoi)&&(ttqn==0)) triac_2_on(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_703_lm35a_buzz_auto() 
.................... { 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_ms(1); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/solan; 
....................    xuat_4led_7doan_giaima_xoa_so0(lm35a); 
....................    ham_703_so_sanh_dk_buzzer(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 704: do nhiet do hien thi tren 4 led 7 doan va LCD chu to dung adc kenh thu 0. Do trung binh 100 lan 
.................... // che do mo den tu dong nhiet do qua 40 buzzer keu=> led tat de giam nhiet do va nguoc lai 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_704_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>nd_tren)&&(ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       buzzer_on(); 
....................       triac_2_off(); 
....................    } 
....................    else if((lm35a>nd_tren)&&(ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       buzzer_off(); 
....................    } 
....................    else if((lm35a<nd_duoi)&&(ttqn==0)) triac_2_on(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_704_hienthi_lcd() 
.................... { 
....................    lcd_hienthi_so_z_toado_xy(lm35a/10,2,0); 
....................    lcd_hienthi_so_z_toado_xy(lm35a%10,2,3);    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_704_lm35a_buzz_auto() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("hien thi nhiet do"); 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_ms(1); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/solan; 
....................    xuat_4led_7doan_giaima_xoa_so0(lm35a); 
....................    ham_704_hienthi_lcd(); 
....................    lcd_command(0x40); 
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
....................    ham_704_so_sanh_dk_buzzer(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 705: do nhiet do 2 kenh hien thi tren 4 led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_705_doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
....................    lm35a=0; 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_705_doc_nd_lm35b() 
.................... { 
....................    set_adc_channel(1); 
....................    lm35b=0; 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35b = lm35b + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35b=lm35b/2.046; 
....................    lm35b=lm35b/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_705_adc_2lm35() 
.................... { 
....................    ham_705_doc_nd_lm35a(); 
....................    ham_705_doc_nd_lm35b(); 
....................    xuat_4led_7doan_2_so(lm35b,lm35a); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 706: do nhiet do 2 kenh hien thi tren 4 led 7 doan co auto 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_706_doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
....................    lm35a=0; 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_706_doc_nd_lm35b() 
.................... { 
....................    set_adc_channel(1); 
....................    lm35b=0; 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35b = lm35b + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35b=lm35b/2.046; 
....................    lm35b=lm35b/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_706_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>nd_tren|| lm35b>nd_tren) && (ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       //buzzer_on(); 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................       triac_2_off(); 
....................    } 
....................    else if((lm35a<nd_tren) && (lm35b<nd_tren) && (ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       //buzzer_off(); 
....................       xuat_32led_don_4byte(0,0,0,0); 
....................    } 
....................    else if((lm35a<nd_duoi) && (lm35b<nd_duoi) && (ttqn==0)) triac_2_on(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_706_2lm35_buzz() 
.................... { 
....................    ham_706_doc_nd_lm35a(); 
....................    ham_706_doc_nd_lm35b(); 
....................    ham_706_so_sanh_dk_buzzer(); 
....................    xuat_4led_7doan_2_so(lm35b,lm35a); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 707: cai tien 706 them hien thi LCD so to 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_707_doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
....................    lm35a=0;  
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_707_doc_nd_lm35b() 
.................... { 
....................    set_adc_channel(1); 
....................    lm35b=0; 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35b = lm35b + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35b=lm35b/2.046; 
....................    lm35b=lm35b/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_707_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>nd_tren|| lm35b>nd_tren) && (ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       //buzzer_on(); 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................       triac_2_off(); 
....................    } 
....................    else if((lm35a<nd_tren) && (lm35b<nd_tren) && (ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       //buzzer_off(); 
....................       xuat_32led_don_4byte(0,0,0,0); 
....................    } 
....................    else if((lm35a<nd_duoi) && (lm35b<nd_duoi) && (ttqn==0)) triac_2_on(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_707_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("LM35A: "); 
....................    lcd_hienthi_so_z_toado_xy(lm35a/10,0,9); 
....................    lcd_hienthi_so_z_toado_xy(lm35a%10,0,12);  
....................    lcd_goto_xy(3,0); 
....................    lcd_data("LM35B: "); 
....................    lcd_hienthi_so_z_toado_xy(lm35b/10,2,9); 
....................    lcd_hienthi_so_z_toado_xy(lm35b%10,2,12);      
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_707_2lm35_lcd() 
.................... { 
....................    ham_707_doc_nd_lm35a(); 
....................    ham_707_doc_nd_lm35b(); 
....................    ham_707_so_sanh_dk_buzzer(); 
....................    xuat_4led_7doan_2_so(lm35b,lm35a); 
....................    ham_707_hienthi_lcd(); 
....................    lcd_command(0x40); 
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 708: do nhiet do hien thi tren 4 led 7 doan  
.................... // doc gia tri T0 dem san pham 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_708_lm35a_counter_t0() 
.................... { 
....................    for(j=0;j<solan/2;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_ms(1); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/(solan/2); 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       if(t0>=100) set_timer0(1); 
....................    } 
....................    xuat_4led_7doan_2_so_xoa_so0(t0,lm35a); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 709: do nhiet do hien thi tren 4 led 7 doan  
.................... // 2 led hien thi nhiet do, 2 led hien thi gia tri cai co the tuy chinh bang nut nhan UP DW 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_709_doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
....................    lm35a=0;  
....................    for(j=0;j<solan/2;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/(solan/2);    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_709_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>gtcdt) && (ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       //buzzer_on(); 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................       triac_2_off(); 
....................    } 
....................    else if((lm35a<gtcdt) && (ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       //buzzer_off(); 
....................       xuat_32led_don_4byte(0,0,0,0); 
....................    } 
....................    else if((lm35a<(gtcdt-5)) && (ttqn==0)) triac_2_on(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_709_phim_up() 
.................... { 
....................    if((!input(up)) && (gtcdt<60)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(up)) 
....................       { 
....................          gtcdt++; 
....................          xuat_4led_7doan_2_so_xoa_so0(gtcdt,lm35a); 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_709_phim_dw() 
.................... { 
....................    if((!input(dw)) && (gtcdt>35)) 
....................    { 
....................       delay_ms(10); 
....................       if(!input(dw)) 
....................       { 
....................          gtcdt--; 
....................          xuat_4led_7doan_2_so_xoa_so0(gtcdt,lm35a); 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_709_lm35_up_dw() 
.................... { 
....................    ham_709_doc_nd_lm35a(); 
....................    ham_709_phim_up(); 
....................    ham_709_phim_dw(); 
....................    ham_709_so_sanh_dk_buzzer(); 
....................    xuat_4led_7doan_2_so(gtcdt,lm35a); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 710: do 2 kenh nhiet do adc hien thi tren lcd va dem san pham 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_710_doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
....................    lm35a=0;  
....................    for(j=0;j<solan/2;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/(solan/2);    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_710_doc_nd_lm35b() 
.................... { 
....................    set_adc_channel(1); 
....................    lm35b=0; 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35b = lm35b + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35b=lm35b/2.046; 
....................    lm35b=lm35b/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_710_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>nd_tren|| lm35b>nd_tren) && (ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       //buzzer_on(); 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................       triac_2_off(); 
....................    } 
....................    else if((lm35a<nd_tren) && (lm35b<nd_tren) && (ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       //buzzer_off(); 
....................       xuat_32led_don_4byte(0,0,0,0); 
....................    } 
....................    else if((lm35a<nd_duoi) && (lm35b<nd_duoi) && (ttqn==0)) triac_2_on(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_710_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("NHIET DO LM35A: "); 
....................    lcd_data(lm35a/10+0x30); 
....................    lcd_data(lm35a%10+0x30);  
....................    lcd_goto_xy(1,0); 
....................    lcd_data("NHIET DO LM35B: "); 
....................    lcd_data(lm35b/10+0x30); 
....................    lcd_data(lm35b%10+0x30); 
....................    lcd_goto_xy(2,0); 
....................    lcd_data("DEM SAN PHAM: "); 
....................    lcd_data(t0/10+0x30); 
....................    lcd_data(t0%10+0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_710_lm35_counter_lcd() 
.................... { 
....................    ham_710_doc_nd_lm35a(); 
....................    ham_710_doc_nd_lm35b(); 
....................    ham_710_so_sanh_dk_buzzer(); 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       ham_710_hienthi_lcd(); 
....................    } 
....................    ham_710_hienthi_lcd(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 711: do khoang cach dung led thu phat voi do phan giai 10cm 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_711_gp2d12_ss10cm() 
.................... { 
....................    kqadc=read_adc(); 
....................    delay_ms(30); 
....................    if     (kqadc>=490) k_cach=10; 
....................    else if(kqadc>=276) k_cach=20; 
....................    else if(kqadc>=194) k_cach=30; 
....................    else if(kqadc>=150) k_cach=40; 
....................    else if(kqadc>=122) k_cach=50; 
....................    else if(kqadc>=106) k_cach=60; 
....................    else if(kqadc>=96)  k_cach=70; 
....................    else if(kqadc>=80)  k_cach=80; 
....................    xuat_4led_7doan_giaima_xoa_so0(k_cach); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 712: do khoang cach dung led thu phat voi do phan giai 1cm 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_712_giai_ma_hienthi_4led(float tam) 
.................... { 
....................    unsigned int16 x; 
....................    x=(unsigned int16) tam; 
....................    xuat_4led_7doan_giaima_xoa_so0(x); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_712_gp2d12_ss1cm() 
.................... { 
....................     kqadc=0; 
....................    for (j=0; j<20; j++) 
....................    { 
....................       kqadc=kqadc+read_adc(); 
....................       delay_ms(10); 
....................    } 
....................    kqadc=kqadc /20; 
....................    if (kqadc <= 80) k_cach=80; 
....................    else if ((kqadc>80) &&(kqadc<87)) 
....................    { 
....................       clk_cach = kqadc-80; 
....................       k_cach=80 - clk_cach/0.77; 
....................    } 
....................    else if (kqadc==87) k_cach=70; 
....................    else if ((kqadc>87) &&(kqadc<106)) 
....................    { 
....................       clk_cach = kqadc-87; 
....................       k_cach=70 - clk_cach/2.11; 
....................    } 
....................    else if (kqadc==106) k_cach=60; 
....................    else if ((kqadc>106) &&(kqadc<124)) 
....................    { 
....................       clk_cach = kqadc-106; 
....................       k_cach=60 - clk_cach/2; 
....................    } 
....................    else if (kqadc==124) k_cach=50; 
....................    else if ((kqadc>124) &&(kqadc<150)) 
....................    { 
....................       clk_cach = kqadc-124; 
....................       k_cach=50 - clk_cach/2.88; 
....................    } 
....................    else if (kqadc==150) k_cach=40; 
....................    else if ((kqadc>150) &&(kqadc<196)) 
....................    { 
....................       clk_cach = kqadc-150; 
....................       k_cach=40 - clk_cach/5.11; 
....................    } 
....................    else if (kqadc==196) k_cach=30; 
....................    else if ((kqadc>196) &&(kqadc<276)) 
....................    { 
....................       clk_cach = kqadc-196; 
....................       k_cach=30 - clk_cach/8.88; 
....................    } 
....................    else if (kqadc==276) k_cach=20; 
....................    else if ((kqadc>276) &&(kqadc<490)) 
....................    { 
....................       clk_cach = kqadc-276; 
....................       k_cach=20 - clk_cach/23.77; 
....................    } 
....................    else if (kqadc==490) k_cach=10; 
....................    ham_712_giai_ma_hienthi_4led(k_cach); 
....................     
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 713: do khoang cach dung led thu phat voi do phan giai 1cm dung phuong trinh de tinh khoang cach 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_713_giai_ma_hienthi_4led(float tam) 
.................... { 
....................    unsigned int16 x; 
....................    x=(unsigned int16) tam; 
....................    xuat_4led_7doan_giaima_xoa_so0(x); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_713_gp2d12_ss1cm() 
.................... { 
....................    kqadc=read_adc(); 
....................    delay_ms(40); 
....................    k_cach=pow(4277/kqadc,1.106); 
....................    if (k_cach>80) k_cach=80; 
....................    ham_713_giai_ma_hienthi_4led(k_cach); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 714: do 2 kenh nhiet do adc hien thi tren lcd, dem san pham va do khoang cach 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_714_doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
....................    lm35a=0;  
....................    for(j=0;j<solan/2;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/(solan/2);    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_714_doc_nd_lm35b() 
.................... { 
....................    set_adc_channel(1); 
....................    lm35b=0; 
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35b = lm35b + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35b=lm35b/2.046; 
....................    lm35b=lm35b/solan;    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_714_doc_khoangcach_gp2d12() 
.................... { 
....................    set_adc_channel(2); 
....................    kqadc=read_adc(); 
....................    delay_ms(40); 
....................    k_cach=pow(4277/kqadc,1.106); 
....................    if (k_cach>80) k_cach=80;   
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_714_hienthi_lcd() 
.................... { 
....................    lcd_goto_xy(0,0); 
....................    lcd_data("LM35A: "); 
....................    lcd_data(lm35a/10+0x30); 
....................    lcd_data(lm35a%10+0x30);  
....................    lcd_goto_xy(0,11); 
....................    lcd_data("LM35B: "); 
....................    lcd_data(lm35b/10+0x30); 
....................    lcd_data(lm35b%10+0x30); 
....................    lcd_goto_xy(1,0); 
....................    lcd_data("DEM SAN PHAM: "); 
....................    lcd_data(t0/10+0x30); 
....................    lcd_data(t0%10+0x30); 
....................    lcd_goto_xy(3,0); 
....................    lcd_data("KC: "); 
....................    lcd_data((unsigned int16) k_cach/10+0x30); 
....................    lcd_data((unsigned int16) k_cach%10+0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_714_lcd_2lm35_t0_gp2d12() 
.................... { 
....................    ham_714_doc_nd_lm35a(); 
....................    ham_714_doc_nd_lm35b(); 
....................    ham_714_doc_khoangcach_gp2d12(); 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................    } 
....................    ham_714_hienthi_lcd(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 731: doc nhiet do tu cam bien ds18b20a hien thi tren 2 led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_731_ds18b20a() 
.................... { 
....................  
....................    if(touch_present()) {doc_giatri_ds18b20();} 
....................    if(ds18al!=ds18a_tam) 
....................    { 
....................       ds18a_tam = ds18al; 
....................       ds18a = ds18a>>4; 
....................       ds18a = ds18a & 0x0ff; 
....................       xuat_4led_7doan_giaima_xoa_so0(ds18a); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 732: doc nhiet do tu cam bien ds18b20a hien thi tren 2 led 7 doan 
.................... // nhiet do lon hon 33 thi 16 led phao sang,16 led trai tat va khi nhiet do duoi 31 thi nguoc lai 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_732_ds18b20a_on_off_32led() 
.................... { 
....................  
....................   if(touch_present()) {doc_giatri_ds18b20();} 
....................    if(ds18al!=ds18a_tam) 
....................    { 
....................       ds18a_tam = ds18al; 
....................       ds18a = ds18a>>4; 
....................       ds18a = ds18a & 0x0ff; 
....................       xuat_4led_7doan_giaima_xoa_so0(ds18a); 
....................       if ((ds18a>gh_nda_tren)&&(ttqn==0)) 
....................       { 
....................          ttqn = 1; 
....................          xuat_32led_don_1dw(0x0000ffff); 
....................       } 
....................       else if ((ds18a<gh_nda_duoi)&&(ttqn==1)) 
....................       { 
....................          ttqn = 0; 
....................          xuat_32led_don_1dw(0xffff0000); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 733: doc nhiet do tu cam bien ds18b20a hien thi tren 2 led 7 doan 
.................... // khong che tu dong nhiet do tu 33-35 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_733_ds18b20a_lcd_buzzer() 
.................... { 
....................   if(touch_present()) {doc_giatri_ds18b20();} 
....................    if(ds18al!=ds18a_tam) 
....................    { 
....................       ds18a_tam = ds18al; 
....................       ds18a = ds18a>>4; 
....................       ds18a = ds18a & 0x0ff; 
....................       lcd_goto_xy(0,0); 
....................       lcd_data("Nhiet do :  "); 
....................       lcd_data( ds18a/10+0x30); 
....................       lcd_data( ds18a%10+0x30);       
....................       //xuat_4led_7doan_giaima_xoa_so0(ds18a); 
....................       if ((ds18a>gh_nda_tren)&&(ttqn==0)) 
....................       { 
....................          ttqn = 1; 
....................          triac_2_off(); 
....................          //buzzer_on(); 
....................          xuat_32led_don_1dw(0x00000000); 
....................          xuat_4led_7doan_giaima_xoa_so0(35); 
....................          
....................       } 
....................       else if ((ds18a<gh_nda_duoi)&&(ttqn==1)) 
....................       { 
....................          ttqn = 0; 
....................          triac_2_on(); 
....................          //buzzer_off(); 
....................          xuat_4led_7doan_giaima_xoa_so0(33); 
....................          xuat_32led_don_1dw(0xffffffff); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 734: doc nhiet do tu cam bien ds18b20a hien thi tren 2 led 7 doan va cam bien lm35 de so sanh 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_734_doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
....................    lm35a=0;  
....................    for(j=0;j<solan;j++) 
....................    { 
....................       lm35a = lm35a + read_adc(); 
....................       delay_us(100); 
....................    } 
....................    lm35a=lm35a/2.046; 
....................    lm35a=lm35a/(solan);    
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_734_ds18b20a_lm35a() 
.................... { 
....................    ham_734_doc_nd_lm35a(); 
....................    if(touch_present()) {doc_giatri_ds18b20();} 
....................    if(ds18al!=ds18a_tam) 
....................    { 
....................       ds18a_tam = ds18al; 
....................       ds18a = ds18a>>4; 
....................       ds18a = ds18a & 0x0ff; 
....................       //xuat_4led_7doan_giaima_xoa_so0(ds18a); 
....................       xuat_4led_7doan_2_so(lm35a,ds18a); 
....................       if((lm35a>nd_tren) && (ttqn==0)) 
....................       { 
....................          ttqn=1; 
....................          //buzzer_on(); 
....................          xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................          triac_2_off(); 
....................       } 
....................       else if((lm35a<nd_tren) && (ttqn==1)) 
....................       { 
....................          ttqn=0; 
....................          //buzzer_off(); 
....................          xuat_32led_don_4byte(0,0,0,0); 
....................       } 
....................       else if((lm35a<nd_duoi) && (ttqn==0)) triac_2_on(); 
....................    } 
....................    //ham_734_doc_nd_lm35a(); 
....................    //xuat_4led_7doan_2_so(lm35a,ds18a); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 735: doc nhiet do tu cam bien ds18b20a hien thi tren 2 led 7 doan va t0 hien thi ben trai dem tu 00-99 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_735_ds18b20a_t0() 
.................... { 
....................  
....................    if(touch_present()) {doc_giatri_ds18b20();} 
....................    if(ds18al!=ds18a_tam) 
....................    { 
....................       ds18a_tam = ds18al; 
....................       ds18a = ds18a>>4; 
....................       ds18a = ds18a & 0x0ff; 
....................       //xuat_4led_7doan_giaima_xoa_so0(ds18a); 
....................    } 
....................    t0=get_timer0(); 
....................    if(t0!=t0_tam) 
....................    { 
....................       t0_tam=t0; 
....................       if(t0>=100) set_timer0(1); 
....................    } 
....................    xuat_4led_7doan_2_so_xoa_so0(t0,ds18a); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
....................  
....................  
....................  
....................  
....................  
....................  
....................  
....................  
....................  
....................  
.................... #include <chuong8_i2c_all.c>    
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //TAT CA DEU VIET THEO BAI VA HAM THEO BAI 
.................... #define solando 100 
.................... #define gioihan_dk 180 
.................... #define pir pin_a3 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //Khai bao bien DS13B07  ADC-DAC PCF8591  EEPROM NT AT24C256  
.................... unsigned int16 k; 
.................... unsigned char giatri_mod=0; 
.................... unsigned int16 giay_ch=0x00,phut_ch=0x00,gio_ch=0x7,ttsd=0; 
.................... unsigned int8 dac=0; 
.................... unsigned int16 adc_lm35a,adc_lm35b,adc_cds; 
.................... int1 tt_triac=0,tt_triac1=0; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... void khoi_tao_ds13b07() 
.................... { 
....................    lcd_command(lcd_addr_line1); 
....................    lcd_data("clock:"); 
....................    doc_thoi_gian_tu_realtime(); 
....................    if (ma_ds13!=ma_ds) 
....................    { 
....................    thiet_lap_thoi_gian_hien_tai(); 
....................    nap_thoi_gian_htai_vao_ds1307(); 
....................    } 
....................    //thiet_lap_thoi_gian_hien_tai(); 
....................    //nap_thoi_gian_htai_vao_ds1307(); 
....................     
....................    doc_thoi_gian_tu_realtime(); 
....................    giaytam=giay_ds13;  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... void hien_thi_gia_tri_mod ( ) 
.................... { 
....................    lcd_command(0x8a); 
....................    lcd_data(giatri_mod+0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... unsigned int8 hieu_chinh_so_bcd_tang(unsigned int8 x ) 
.................... { 
....................    unsigned int8 y; 
....................    y = x; 
....................    x = x & 0x0f; 
....................    if (x==0x0a) y = y + 6; 
....................    return(y); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... unsigned int8 hieu_chinh_so_bcd_giam(unsigned int8 x ) 
.................... { 
....................    unsigned int8 y; 
....................    y = x; 
....................    x = x & 0x0f; 
....................    if (x==0x0f) y = y - 6; 
....................    return(y); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void luu_giai_ma_hien_thi_sau_khi_chinh() 
.................... { 
....................    nap_thoi_gian_htai_vao_ds1307(); 
....................    hien_thi_thoi_gian_ds1307 ( ); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 801: doc thoi gian thuc hien thi tren lcd 20x4 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_801_i2c_rt_lcd() 
.................... { 
....................    doc_thoi_gian_tu_realtime(); 
....................    if (giaytam!=giay_ds13) 
....................    { 
....................    giaytam=giay_ds13; 
....................    hien_thi_thoi_gian_ds1307 ( ); 
....................    } 
....................    delay_ms(500); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 802: doc thoi gian thuc hien thi tren lcd 20x4, co 3 nut chinh up down mod 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_802_phim_mod() 
.................... { 
....................    if (!input(mod)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(mod)) 
....................          { 
....................             if(giatri_mod<3) giatri_mod++; 
....................             else giatri_mod=0; 
....................             hien_thi_gia_tri_mod( ); 
....................             while(!input(mod)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_802_phim_up() 
.................... { 
....................    if (!input(up)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(up)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0x59) giay_ds13=0; 
....................                      else 
....................                      { 
....................                         giay_ds13++; 
....................                         giay_ds13=hieu_chinh_so_bcd_tang(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0x59) phut_ds13=0; 
....................                      else 
....................                      { 
....................                         phut_ds13++; 
....................                         phut_ds13=hieu_chinh_so_bcd_tang(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0x23) gio_ds13=0; 
....................                      else 
....................                      { 
....................                         gio_ds13++; 
....................                         gio_ds13=hieu_chinh_so_bcd_tang(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................                       
....................             default: break; 
....................          } 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_802_phim_dw() 
.................... { 
....................    if (!input(dw)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(dw)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0) giay_ds13=0x59; 
....................                      else 
....................                      { 
....................                         giay_ds13--; 
....................                         giay_ds13=hieu_chinh_so_bcd_giam(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0) phut_ds13=0x59; 
....................                      else 
....................                      { 
....................                         phut_ds13--; 
....................                         phut_ds13=hieu_chinh_so_bcd_giam(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0) gio_ds13=0x23; 
....................                      else 
....................                      { 
....................                         gio_ds13--; 
....................                         gio_ds13=hieu_chinh_so_bcd_giam(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................                       
....................             default: break; 
....................          } 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_802_i2c_rt_lcd_3key() 
.................... { 
....................    doc_thoi_gian_tu_realtime(); 
....................    if (giaytam!=giay_ds13) 
....................    { 
....................       giaytam=giay_ds13; 
....................       hien_thi_gia_tri_mod ( ); 
....................       hien_thi_thoi_gian_ds1307 ( ); 
....................    } 
....................    for(k=0;k<10000;k++) 
....................    { 
....................       ham_802_phim_mod(); 
....................       ham_802_phim_up(); 
....................       ham_802_phim_dw(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 803: doc thoi gian thuc hien thi tren lcd 20x4, co 3 nut chinh up down mod, them chuc nang chinh ngay thang nam 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_803_phim_mod() 
.................... { 
....................    if (!input(mod)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(mod)) 
....................          { 
....................             if(giatri_mod<6) giatri_mod++; 
....................             else giatri_mod=0; 
....................             hien_thi_gia_tri_mod( ); 
....................             while(!input(mod)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_803_phim_up() 
.................... { 
....................    if (!input(up)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(up)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0x59) giay_ds13=0; 
....................                      else 
....................                      { 
....................                         giay_ds13++; 
....................                         giay_ds13=hieu_chinh_so_bcd_tang(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0x59) phut_ds13=0; 
....................                      else 
....................                      { 
....................                         phut_ds13++; 
....................                         phut_ds13=hieu_chinh_so_bcd_tang(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0x23) gio_ds13=0; 
....................                      else 
....................                      { 
....................                         gio_ds13++; 
....................                         gio_ds13=hieu_chinh_so_bcd_tang(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 4:  if (ngay_ds13==0x31) ngay_ds13=1; 
....................                      else    
....................                      { 
....................                         ngay_ds13++; 
....................                         ngay_ds13=hieu_chinh_so_bcd_tang(ngay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 5:  if (thang_ds13==0x12) thang_ds13=1; 
....................                      else 
....................                      { 
....................                         thang_ds13++; 
....................                         thang_ds13=hieu_chinh_so_bcd_tang(thang_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 6: if (nam_ds13==0x99) nam_ds13=0; 
....................                      else 
....................                      { 
....................                         nam_ds13++; 
....................                         nam_ds13=hieu_chinh_so_bcd_tang(nam_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................                       
....................             default: break; 
....................          } 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_803_phim_dw() 
.................... { 
....................    if (!input(dw)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(dw)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0) giay_ds13=0x59; 
....................                      else 
....................                      { 
....................                         giay_ds13--; 
....................                         giay_ds13=hieu_chinh_so_bcd_giam(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0) phut_ds13=0x59; 
....................                      else 
....................                      { 
....................                         phut_ds13--; 
....................                         phut_ds13=hieu_chinh_so_bcd_giam(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0) gio_ds13=0x23; 
....................                      else 
....................                      { 
....................                         gio_ds13--; 
....................                         gio_ds13=hieu_chinh_so_bcd_giam(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 4:  if (ngay_ds13==0) ngay_ds13=0x31; 
....................                      else 
....................                      { 
....................                         ngay_ds13--; 
....................                         ngay_ds13=hieu_chinh_so_bcd_giam(ngay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 5:  if (thang_ds13==1) thang_ds13=0x12; 
....................                      else 
....................                      { 
....................                         thang_ds13--; 
....................                         thang_ds13=hieu_chinh_so_bcd_giam(thang_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 6:  if (nam_ds13==0) nam_ds13=0x99; 
....................                      else 
....................                      { 
....................                         nam_ds13--; 
....................                         nam_ds13=hieu_chinh_so_bcd_giam(nam_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break;        
....................                       
....................             default: break; 
....................          } 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_803_nhap_nhay_con_tro() 
.................... { 
....................    switch (giatri_mod) 
....................    { 
....................       case 1:  lcd_command(0xd3); 
....................                break; 
....................       case 2:  lcd_command(0xd0); 
....................                break; 
....................       case 3:  lcd_command(0xcd); 
....................                break; 
....................       case 4:  lcd_command(0x8d); 
....................                break; 
....................       case 5:  lcd_command(0x90); 
....................                break; 
....................       case 6:  lcd_command(0x93); 
....................                break; 
....................                 
....................       default: break; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_803_i2c_rt_lcd_3key() 
.................... { 
....................    doc_thoi_gian_tu_realtime(); 
....................    if (giaytam!=giay_ds13) 
....................    { 
....................       giaytam=giay_ds13; 
....................       hien_thi_gia_tri_mod ( ); 
....................       hien_thi_thoi_gian_ds1307 ( ); 
....................    } 
....................    for(k=0;k<10000;k++) 
....................    { 
....................       //ham_803_nhap_nhay_con_tro(); 
....................       ham_803_phim_mod(); 
....................       ham_803_phim_up(); 
....................       ham_803_phim_dw(); 
....................    } 
....................    if (giatri_mod!=0) ham_803_nhap_nhay_con_tro(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 804: doc thoi gian thuc hien thi tren lcd 20x4, co 3 nut chinh up down mod, them chuc nang chinh ngay thang nam, co nhap nhanh 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_804_phim_mod() 
.................... { 
....................    if (!input(mod)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(mod)) 
....................          { 
....................             if(giatri_mod<6) giatri_mod++; 
....................             else giatri_mod=0; 
....................             hien_thi_gia_tri_mod( ); 
....................             while(!input(mod)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_804_phim_up() 
.................... { 
....................    if (!input(up)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(up)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0x59) giay_ds13=0; 
....................                      else 
....................                      { 
....................                         giay_ds13++; 
....................                         giay_ds13=hieu_chinh_so_bcd_tang(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0x59) phut_ds13=0; 
....................                      else 
....................                      { 
....................                         phut_ds13++; 
....................                         phut_ds13=hieu_chinh_so_bcd_tang(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0x23) gio_ds13=0; 
....................                      else 
....................                      { 
....................                         gio_ds13++; 
....................                         gio_ds13=hieu_chinh_so_bcd_tang(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 4:  if (ngay_ds13==0x31) ngay_ds13=1; 
....................                      else    
....................                      { 
....................                         ngay_ds13++; 
....................                         ngay_ds13=hieu_chinh_so_bcd_tang(ngay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 5:  if (thang_ds13==0x12) thang_ds13=1; 
....................                      else 
....................                      { 
....................                         thang_ds13++; 
....................                         thang_ds13=hieu_chinh_so_bcd_tang(thang_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 6: if (nam_ds13==0x99) nam_ds13=0; 
....................                      else 
....................                      { 
....................                         nam_ds13++; 
....................                         nam_ds13=hieu_chinh_so_bcd_tang(nam_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................                       
....................             default: break; 
....................          } 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_804_phim_dw() 
.................... { 
....................    if (!input(dw)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(dw)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0) giay_ds13=0x59; 
....................                      else 
....................                      { 
....................                         giay_ds13--; 
....................                         giay_ds13=hieu_chinh_so_bcd_giam(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0) phut_ds13=0x59; 
....................                      else 
....................                      { 
....................                         phut_ds13--; 
....................                         phut_ds13=hieu_chinh_so_bcd_giam(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0) gio_ds13=0x23; 
....................                      else 
....................                      { 
....................                         gio_ds13--; 
....................                         gio_ds13=hieu_chinh_so_bcd_giam(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 4:  if (ngay_ds13==0) ngay_ds13=0x31; 
....................                      else 
....................                      { 
....................                         ngay_ds13--; 
....................                         ngay_ds13=hieu_chinh_so_bcd_giam(ngay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 5:  if (thang_ds13==1) thang_ds13=0x12; 
....................                      else 
....................                      { 
....................                         thang_ds13--; 
....................                         thang_ds13=hieu_chinh_so_bcd_giam(thang_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 6:  if (nam_ds13==0) nam_ds13=0x99; 
....................                      else 
....................                      { 
....................                         nam_ds13--; 
....................                         nam_ds13=hieu_chinh_so_bcd_giam(nam_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break;        
....................                       
....................             default: break; 
....................          } 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_804_nhap_nhay_con_tro() 
.................... { 
....................    switch (giatri_mod) 
....................    { 
....................       case 1:  lcd_goto_xy(3,9); lcd_data("  "); 
....................                break; 
....................       case 2:  lcd_goto_xy(3,6); lcd_data("  "); 
....................                break; 
....................       case 3:  lcd_goto_xy(3,3); lcd_data("  "); 
....................                break; 
....................       case 4:  lcd_goto_xy(3,12); lcd_data("  "); 
....................                break; 
....................       case 5:  lcd_goto_xy(3,15); lcd_data("  "); 
....................                break; 
....................       case 6:  lcd_goto_xy(3,18); lcd_data("  "); 
....................                break; 
....................                 
....................       default: break; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_804_i2c_rt_lcd_3key_nn() 
.................... { 
....................    doc_thoi_gian_tu_realtime(); 
....................    if (giaytam!=giay_ds13) 
....................    { 
....................       giaytam=giay_ds13; 
....................       hien_thi_gia_tri_mod ( ); 
....................       hien_thi_thoi_gian_ds1307 ( ); 
....................    } 
....................    for(k=0;k<10000;k++) 
....................    { 
....................       //ham_804_nhap_nhay_con_tro(); 
....................       ham_804_phim_mod(); 
....................       ham_804_phim_up(); 
....................       ham_804_phim_dw(); 
....................    } 
....................    if (giatri_mod!=0) ham_804_nhap_nhay_con_tro(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //bai 805 doc thoi gian tren ds1307 co 3 nut nhan chinh duoc ngay thang nam buzzer 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_805_i2c_rt_lcd_3key_buzzer() 
.................... { 
....................    bai_804_i2c_rt_lcd_3key_nn(); 
....................    if(giay_ds13 == 0x59) 
....................    { 
....................       //buzzer_on(); 
....................       delay_ms(200); 
....................       buzzer_off(); 
....................    } 
.................... } 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 806: hieu chinh 804 them chuc nang hen gio 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_806_phim_mod() 
.................... { 
....................    if (!input(mod)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(mod)) 
....................          { 
....................             if(giatri_mod<3) giatri_mod++; 
....................             else giatri_mod=0; 
....................             hien_thi_gia_tri_mod( ); 
....................             while(!input(mod)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_806_phim_up() 
.................... { 
....................    if (!input(up)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(up)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ch==0x59) giay_ch=0; 
....................                      else 
....................                      { 
....................                         giay_ch++; 
....................                         giay_ch=hieu_chinh_so_bcd_tang(giay_ch); 
....................                      } 
....................                      //luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ch==0x59) phut_ch=0; 
....................                      else 
....................                      { 
....................                         phut_ch++; 
....................                         phut_ch=hieu_chinh_so_bcd_tang(phut_ch); 
....................                      } 
....................                      //luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ch==0x23) gio_ch=0; 
....................                      else 
....................                      { 
....................                         gio_ch++; 
....................                         gio_ch=hieu_chinh_so_bcd_tang(gio_ch); 
....................                      } 
....................                      //luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break;     
....................                       
....................             default: break; 
....................          } 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_806_phim_dw() 
.................... { 
....................    if (!input(dw)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(dw)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ch==0) giay_ch=0x59; 
....................                      else 
....................                      { 
....................                         giay_ch--; 
....................                         giay_ch=hieu_chinh_so_bcd_giam(giay_ch); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ch==0) phut_ch=0x59; 
....................                      else 
....................                      { 
....................                         phut_ch--; 
....................                         phut_ch=hieu_chinh_so_bcd_giam(phut_ch); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ch==0) gio_ch=0x23; 
....................                      else 
....................                      { 
....................                         gio_ch--; 
....................                         gio_ch=hieu_chinh_so_bcd_giam(gio_ch); 
....................                      } 
....................                      //luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break;                           
....................                       
....................             default: break; 
....................          } 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_806_nhap_nhay_con_tro() 
.................... { 
....................    switch (giatri_mod) 
....................    { 
....................          case 3:  lcd_goto_xy(2,3); 
....................                   lcd_data(' '); 
....................                   lcd_goto_xy(2,4); 
....................                   lcd_data(' '); 
....................                   break; 
....................          case 2:  lcd_goto_xy(2,6); 
....................                   lcd_data(' '); 
....................                   lcd_goto_xy(2,7); 
....................                   lcd_data(' '); 
....................                   break; 
....................          case 1:  lcd_goto_xy(2,9); 
....................                   lcd_data(' '); 
....................                   lcd_goto_xy(2,10); 
....................                   lcd_data(' '); 
....................                   break; 
....................          default: break; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_806_hien_thi_gio_canh_bao_lcd() 
.................... {      
....................       lcd_goto_xy(2,3);  //lcd_command (0x8c); 
....................       lcd_data(gio_ch/16  +0x30);    lcd_data(gio_ch%16  +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(phut_ch/16 +0x30);    lcd_data(phut_ch%16 +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(giay_ch/16 +0x30);    lcd_data(giay_ch%16 +0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_806_i2c_rt_lcd_3key_alram() 
.................... { 
....................    doc_thoi_gian_tu_realtime(); 
....................    ham_806_hien_thi_gio_canh_bao_lcd(); 
....................    if (giaytam!=giay_ds13) 
....................    { 
....................       giaytam=giay_ds13; 
....................       hien_thi_gia_tri_mod ( ); 
....................       hien_thi_thoi_gian_ds1307 ( );     
....................    } 
....................    if((gio_ch==gio_ds13)&&(phut_ch==phut_ds13)&&(giay_ch==giay_ds13)&&flag==0) 
....................    { 
....................       //buzzer_on(); 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................       flag=1; 
....................       ttsd=giay_ds13; 
....................    } 
....................    if(flag==1) 
....................    { 
....................       if((ttsd+5)<=giay_ds13) 
....................       { 
....................          xuat_32led_don_4byte(0,0,0,0); 
....................          flag=0; 
....................       } 
....................       //buzzer_off(); 
....................    } 
....................  
....................    for(k=0;k<10000;k++) 
....................    { 
....................       ham_806_phim_mod(); 
....................       ham_806_phim_up(); 
....................       ham_806_phim_dw(); 
....................    } 
....................    if (giatri_mod!=0) ham_806_nhap_nhay_con_tro(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 807: hieu chinh 805 co them cac moc thoi gian chuong reo 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_807_phim_mod() 
.................... { 
....................    if (!input(mod)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(mod)) 
....................          { 
....................             if(giatri_mod<6) giatri_mod++; 
....................             else giatri_mod=0; 
....................             hien_thi_gia_tri_mod( ); 
....................             while(!input(mod)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_807_phim_up() 
.................... { 
....................    if (!input(up)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(up)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0x59) giay_ds13=0; 
....................                      else 
....................                      { 
....................                         giay_ds13++; 
....................                         giay_ds13=hieu_chinh_so_bcd_tang(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0x59) phut_ds13=0; 
....................                      else 
....................                      { 
....................                         phut_ds13++; 
....................                         phut_ds13=hieu_chinh_so_bcd_tang(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0x23) gio_ds13=0; 
....................                      else 
....................                      { 
....................                         gio_ds13++; 
....................                         gio_ds13=hieu_chinh_so_bcd_tang(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 4:  if (ngay_ds13==0x31) ngay_ds13=1; 
....................                      else    
....................                      { 
....................                         ngay_ds13++; 
....................                         ngay_ds13=hieu_chinh_so_bcd_tang(ngay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 5:  if (thang_ds13==0x12) thang_ds13=1; 
....................                      else 
....................                      { 
....................                         thang_ds13++; 
....................                         thang_ds13=hieu_chinh_so_bcd_tang(thang_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 6: if (nam_ds13==0x99) nam_ds13=0; 
....................                      else 
....................                      { 
....................                         nam_ds13++; 
....................                         nam_ds13=hieu_chinh_so_bcd_tang(nam_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................                       
....................             default: break; 
....................          } 
....................          while(!input(up)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_807_phim_dw() 
.................... { 
....................    if (!input(dw)) 
....................    { 
....................       delay_ms(20); 
....................       if (!input(dw)) 
....................       { 
....................          switch (giatri_mod) 
....................          { 
....................             case 1:  if (giay_ds13==0) giay_ds13=0x59; 
....................                      else 
....................                      { 
....................                         giay_ds13--; 
....................                         giay_ds13=hieu_chinh_so_bcd_giam(giay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 2:  if (phut_ds13==0) phut_ds13=0x59; 
....................                      else 
....................                      { 
....................                         phut_ds13--; 
....................                         phut_ds13=hieu_chinh_so_bcd_giam(phut_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 3:  if (gio_ds13==0) gio_ds13=0x23; 
....................                      else 
....................                      { 
....................                         gio_ds13--; 
....................                         gio_ds13=hieu_chinh_so_bcd_giam(gio_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 4:  if (ngay_ds13==0) ngay_ds13=0x31; 
....................                      else 
....................                      { 
....................                         ngay_ds13--; 
....................                         ngay_ds13=hieu_chinh_so_bcd_giam(ngay_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 5:  if (thang_ds13==1) thang_ds13=0x12; 
....................                      else 
....................                      { 
....................                         thang_ds13--; 
....................                         thang_ds13=hieu_chinh_so_bcd_giam(thang_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break; 
....................             case 6:  if (nam_ds13==0) nam_ds13=0x99; 
....................                      else 
....................                      { 
....................                         nam_ds13--; 
....................                         nam_ds13=hieu_chinh_so_bcd_giam(nam_ds13); 
....................                      } 
....................                      luu_giai_ma_hien_thi_sau_khi_chinh(); 
....................                      break;        
....................                       
....................             default: break; 
....................          } 
....................          while(!input(dw)); 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_807_nhap_nhay_con_tro() 
.................... { 
....................    switch (giatri_mod) 
....................    { 
....................       case 1:  lcd_goto_xy(3,9); lcd_data("  "); 
....................                break; 
....................       case 2:  lcd_goto_xy(3,6); lcd_data("  "); 
....................                break; 
....................       case 3:  lcd_goto_xy(3,3); lcd_data("  "); 
....................                break; 
....................       case 4:  lcd_goto_xy(3,12); lcd_data("  "); 
....................                break; 
....................       case 5:  lcd_goto_xy(3,15); lcd_data("  "); 
....................                break; 
....................       case 6:  lcd_goto_xy(3,18); lcd_data("  "); 
....................                break; 
....................                 
....................       default: break; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_807_hien_thi_gio_canh_bao_lcd() 
.................... {      
....................       lcd_goto_xy(2,3);  //lcd_command (0x8c); 
....................       lcd_data(gio_ch/16  +0x30);    lcd_data(gio_ch%16  +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(phut_ch/16 +0x30);    lcd_data(phut_ch%16 +0x30); 
....................       lcd_data(' '); 
....................       lcd_data(giay_ch/16 +0x30);    lcd_data(giay_ch%16 +0x30); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_807_i2c_rt_lcd_3key_chuong() 
.................... { 
....................    doc_thoi_gian_tu_realtime(); 
....................    ham_806_hien_thi_gio_canh_bao_lcd(); 
....................    if((gio_ch==gio_ds13)&&(phut_ch==phut_ds13)&&(giay_ch==giay_ds13)&&flag==0) 
....................    { 
....................       //buzzer_on(); 
....................       if((gio_ch==0x07)&&(phut_ch==0x00)&&(giay_ch==0x00)) 
....................       { 
....................          gio_ch=0x07; 
....................          phut_ch=0x02; 
....................          giay_ch=0x00; 
....................       } 
....................       if((gio_ch==0x07)&&(phut_ch==0x02)&&(giay_ch==0x00)) 
....................       { 
....................          gio_ch=0x07; 
....................          phut_ch=0x04; 
....................          giay_ch=0x00; 
....................       }       
....................       ttsd=giay_ds13; 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................       flag=1; 
....................    } 
....................    if(flag==1) 
....................    { 
....................       if((ttsd+5)<=giay_ds13) 
....................       { 
....................          xuat_32led_don_4byte(0,0,0,0); 
....................          flag=0; 
....................       } 
....................       //buzzer_off(); 
....................    } 
....................    if (giaytam!=giay_ds13) 
....................    { 
....................       giaytam=giay_ds13; 
....................       hien_thi_gia_tri_mod ( ); 
....................       hien_thi_thoi_gian_ds1307 ( ); 
....................    } 
....................    for(k=0;k<10000;k++) 
....................    { 
....................       //ham_804_nhap_nhay_con_tro(); 
....................       ham_807_phim_mod(); 
....................       ham_807_phim_up(); 
....................       ham_807_phim_dw(); 
....................    } 
....................    if (giatri_mod!=0) ham_807_nhap_nhay_con_tro(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 808: hieu chinh hien thi thoi gian so lon 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_808_hien_thi_thoi_gian_ds1307_so_z( ) 
.................... {     lcd_goto_xy(1,0);  //lcd_command (0x8c);    
....................       lcd_hienthi_so_z_toado_xy((gio_ds13/16),2,0); 
....................       lcd_hienthi_so_z_toado_xy((gio_ds13%16),2,3); 
....................       lcd_data(' '); 
....................       lcd_hienthi_so_z_toado_xy((phut_ds13/16),2,7); 
....................       lcd_hienthi_so_z_toado_xy((phut_ds13%16),2,10); 
....................       lcd_data(' '); 
....................       lcd_hienthi_so_z_toado_xy((giay_ds13/16),2,14); 
....................       lcd_hienthi_so_z_toado_xy((giay_ds13%16),2,17); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_808_i2c_rt_lcd_to() 
.................... { 
....................    doc_thoi_gian_tu_realtime(); 
....................    lcd_command(0x40); 
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
....................    if (giaytam!=giay_ds13) 
....................    { 
....................       giaytam=giay_ds13; 
....................       ham_808_hien_thi_thoi_gian_ds1307_so_z( ); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 809: hien thi thoi gian so lon va so nho bang 1 nut nha 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_809_phim_mod() 
.................... { 
....................    if (!input(mod)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(mod)) 
....................          { 
....................             setup_lcd(); 
....................             if(giatri_mod<1) giatri_mod++; 
....................             else giatri_mod=0; 
....................             hien_thi_gia_tri_mod( ); 
....................             while(!input(mod)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_809_i2c_rt_lcd_to_nho() 
.................... { 
....................    ham_809_phim_mod(); 
....................    if(giatri_mod==0) 
....................    { 
....................       bai_803_i2c_rt_lcd_3key(); 
....................    } 
....................    else 
....................    { 
....................       bai_808_i2c_rt_lcd_to(); 
....................    } 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 811: do nhiet do lm35a voi kenh an0 cua ic ADC PCF 8591, hien thi 4 led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_811_pcf8591_4led_lm35a() 
.................... { 
....................    pcf8591_chonkenh(pcf8591_channel_0); //lm35a 
....................    delay_us(100); 
....................    adc_lm35a=0; 
....................    for(i=0;i<100;i++) 
....................    { 
....................        
....................       delay_us(20); 
....................       adc_lm35a=adc_lm35a + pcf8591_doc_adc(); 
....................    } 
....................    adc_lm35a= adc_lm35a/100; 
....................    xuat_4led_7doan_giaima_xoa_so0(adc_lm35a); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 812: giong 811 nhung nhiet do lon hon gioi han cai 40doC thi bao chuong 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_812_so_sanh_dk_buzzer() 
.................... { 
....................    if((lm35a>nd_tren)&&(ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       //buzzer_on(); 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................    } 
....................    else if((lm35a>nd_tren)&&(ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       //buzzer_off(); 
....................       xuat_32led_don_4byte(0,0,0,0); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_812_pcf8591_4led_lm35a_buz() 
.................... { 
....................    pcf8591_chonkenh(pcf8591_channel_0); //lm35a 
....................    delay_us(100); 
....................    adc_lm35a=0; 
....................    for(i=0;i<100;i++) 
....................    { 
....................        
....................       delay_us(20); 
....................       adc_lm35a=adc_lm35a + pcf8591_doc_adc(); 
....................    } 
....................    adc_lm35a= adc_lm35a/100; 
....................    xuat_4led_7doan_giaima_xoa_so0(adc_lm35a); 
....................    ham_812_so_sanh_dk_buzzer(); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 813: giong 812 nhung do them lm35a kenh an1 va hien thi ben trai 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_813_doc_nd_lm35b() 
.................... {     
....................    pcf8591_chonkenh(pcf8591_channel_1); //lm35b 
....................    delay_us(100); 
....................    adc_lm35b=0; 
....................    for(i=0;i<100;i++) 
....................    {      
....................       delay_us(20); 
....................       adc_lm35b=adc_lm35b + pcf8591_doc_adc(); 
....................    } 
....................    adc_lm35b= adc_lm35b/100; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_813_pcf8591_4led_lm35a_buz() 
.................... { 
....................    ham_813_doc_nd_lm35b(); 
....................    xuat_4led_7doan_2_so(adc_lm35b,adc_lm35a); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 814: tu dong do va khong che nhiet do trong tam 33 den 35do, khi nho hon 33 thi mo triac. khi nhiet do qua 35 thi tat triac va bat loa 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_814_so_sanh_dk_buzzer() 
.................... { 
....................    if(lm35a>nd_tren && (ttqn==0)) 
....................    { 
....................       ttqn=1; 
....................       //buzzer_on(); 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................       triac_2_off(); 
....................    } 
....................    else if((lm35a<nd_tren)&& (ttqn==1)) 
....................    { 
....................       ttqn=0; 
....................       //buzzer_off(); 
....................       xuat_32led_don_4byte(0,0,0,0); 
....................    } 
....................    else if((lm35a<nd_duoi) && (ttqn==0)) triac_2_on(); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_814_doc_nd_lm35a() 
.................... {   
....................    pcf8591_chonkenh(pcf8591_channel_0); //lm35a 
....................    delay_us(100); 
....................    adc_lm35a=0; 
....................    for(i=0;i<100;i++) 
....................    {      
....................       delay_us(20); 
....................       adc_lm35a=adc_lm35a + pcf8591_doc_adc(); 
....................    } 
....................    adc_lm35a= adc_lm35a/100; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_814_pcf8591_4led_lm35a_buz_den() 
.................... { 
....................    ham_814_doc_nd_lm35a(); 
....................    xuat_4led_7doan_2_so(0,adc_lm35a); 
....................    ham_814_so_sanh_dk_buzzer(); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 815: do nhiet do tu 2 cam bien lm35a va lm35b 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_815_doc_nd_lm35a() 
.................... {   
....................    pcf8591_chonkenh(pcf8591_channel_0); //lm35a 
....................    delay_us(100); 
....................    adc_lm35a=0; 
....................    for(i=0;i<100;i++) 
....................    {      
....................       delay_us(20); 
....................       adc_lm35a=adc_lm35a + pcf8591_doc_adc(); 
....................    } 
....................    adc_lm35a= adc_lm35a/100; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_815_doc_nd_lm35b() 
.................... {     
....................    pcf8591_chonkenh(pcf8591_channel_1); //lm35b 
....................    delay_us(100); 
....................    adc_lm35b=0; 
....................    for(i=0;i<100;i++) 
....................    {      
....................       delay_us(20); 
....................       adc_lm35b=adc_lm35b + pcf8591_doc_adc(); 
....................    } 
....................    adc_lm35b= adc_lm35b/100; 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_815_pcf8591_4led_lm35ab() 
.................... { 
....................    ham_815_doc_nd_lm35a(); 
....................    ham_815_doc_nd_lm35b(); 
....................    xuat_4led_7doan_2_so(adc_lm35b,adc_lm35a); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 821: do anh sang dung cam bien photocell cds pdv-p8103 noi voi kenh an3 cua adc pcf 8591, hien thi tren mdoule 4 led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_821_pcf8591_4led_cds() 
.................... { 
....................    adc_cds=0; 
....................    pcf8591_chonkenh(pcf8591_channel_2); //cds 
....................    for(i=0;i<solando;i++) 
....................    { 
....................       delay_us(20); 
....................       adc_cds=adc_cds + pcf8591_doc_adc(); 
....................    } 
....................    adc_cds=adc_cds/solando; 
....................    xuat_4led_7doan_giaima_xoa_so0(adc_cds); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 822: dieu khien den tu dong sang su dung cam bien photocell cds pdv-p8103  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_822_sosanh_cds_dk_den() 
.................... { 
....................    if ((adc_cds>gioihan_dk)&&(tt_triac==0)) 
....................    { 
....................       tt_triac = 1; 
....................       triac_2_on(); 
....................    } 
....................    else if ((adc_cds<gioihan_dk-20)&&(tt_triac==1)) 
....................    { 
....................       tt_triac = 0; 
....................       triac_2_off(); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_822_pcf8591_4led_cds_on_off_den() 
.................... { 
....................    adc_cds=0; 
....................    pcf8591_chonkenh(pcf8591_channel_2); //cds 
....................    for(i=0;i<solando;i++) 
....................    { 
....................       delay_us(20); 
....................       adc_cds=adc_cds + pcf8591_doc_adc(); 
....................    } 
....................    adc_cds=adc_cds/solando; 
....................    xuat_4led_7doan_giaima_xoa_so0(adc_cds); 
....................    ham_822_sosanh_cds_dk_den(); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 831: dieu khien den tu dong sang khi phat hien co nguoi chuyen dong hoac tat khi khong co nguoi chuyen dong  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_831_kiemtra_pir_mo_den() 
.................... { 
....................    if(input(pir)&&(tt_triac==0)) 
....................    { 
....................       triac_2_off(); 
....................       tt_triac=1; 
....................    } 
....................    else if (!input(pir)&&(tt_triac==1)) 
....................    { 
....................       triac_2_on(); 
....................       tt_triac=0; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_831_pir_dk_den() 
.................... { 
....................    ham_831_kiemtra_pir_mo_den(); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 832: 2 yeu cau 
.................... //yc1: dung cam bien photocel cds pdv-p8103 de dieu khien den 
.................... ///yc2: dung cam bien pir dieu khien den khi co nguoi va khong co nguoi,sang 32led 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_832_kiemtra_pir_mo_den() 
.................... { 
....................    if(input(pir)&&(tt_triac==0)) 
....................    { 
....................       triac_2_off(); 
....................       tt_triac=1; 
....................    } 
....................    else if (!input(pir)&&(tt_triac==1)) 
....................    { 
....................       triac_2_on(); 
....................       tt_triac=0; 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_832_sosanh_cds_dk_den() 
.................... { 
....................    if ((adc_cds>gioihan_dk)&&(tt_triac1==0)) 
....................    { 
....................       tt_triac = 1; 
....................       xuat_32led_don_4byte(0xff,0xff,0xff,0xff); 
....................    } 
....................    else if ((adc_cds<gioihan_dk-20)&&(tt_triac1==1)) 
....................    { 
....................       tt_triac1 = 0; 
....................       xuat_32led_don_4byte(0,0,0,0); 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_832_pir_dk_32led_cds_dk_den() 
.................... { 
....................    adc_cds=0; 
....................    pcf8591_chonkenh(pcf8591_channel_2); //cds 
....................    for(i=0;i<solando;i++) 
....................    { 
....................       delay_us(20); 
....................       adc_cds=adc_cds + pcf8591_doc_adc(); 
....................    } 
....................    adc_cds=adc_cds/solando; 
....................    xuat_4led_7doan_giaima_xoa_so0(adc_cds); 
....................    ham_832_sosanh_cds_dk_den(); 
....................    ham_832_kiemtra_pir_mo_den(); 
....................  
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... #include <chuong9_dongco.c>                  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //TAT CA DEU VIET THEO BAI VA HAM THEO BAI 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx   
.................... //Khai bao bien dong co buoc,dong co dc va encoder,pwm,dieu khien pid 
.................... unsigned int8 pwm_capso; 
.................... unsigned int16 duty; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 901:  dieu khin dung co buoc có 2 nút dieu khien: ON, OFF.Khi nhan ON thì dng co quay theo chieu kim dong ho, khi nhan OFF thì ngung 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_901_step_on_off() 
.................... { 
....................    while(input(on)); 
....................    do 
....................    { 
....................       step_motor_quay_thuan_fs(); 
....................       delay_ms(stepmotor_delay); 
....................    } 
....................    while (input(off)); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 902:  dieu khin dung co buoc có 2 nút dieu khien: ON, OFF.Khi nhan ON thì dng co quay nguoc chieu kim dong ho, khi nhan OFF thì ngung 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_902_step_on_off_qn() 
.................... { 
....................    while(input(on)); 
....................    do 
....................    { 
....................       step_motor_quay_nghich_fs(); 
....................       delay_ms(stepmotor_delay); 
....................    } 
....................    while (input(off)); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 903:  dieu khin dung co buoc có 3 nút dieu khien: ON, OFF, INV 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_903_phim_inv() 
.................... { 
....................    if (!input(inv)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(inv)) 
....................          { 
....................             stepmotor_tn=~stepmotor_tn; 
....................             do 
....................             { 
....................                motor_step_run_fs(); 
....................                delay_ms(stepmotor_delay); 
....................             } 
....................             while(!input(inv)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_903_step_on_off_inv() 
.................... { 
....................    while(input(on)); 
....................    do 
....................    { 
....................        
....................       motor_step_run_fs(); 
....................       delay_ms(stepmotor_delay); 
....................       ham_903_phim_inv(); 
....................    } 
....................    while (input(off)); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai 904:  giong 903 nhung hien thi them so buoc tren 4 led 7 doan 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void ham_904_phim_inv() 
.................... { 
....................    if (!input(inv)) 
....................    { 
....................       delay_ms(20); 
....................       { 
....................          if (!input(inv)) 
....................          { 
....................             stepmotor_tn=~stepmotor_tn; 
....................             so_buoc=0; 
....................             do 
....................             { 
....................                motor_step_run_fs(); 
....................                delay_ms(stepmotor_delay); 
....................             } 
....................             while(!input(inv)); 
....................          } 
....................       } 
....................    } 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_904_step_on_off_inv() 
.................... { 
....................    while(input(on)); 
....................    do 
....................    { 
....................        
....................       motor_step_run_fs(); 
....................       delay_ms(stepmotor_delay); 
....................       ham_904_phim_inv(); 
....................       xuat_4led_7doan_giaima_xoa_so0(so_buoc); 
....................    } 
....................    while (input(off)); 
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... //Bai thi 
.................... unsigned int8 flag1=0; 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void hien_thi_4led_7doan() 
.................... { 
....................    xuat_4led_7doan_4so(0xff,ma7doan[giay/10],ma7doan[giay%10],0xff); 
*
0ADA:  MOVFF  4BF,59A
0ADE:  MOVLW  0A
0AE0:  MOVLB  5
0AE2:  MOVWF  x9B
0AE4:  MOVLB  0
0AE6:  RCALL  0A62
0AE8:  CLRF   03
0AEA:  MOVF   01,W
0AEC:  MOVFF  FF2,599
0AF0:  BCF    FF2.7
0AF2:  CALL   0096
0AF6:  MOVLB  5
0AF8:  BTFSC  x99.7
0AFA:  BSF    FF2.7
0AFC:  MOVWF  x99
0AFE:  MOVFF  4BF,59A
0B02:  MOVLW  0A
0B04:  MOVWF  x9B
0B06:  MOVLB  0
0B08:  RCALL  0A62
0B0A:  CLRF   03
0B0C:  MOVF   00,W
0B0E:  MOVFF  FF2,59A
0B12:  BCF    FF2.7
0B14:  CALL   0096
0B18:  MOVLB  5
0B1A:  BTFSC  x9A.7
0B1C:  BSF    FF2.7
0B1E:  MOVWF  x9A
0B20:  SETF   x9B
0B22:  MOVFF  599,59C
0B26:  MOVWF  x9D
0B28:  SETF   x9E
0B2A:  MOVLB  0
0B2C:  BRA    0AAE
0B2E:  GOTO   1076 (RETURN)
....................     
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void hien_thi_lcd_so_to() 
.................... { 
....................    //setup_lcd(); 
....................    lcd_hienthi_so_z_toado_xy(t0/10,2,0); 
*
0CAE:  MOVFF  4A6,599
0CB2:  MOVLW  0A
0CB4:  MOVLB  5
0CB6:  MOVWF  x9A
0CB8:  MOVLB  0
0CBA:  RCALL  0B32
0CBC:  MOVFF  01,599
0CC0:  MOVFF  01,59B
0CC4:  MOVLW  02
0CC6:  MOVLB  5
0CC8:  MOVWF  x9C
0CCA:  CLRF   x9D
0CCC:  MOVLB  0
0CCE:  RCALL  0BD2
....................    lcd_hienthi_so_z_toado_xy(t0%10,2,3); 
0CD0:  MOVFF  4A6,599
0CD4:  MOVLW  0A
0CD6:  MOVLB  5
0CD8:  MOVWF  x9A
0CDA:  MOVLB  0
0CDC:  RCALL  0B32
0CDE:  MOVFF  00,599
0CE2:  MOVFF  00,59B
0CE6:  MOVLW  02
0CE8:  MOVLB  5
0CEA:  MOVWF  x9C
0CEC:  MOVLW  03
0CEE:  MOVWF  x9D
0CF0:  MOVLB  0
0CF2:  RCALL  0BD2
....................    if(flag1==0) 
0CF4:  MOVLB  5
0CF6:  MOVF   x98,F
0CF8:  BNZ   0D8E
....................    { 
....................       lcd_goto_xy(0,0); 
0CFA:  CLRF   xA0
0CFC:  CLRF   xA1
0CFE:  MOVLB  0
0D00:  RCALL  0B5E
....................       lcd_data("                    "); 
0D02:  MOVLW  C4
0D04:  MOVWF  FF6
0D06:  MOVLW  05
0D08:  MOVWF  FF7
0D0A:  RCALL  0C48
....................       lcd_goto_xy(1,0); 
0D0C:  MOVLW  01
0D0E:  MOVLB  5
0D10:  MOVWF  xA0
0D12:  CLRF   xA1
0D14:  MOVLB  0
0D16:  RCALL  0B5E
....................       lcd_data("                    "); 
0D18:  MOVLW  DA
0D1A:  MOVWF  FF6
0D1C:  MOVLW  05
0D1E:  MOVWF  FF7
0D20:  RCALL  0C48
....................       lcd_goto_xy(0,18); 
0D22:  MOVLB  5
0D24:  CLRF   xA0
0D26:  MOVLW  12
0D28:  MOVWF  xA1
0D2A:  MOVLB  0
0D2C:  RCALL  0B5E
....................       lcd_data(lm35a/10+0x30); 
0D2E:  MOVFF  573,59A
0D32:  MOVFF  572,599
0D36:  MOVLB  5
0D38:  CLRF   x9C
0D3A:  MOVLW  0A
0D3C:  MOVWF  x9B
0D3E:  MOVLB  0
0D40:  RCALL  0C68
0D42:  MOVFF  02,59A
0D46:  MOVFF  01,599
0D4A:  MOVLW  30
0D4C:  MOVLB  5
0D4E:  ADDWF  x99,F
0D50:  MOVLW  00
0D52:  ADDWFC x9A,F
0D54:  MOVFF  599,5A0
0D58:  MOVLB  0
0D5A:  RCALL  09F8
....................       lcd_data(lm35a%10+0x30); 
0D5C:  MOVFF  573,59A
0D60:  MOVFF  572,599
0D64:  MOVLB  5
0D66:  CLRF   x9C
0D68:  MOVLW  0A
0D6A:  MOVWF  x9B
0D6C:  MOVLB  0
0D6E:  RCALL  0C68
0D70:  MOVFF  00,599
0D74:  MOVLB  5
0D76:  MOVFF  03,59A
0D7A:  MOVLW  30
0D7C:  ADDWF  x99,F
0D7E:  MOVLW  00
0D80:  ADDWFC x9A,F
0D82:  MOVFF  599,5A0
0D86:  MOVLB  0
0D88:  RCALL  09F8
....................    } 
0D8A:  BRA    0DE8
0D8C:  MOVLB  5
....................    else if(flag1==1) 
0D8E:  DECFSZ x98,W
0D90:  BRA    0DEA
....................    { 
....................       lcd_hienthi_so_z_toado_xy(lm35a/10,0,14); 
0D92:  MOVFF  573,59A
0D96:  MOVFF  572,599
0D9A:  CLRF   x9C
0D9C:  MOVLW  0A
0D9E:  MOVWF  x9B
0DA0:  MOVLB  0
0DA2:  RCALL  0C68
0DA4:  MOVFF  02,59A
0DA8:  MOVFF  01,599
0DAC:  MOVFF  01,59B
0DB0:  MOVLB  5
0DB2:  CLRF   x9C
0DB4:  MOVLW  0E
0DB6:  MOVWF  x9D
0DB8:  MOVLB  0
0DBA:  RCALL  0BD2
....................       lcd_hienthi_so_z_toado_xy(lm35a%10,0,17); 
0DBC:  MOVFF  573,59A
0DC0:  MOVFF  572,599
0DC4:  MOVLB  5
0DC6:  CLRF   x9C
0DC8:  MOVLW  0A
0DCA:  MOVWF  x9B
0DCC:  MOVLB  0
0DCE:  RCALL  0C68
0DD0:  MOVFF  00,599
0DD4:  MOVLB  5
0DD6:  MOVFF  03,59A
0DDA:  MOVFF  00,59B
0DDE:  CLRF   x9C
0DE0:  MOVLW  11
0DE2:  MOVWF  x9D
0DE4:  MOVLB  0
0DE6:  RCALL  0BD2
0DE8:  MOVLB  5
....................    } 
0DEA:  MOVLB  0
0DEC:  RETURN 0
....................     
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void doc_nd_lm35a() 
.................... { 
....................    set_adc_channel(0); 
*
0FC4:  MOVLW  00
0FC6:  MOVWF  01
0FC8:  MOVF   FC2,W
0FCA:  ANDLW  C3
0FCC:  IORWF  01,W
0FCE:  MOVWF  FC2
....................    lm35a=0; 
0FD0:  MOVLB  5
0FD2:  CLRF   x73
0FD4:  CLRF   x72
....................    for(j=0;j<(200);j++) 
0FD6:  CLRF   x70
0FD8:  MOVF   x70,W
0FDA:  SUBLW  C7
0FDC:  BNC   0FFA
....................    { 
....................       lm35a = lm35a + read_adc(); 
0FDE:  BSF    FC2.1
0FE0:  BTFSC  FC2.1
0FE2:  BRA    0FE0
0FE4:  MOVF   FC3,W
0FE6:  ADDWF  x72,F
0FE8:  MOVF   FC4,W
0FEA:  ADDWFC x73,F
....................       delay_us(100); 
0FEC:  MOVLW  A6
0FEE:  MOVWF  00
0FF0:  DECFSZ 00,F
0FF2:  BRA    0FF0
0FF4:  NOP   
0FF6:  INCF   x70,F
0FF8:  BRA    0FD8
....................    } 
....................    lm35a=lm35a/2.046; 
0FFA:  MOVFF  573,59A
0FFE:  MOVFF  572,599
1002:  MOVLB  0
1004:  BRA    0DEE
1006:  MOVFF  03,59C
100A:  MOVFF  02,59B
100E:  MOVFF  01,59A
1012:  MOVFF  00,599
1016:  MOVLW  AA
1018:  MOVLB  5
101A:  MOVWF  xA0
101C:  MOVLW  F1
101E:  MOVWF  x9F
1020:  MOVLW  02
1022:  MOVWF  x9E
1024:  MOVLW  80
1026:  MOVWF  x9D
1028:  MOVLB  0
102A:  BRA    0E26
102C:  MOVFF  03,59C
1030:  MOVFF  02,59B
1034:  MOVFF  01,59A
1038:  MOVFF  00,599
103C:  BRA    0F86
103E:  MOVFF  02,573
1042:  MOVFF  01,572
....................    lm35a=lm35a/(200); 
1046:  MOVFF  573,59A
104A:  MOVFF  572,599
104E:  MOVLB  5
1050:  CLRF   x9C
1052:  MOVLW  C8
1054:  MOVWF  x9B
1056:  MOVLB  0
1058:  RCALL  0C68
105A:  MOVFF  02,573
105E:  MOVFF  01,572
1062:  GOTO   112C (RETURN)
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
.................... void bai_thi() 
.................... { 
....................   if(bdn<10) 
1066:  MOVLB  4
1068:  BTFSC  xC0.7
106A:  BRA    1072
106C:  MOVF   xC0,W
106E:  SUBLW  09
1070:  BNC   1132
....................   { 
....................    hien_thi_4led_7doan(); 
1072:  MOVLB  0
1074:  BRA    0ADA
....................    t0=get_timer0(); 
1076:  MOVF   FD6,W
1078:  MOVLB  4
107A:  MOVWF  xA6
....................    if(t0!=t0_tam) 
107C:  MOVF   xA7,W
107E:  SUBWF  xA6,W
1080:  BZ    110E
....................    { 
....................       if(flag==0) 
1082:  MOVF   xCC,F
1084:  BNZ   10C6
....................       { 
....................          t0_tam=t0; 
1086:  MOVFF  4A6,4A7
....................          hien_thi_lcd_so_to(); 
108A:  MOVLB  0
108C:  RCALL  0CAE
....................          duty=duty+50; 
108E:  MOVLW  32
1090:  MOVLB  5
1092:  ADDWF  x96,F
1094:  MOVLW  00
1096:  ADDWFC x97,F
....................          set_pwm1_duty(duty); 
1098:  MOVFF  597,02
109C:  MOVFF  596,01
10A0:  RRCF   02,F
10A2:  RRCF   01,F
10A4:  RRCF   02,F
10A6:  RRCF   01,F
10A8:  RRCF   02,F
10AA:  MOVFF  01,FBE
10AE:  RRCF   02,F
10B0:  RRCF   02,W
10B2:  ANDLW  30
10B4:  MOVWF  00
10B6:  MOVF   FBD,W
10B8:  ANDLW  CF
10BA:  IORWF  00,W
10BC:  MOVWF  FBD
....................          pwm_capso=t0; 
10BE:  MOVFF  4A6,595
....................           
....................       } 
10C2:  BRA    110C
10C4:  MOVLB  4
....................       else if(flag==1) 
10C6:  DECFSZ xCC,W
10C8:  BRA    110E
....................       { 
....................          t0=20-t0; 
10CA:  MOVLW  14
10CC:  BSF    FD8.0
10CE:  SUBFWB xA6,F
....................          t0_tam=t0; 
10D0:  MOVFF  4A6,4A7
....................          hien_thi_lcd_so_to(); 
10D4:  MOVLB  0
10D6:  RCALL  0CAE
....................          duty=duty-50; 
10D8:  MOVLW  32
10DA:  MOVLB  5
10DC:  SUBWF  x96,F
10DE:  MOVLW  00
10E0:  SUBWFB x97,F
....................          set_pwm1_duty(duty); 
10E2:  MOVFF  597,02
10E6:  MOVFF  596,01
10EA:  RRCF   02,F
10EC:  RRCF   01,F
10EE:  RRCF   02,F
10F0:  RRCF   01,F
10F2:  RRCF   02,F
10F4:  MOVFF  01,FBE
10F8:  RRCF   02,F
10FA:  RRCF   02,W
10FC:  ANDLW  30
10FE:  MOVWF  00
1100:  MOVF   FBD,W
1102:  ANDLW  CF
1104:  IORWF  00,W
1106:  MOVWF  FBD
....................          pwm_capso=t0; 
1108:  MOVFF  4A6,595
110C:  MOVLB  4
....................       } 
....................        
....................    } 
....................    if(t0>=21) 
110E:  MOVF   xA6,W
1110:  SUBLW  14
1112:  BC    111E
....................    { 
....................       set_timer0(1); 
1114:  CLRF   FD7
1116:  MOVLW  01
1118:  MOVWF  FD6
....................       flag=1; 
111A:  MOVWF  xCC
....................    } 
111C:  BRA    1128
....................    else if(t0==0) 
111E:  MOVF   xA6,F
1120:  BNZ   1128
....................    { 
....................      set_timer0(0); 
1122:  CLRF   FD7
1124:  CLRF   FD6
....................      flag=0;  
1126:  CLRF   xCC
....................    } 
....................    doc_nd_lm35a(); 
1128:  MOVLB  0
112A:  BRA    0FC4
....................    hien_thi_lcd_so_to(); 
112C:  RCALL  0CAE
....................   }  
112E:  BRA    115A
1130:  MOVLB  4
....................   else 
....................   { 
....................    bdn=bdn-10; 
1132:  MOVLW  0A
1134:  SUBWF  xC0,F
....................    giay++; 
1136:  INCF   xBF,F
....................    if(giay<=29) 
1138:  BTFSC  xBF.7
113A:  BRA    1142
113C:  MOVF   xBF,W
113E:  SUBLW  1D
1140:  BNC   114A
....................      flag1=0; 
1142:  MOVLB  5
1144:  CLRF   x98
1146:  BRA    1150
1148:  MOVLB  4
....................    else 
....................       flag1=1; 
114A:  MOVLW  01
114C:  MOVLB  5
114E:  MOVWF  x98
....................    if(giay==60) 
1150:  MOVLB  4
1152:  MOVF   xBF,W
1154:  SUBLW  3C
1156:  BNZ   115A
....................       giay=0; 
1158:  CLRF   xBF
115A:  MOVLB  0
....................   }   
115C:  GOTO   134E (RETURN)
.................... } 
.................... //xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
....................  
....................  
....................  
....................  
....................  
....................  
.................... #include <chuonga_led_matran.c>   
....................  
....................  
....................  
....................  
....................  
....................  
....................  
....................  
....................   
....................                      
....................                                                                
....................  
.................... void main()      
1160:  CLRF   FF8
1162:  BCF    FD0.7
1164:  BSF    07.7
1166:  BCF    21.0
1168:  BCF    21.1
116A:  CLRF   23
116C:  CLRF   22
116E:  CLRF   38
1170:  CLRF   39
1172:  CLRF   3A
1174:  CLRF   3B
1176:  CLRF   3C
1178:  CLRF   40
117A:  CLRF   3F
117C:  CLRF   3E
117E:  MOVLW  01
1180:  MOVWF  3D
1182:  MOVLW  80
1184:  MOVWF  44
1186:  CLRF   43
1188:  CLRF   42
118A:  CLRF   41
118C:  CLRF   48
118E:  CLRF   47
1190:  CLRF   46
1192:  CLRF   45
1194:  MOVWF  4C
1196:  CLRF   4B
1198:  CLRF   4E
119A:  MOVLW  01
119C:  MOVWF  4D
119E:  CLRF   50
11A0:  CLRF   4F
11A2:  MOVLW  80
11A4:  MOVWF  54
11A6:  CLRF   53
11A8:  CLRF   56
11AA:  MOVLW  01
11AC:  MOVWF  55
11AE:  CLRF   58
11B0:  CLRF   57
11B2:  CLRF   5A
11B4:  CLRF   59
11B6:  CLRF   5B
11B8:  MOVLW  20
11BA:  MOVWF  5C
11BC:  CLRF   5D
11BE:  MOVLW  01
11C0:  MOVWF  5E
11C2:  MOVLW  10
11C4:  MOVWF  5F
11C6:  CLRF   x60
11C8:  CLRF   x65
11CA:  CLRF   x64
11CC:  CLRF   x63
11CE:  MOVLW  01
11D0:  MOVWF  x62
11D2:  CLRF   x69
11D4:  CLRF   x68
11D6:  CLRF   x67
11D8:  MOVWF  x66
11DA:  SETF   x6D
11DC:  SETF   x6C
11DE:  SETF   x6B
11E0:  MOVLW  FE
11E2:  MOVWF  x6A
11E4:  MOVLW  80
11E6:  MOVWF  x71
11E8:  CLRF   x70
11EA:  CLRF   x6F
11EC:  CLRF   x6E
11EE:  MOVWF  x75
11F0:  CLRF   x74
11F2:  CLRF   x73
11F4:  CLRF   x72
11F6:  MOVLW  7F
11F8:  MOVWF  x79
11FA:  SETF   x78
11FC:  SETF   x77
11FE:  SETF   x76
1200:  MOVLW  01
1202:  MOVWF  x7A
1204:  MOVWF  x7B
1206:  CLRF   x7E
1208:  CLRF   x8D
120A:  CLRF   x90
120C:  CLRF   x8F
120E:  BCF    21.2
1210:  BCF    21.3
1212:  BCF    21.4
1214:  BCF    21.5
1216:  CLRF   x93
1218:  CLRF   x94
121A:  MOVLB  4
121C:  MOVWF  xA5
121E:  CLRF   xAC
1220:  CLRF   xAD
1222:  CLRF   xAE
1224:  CLRF   xBD
1226:  CLRF   xBE
1228:  CLRF   xBF
122A:  CLRF   xC0
122C:  CLRF   xC1
122E:  CLRF   xCC
1230:  MOVLW  64
1232:  MOVLB  5
1234:  MOVWF  x71
1236:  CLRF   x73
1238:  CLRF   x72
123A:  CLRF   x75
123C:  CLRF   x74
123E:  CLRF   x77
1240:  MOVLW  23
1242:  MOVWF  x76
1244:  BCF    21.6
1246:  CLRF   x84
1248:  CLRF   x86
124A:  CLRF   x85
124C:  CLRF   x88
124E:  CLRF   x87
1250:  CLRF   x8A
1252:  MOVLW  07
1254:  MOVWF  x89
1256:  CLRF   x8C
1258:  CLRF   x8B
125A:  CLRF   x8D
125C:  BCF    21.7
125E:  BCF    x94.0
1260:  CLRF   x98
1262:  MOVF   FC1,W
1264:  ANDLW  C0
1266:  IORLW  0F
1268:  MOVWF  FC1
126A:  MOVLW  07
126C:  MOVWF  FB4
126E:  BRA    1298
1270:  DATA 08,40
1272:  DATA 30,FF
1274:  DATA 0C,00
1276:  DATA 81,1D
1278:  DATA 17,1B
127A:  DATA 0F,1D
127C:  DATA 15,17
127E:  DATA 13,03
1280:  DATA 0B,09
1282:  DATA 0D,0C
1284:  DATA 44,AF
1286:  DATA 7F,08
1288:  DATA 04,C2
128A:  DATA C0,F9
128C:  DATA A4,B0
128E:  DATA 99,92
1290:  DATA 82,F8
1292:  DATA A0,44
1294:  DATA CF,20
1296:  DATA 00,00
1298:  MOVLW  00
129A:  MOVWF  FF8
129C:  MOVLW  12
129E:  MOVWF  FF7
12A0:  MOVLW  70
12A2:  MOVWF  FF6
12A4:  TBLRD*+
12A6:  MOVF   FF5,W
12A8:  MOVWF  00
12AA:  XORLW  00
12AC:  BZ    12D4
12AE:  TBLRD*+
12B0:  MOVF   FF5,W
12B2:  MOVWF  01
12B4:  BTFSC  FE8.7
12B6:  BRA    12C2
12B8:  ANDLW  0F
12BA:  MOVWF  FEA
12BC:  TBLRD*+
12BE:  MOVFF  FF5,FE9
12C2:  BTFSC  01.6
12C4:  TBLRD*+
12C6:  BTFSS  01.6
12C8:  TBLRD*+
12CA:  MOVFF  FF5,FEE
12CE:  DCFSNZ 00,F
12D0:  BRA    12A4
12D2:  BRA    12C6
12D4:  CLRF   FF8
.................... {                                                             
....................    set_up_port_ic_chot(); 
12D6:  MOVLB  0
12D8:  GOTO   0610
....................    //setup_timer0; 
....................    khoi_tao_timer0(); 
12DC:  GOTO   065A
....................    khoi_tao_timer1_ngat(); 
12E0:  GOTO   0666
....................    setup_lcd(); 
12E4:  GOTO   0762
....................    //khoi_tao_glcd(); 
....................    khoi_tao_ds18b20(); 
12E8:  GOTO   08E2
....................    khoi_tao_adc(); 
12EC:  GOTO   092C
....................    //khoi_tao_ds13b07(); 
....................    pcf8591_xuat_dac(250); 
12F0:  MOVLW  FA
12F2:  MOVLB  5
12F4:  MOVWF  x99
12F6:  MOVLB  0
12F8:  GOTO   0996
....................    stepmotor_delay=5; 
12FC:  MOVLW  05
12FE:  MOVWF  x8E
....................    stepmotor_onoff=1; 
1300:  BSF    21.3
....................    lcd_command(0x40); 
1302:  MOVLW  40
1304:  MOVLB  5
1306:  MOVWF  xA3
1308:  MOVLB  0
130A:  CALL   072E
....................    for(i=0;i<64;i++) lcd_data(lcd_ma_8doan[i]); 
130E:  CLRF   16
1310:  MOVF   16,W
1312:  SUBLW  3F
1314:  BNC   1338
1316:  CLRF   03
1318:  MOVF   16,W
131A:  MOVFF  FF2,599
131E:  BCF    FF2.7
1320:  CALL   0116
1324:  MOVLB  5
1326:  BTFSC  x99.7
1328:  BSF    FF2.7
132A:  MOVWF  x99
132C:  MOVWF  xA0
132E:  MOVLB  0
1330:  CALL   09F8
1334:  INCF   16,F
1336:  BRA    1310
....................    dc_motor_enable(); 
1338:  GOTO   0A5A
....................    output_low(pin_c1); 
133C:  BCF    F94.1
133E:  BCF    F8B.1
....................    setup_ccp1(ccp_pwm); 
1340:  BCF    F94.2
1342:  BCF    F8B.2
1344:  MOVLW  0C
1346:  MOVWF  FBD
1348:  CLRF   FB7
134A:  CLRF   FB6
....................  
....................     
....................    while(true) 
....................    {                                                           
....................       bai_thi(); 
134C:  BRA    1066
134E:  BRA    134C
....................       //bai_904_step_on_off_inv(); 
....................       //bai_903_step_on_off_inv(); 
....................       //bai_902_step_on_off_qn(); 
....................       //bai_901_step_on_off(); 
....................        
....................       //bai_831_pir_dk_den(); 
....................       //bai_822_pcf8591_4led_cds_on_off_den(); 
....................       //bai_821_pcf8591_4led_cds(); 
....................       //bai_815_pcf8591_4led_lm35ab(); 
....................       //bai_814_pcf8591_4led_lm35a_buz_den(); 
....................       //bai_813_pcf8591_4led_lm35a_buz(); 
....................       //bai_812_pcf8591_4led_lm35a_buz() 
....................       //bai_811_pcf8591_4led_lm35a(); 
....................       //bai_809_i2c_rt_lcd_to_nho(); 
....................       //bai_808_i2c_rt_lcd_to(); 
....................       //bai_807_i2c_rt_lcd_3key_chuong(); 
....................       //bai_806_i2c_rt_lcd_3key_alram(); 
....................       //bai_805_i2c_rt_lcd_3key_buzzer(); 
....................       //bai_804_i2c_rt_lcd_3key_nn(); 
....................       //bai_803_i2c_rt_lcd_3key(); 
....................       //bai_802_i2c_rt_lcd_3key(); 
....................       //bai_801_i2c_rt_lcd(); 
....................       //bai_735_ds18b20a_t0(); 
....................       //bai_734_ds18b20a_lm35a(); 
....................       //bai_733_ds18b20a_lcd_buzzer(); 
....................       //bai_732_ds18b20a_on_off_32led(); 
....................       //bai_731_ds18b20a(); 
....................       //bai_714_lcd_2lm35_t0_gp2d12(); 
....................       //bai_713_gp2d12_ss1cm(); 
....................       //bai_712_gp2d12_ss1cm(); 
....................       //bai_711_gp2d12_ss10cm(); 
....................       //bai_711_gp2d12_ss10cm(); 
....................       //bai_710_lm35_counter_lcd(); 
....................       //bai_709_lm35_up_dw(); 
....................       //bai_708_lm35a_counter_t0(); 
....................       //bai_707_2lm35_lcd(); 
....................       //bai_706_2lm35_buzz(); 
....................       //bai_705_adc_2lm35(); 
....................       //bai_704_lm35a_buzz_auto(); 
....................       //bai_703_lm35a_buzz_auto(); 
....................       //bai_702_lm35a_buzz(); 
....................       //bai_701_lm35a(); 
....................        
....................       //bai_672_glcd_tonghop_5_module(); 
....................       //bai_671_glcd_tonghop_5_module(); 
....................       //BAI_655_GLCD_DEM_GIAY(); 
....................       //bai_664_glcd_dem_sp_t0_ht_cot(); 
....................       //bai_663_glcd_dt_dt(); 
....................       //bai_662_glcd_2bitmap_spkt(); 
....................       //bai_661_glcd_bitmap_spkt(); 
....................       //bai_654_glcd_lcd_4led_dem_sp_t0(); 
....................       //bai_653_glcd_dem_sp_t0(); 
....................       //bai_652_glcd_hien_thi_chuoi(); 
....................       //bai_644_lcd_dem_sp_ktl(); 
....................       //bai_643_lcd_dem_00_99(); 
....................       //bai_642_lcd_so_0123(); 
....................       //bai_641_lcd_so_0(); 
....................       //bai_636_lcd_apple_dichchuyen(); 
....................       //bai_635_lcd_apple(); 
....................       //bai_634_lcd_8kytu(); 
....................       //bai_633_lcd_3kytu(); 
....................       //bai_632_ht_20_traitim(); 
....................       //bai_631_ht_trai_tim(); 
....................       // bai_625_lcd_4led_dem_sp_t0_matrix_key(); 
....................       //bai_624_lcd_key4x4_dich(); 
....................       //bai_623_lcd_key4x4_dich_4hang_1234(); 
....................       //bai_622_lcd_key4x4_dich(); 
....................       //bai_621_lcd_key4x4(); 
....................       //bai_617_lcd_4led_dem_sp_t0_ud(); 
....................       //bai_616_lcd_4led_dem_sp_t0(); 
....................       //bai_615_lcd_8led_gio_phut_giay(); 
....................       //bai_614_lcd_gio_phut_giay(); 
....................       //bai_613_lcd_ht_dem_gio_phut_giay(); 
....................       //bai_612_lcd_ht_dem_phut_giay(); 
....................       //bai_611_lcd_ht_dem_giay(); 
....................       //bai_606_lcd_ht_2hang_dich_2c(); 
....................       //bai_605_lcd_ht_2hang_dich_phai(); 
....................       //bai_604_lcd_ht_2hang_dich_trai(); 
....................       //bai_603_lcd_ht_4kytu_4goc(); 
....................       //bai_602_lcd_hienthi_4hang(); 
....................       //bai_601_lcd_hienthi_4hang(); 
....................        
....................       //bai_521_3module_123(); 
....................       //bai_518_dem_xung_t0_ssc(); 
....................       //bai_517_dem_gio_phut_giay_key_caitien(); 
....................       //bai_516_dem_gio_phut_giay_key_caitien(); 
....................       //bai_515_dem_gio_phut_giay_key(); 
....................       //bai_514_dem_gio_phut_giay(); 
....................       //bai_513_dem_phut_giay(); 
....................       //bai_512_dem_giay_cx(); 
....................       //bai_511_dem_giay(); 
....................       //bai_504_hienthi_8so_cach3(); 
....................       //bai_503_hienthi_8so_cach2(); 
....................       //bai_502_hienthi_10(); 
....................       //bai_501_hienthi_8so(); 
....................        
....................       //bai_424_key_4x4_4led_dich_undo4(); 
....................       //bai_423_key_4x4_4led_dich(); 
....................       //bai_422_dem_xung_t0_quang_cao_32led(); 
....................       //bai_421_dem_xung_t0_quang_cao_32led(); 
....................       //bai_417_dem_xung_t0_start_stop_32led();//khi dung thi xoa t0_8bit 
....................       //bai_416_dem_xung_t0_0_9999();//khi dung thi xoa t0_8bit 
....................       //bai_415_dem_xung_t0_250_300();//khi dung thi xoa t0_8bit va sua set_timer0(250) 
....................       //bai_414_dem_xung_t0_240_255(); //khi dung nho sua set_timer0(240) 
....................       //bai_413_dem_xung_t0_xoa_so0_vn_ct(); 
....................       //bai_412_dem_xung_t0_xoa_so0_vn(); 
....................       //bai_411_dem_xung_t0(); 
....................       //bai_409_dem_phut_giay(); 
....................       //bai_408_dem_0000_9999(); 
....................       //bai_407_dem_000_999(); 
....................       //bai_406_dem_00_59_00_3s(); 
....................       //bai_405_dem_00_59_00(); 
....................       //bai_404_dem_00_59(); 
....................       //bai_403_dem_00_99(); 
....................       //bai_402_dem_0_9(); 
....................       //bai_401_hienthi_4so(); 
....................        
....................       //b338_quangcao(); 
....................       //b337_tonghop_up_dn_clr(); 
....................       //b335_7CT_7BTN(); 
....................       //b334_matranphim_8led_16_btn_on_off(); 
....................       //b333_matranphim_8led_on_off(); 
....................       //b332_matranphim_leddon(); 
....................       //b325_16led_up_dw_clr_2() ; 
....................       //b324_16led_up_dw_clr_1(); 
....................       //b323_on_off_inv_cdoi_8led(); 
....................       //b322_on_off_inv_8led(); 
....................       //b321_dk_32led_on_off_2bt(); 
....................       //bai_311_tong_hop_dk_32led(); 
....................       //bai_310_tong_hop_dk_32led(); 
....................       //bai_309_std_pst_32led(30); 
....................       //bai_308_std_pst_32led(30); 
....................       //bai_307_std_pst_32led(30); 
....................       //bai_306_std_pst_16led_ss(50); 
....................       //bai_305_std_pst_16led(50); 
....................       //bai_304_std_pst_8led(100); 
....................       //bai_303_chop_tat_32led(500); 
....................       //bai_302_chop_tat_16led(500); 
....................       //bai_301_chop_tat_8led_c2(500); 
....................       //bai_301_chop_tat_8led_c1(); 
....................    } 
.................... } 
....................  
1350:  SLEEP 

Configuration Fuses:
   Word  1: CC27   PLL12 CPUDIV1 USBDIV HS FCMEN IESO
   Word  2: 1E3E   PUT BROWNOUT BORV21 VREGEN NOWDT WDT32768
   Word  3: 8700   CCP2C1 PBADEN LPT1OSC MCLR
   Word  4: 00A1   STVREN NOLVP ICSP2 NOXINST NODEBUG
   Word  5: C00F   NOPROTECT NOCPB NOCPD
   Word  6: E00F   NOWRT NOWRTC NOWRTB NOWRTD
   Word  7: 400F   NOEBTR NOEBTRB
